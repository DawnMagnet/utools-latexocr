(()=>{var __webpack_modules__={425:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864),Mousetrap=__webpack_require__(984)(__webpack_require__(21));module.exports=class extends Component{saveKey="globalKey";keywordDefaultData={copy:"ctrl+c",saveClose:"ctrl+shift+c|enter",uploadImage:"ctrl+f",ocr:"ctrl+r",tab:"tab",clear:"ctrl+p",clearAll:"ctrl+shift+p",randomColor:"ctrl+r",textBox:"ctrl+t",serialNumberBox:"ctrl+y",move:"1",close:"esc",suspension:"q"};generateHtmlData=[{label:"复制",dataKey:"copy"},{label:"复制并关闭",dataKey:"saveClose"},{label:"上传图床",dataKey:"uploadImage"},{label:"文本工具",dataKey:"textBox"},{label:"序号工具",dataKey:"serialNumberBox"},{label:"OCR",dataKey:"ocr"},{label:"显示/隐藏工具条",dataKey:"tab"},{label:"墨迹清屏",dataKey:"clear"},{label:"全部清屏",dataKey:"clearAll"},{label:"随机颜色",dataKey:"randomColor"},{label:"去悬浮工具",dataKey:"suspension"},{label:"拖拽工具",dataKey:"move"},{label:"关闭",dataKey:"close"}];constructor(props){super(props),this.keywordData={...this.keywordDefaultData,...UToolsUtils.read(this.saveKey)}}showTips(msg){const $div=document.getElementById("showTips");$div.innerText=msg,$div.style.display="block",setTimeout((()=>{$div.style.display="none"}),1e3)}recordKeyWord(e){e.altKey&&"r"===e.key&&(this.showTips("开始录制请按下按键"),e.target.setAttribute("readonly",!0),Mousetrap.record((sequence=>{this.showTips("录制结束"),sequence.length&&(e.target.value=e.target.value?e.target.value+"|"+sequence[0]:sequence[0],e.target.removeAttribute("readonly"))}),2e3))}valueChange(e,name){this.keywordData[name]=e.target.value,this.saveData()}saveData(){UToolsUtils.save(this.saveKey,this.keywordData)}generateHtml(){return this.generateHtmlData.map((({label,dataKey})=>jsx`
            <div class="form-item inputBox">
                <div class="tips">${label}</div>
                <div class="input">
                  <input id="${dataKey}" value="${this.keywordData[dataKey]}"  type="text" required
                  onKeyUp=${e=>this.recordKeyWord(e)}
                  onChange=${e=>this.valueChange(e,dataKey)}/>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label for="${dataKey}">快捷键按「|」分割,按「alt + r」开始录制</label>
                 </div>
            </div>
        `))}render(){return jsx`
            <div id="showTips"></div>
            <div style="display:flex;flex-direction:column;align-items: center;width: 100%;">
                ${this.generateHtml()}
            </div>
        `}}},264:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864);module.exports=class extends Component{saveKey="screenshotsPosition/setting";constructor(props){super(props);const{autoCenter=!1}=UToolsUtils.read(this.saveKey)||{};this.data={autoCenter},setTimeout((()=>{autoCenter&&document.getElementById("autoCenter").setAttribute("checked",!0)}))}saveData(){UToolsUtils.save(this.saveKey,this.data)}updateAutoCenter(){this.data.autoCenter=!this.data.autoCenter,this.saveData()}render(){return jsx`
          <div class="modal">
                <div class="title">上传后截图位置</div>
                <div class="form-item">
                  <div class="tips">关闭随鼠标位置开启</div>
                  <div class="switchBox">
                    <input type="checkbox" id="autoCenter" />
                    <label class="switch-label" for="autoCenter" onclick=${e=>this.updateAutoCenter(e)}>Toggle</label>
                  </div>
                </div>
            </div>
        `}}},744:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),ScreenshotsPosition=__webpack_require__(264);module.exports=class extends Component{render(){return jsx`
          <${ScreenshotsPosition} />
        `}}},880:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864);module.exports=class extends Component{saveKey="ocr/setting";constructor(props){super(props);const{ocrName="OCR 识别"}=UToolsUtils.read(this.saveKey)||{};this.data={ocrName}}saveData(){UToolsUtils.save(this.saveKey,this.data)}valueChange(e,name){this.data[name]=e.target.value,this.saveData()}render(_update){return jsx`
            <div class="modal">
                <div class="title">OCR功能</div>
                <div class="form-item inputBox">
                  <div class="tips">OCR 关键字</div>
                  <div class="input">
                      <input value="${this.data.ocrName}"  type="text" required
                      onChange=${e=>this.valueChange(e,"ocrName")}/>
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>设置要使用的「OCR」插件关键字</label>
                  </div>
                </div>
            </div>
        `}}},12:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864);module.exports=class extends Component{saveKey="SaveFileName/setting";constructor(props){super(props);const{filenameFormat=""}=UToolsUtils.read(this.saveKey)||{};this.data={filenameFormat}}saveData(){UToolsUtils.save(this.saveKey,this.data)}valueChange(e,name){this.data[name]=e.target.value,this.saveData()}render(_update){return jsx`
            <div class="modal">
                <div class="title">保存设置</div>
                <div class="form-item inputBox">
                  <div class="tips">保存文件名格式</div>
                  <div class="input">
                      <input value="${this.data.filenameFormat}"  type="text" required
                      onChange=${e=>this.valueChange(e,"filenameFormat")}/>
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>设置保存的文件名称{Y}-{M}-{D}</label>
                  </div>
                </div>
                <div style="display: flex;justify-content: center;text-align: center">
                    <div>Y-年 M-月 D-日 H-时 m-分 s-秒 rand-10位 随机字符串</div>
                    <div>since_millisecond-毫秒时间戳 since_second-秒时间戳</div>
                </div>
            </div>
        `}}},704:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864);module.exports=class extends Component{saveKey="uploadImage/setting";constructor(props){super(props);const{port=4126,bed="",uploadLaterClose=!0}=UToolsUtils.read(this.saveKey)||{};this.data={port,bed,uploadLaterClose},setTimeout((()=>{uploadLaterClose&&document.getElementById("uploadLaterClose").setAttribute("checked",!0)}))}limitNumber(e){e.target.value=e.target.value.replace(/\D/g,"")}portValueChange(e){e.target.value=e.target.value.replace(/\D/g,""),this.data.port=e.target.value,console.log(this.data.port),this.saveData()}bedValueChange(e){this.data.bed=e.target.value,this.saveData()}saveData(){UToolsUtils.save(this.saveKey,this.data)}uploadLaterCloseHandler(e){this.data.uploadLaterClose=!this.data.uploadLaterClose,this.saveData()}render(){return jsx`
            <div class="modal">
                <div class="title">图床功能</div>
                <div class="form-item inputBox">
                  <div class="tips">服务端口</div>
                  <div class="input">
                      <input value="${this.data.port}"  type="text" required 
                      onKeyUp=${e=>this.limitNumber(e)} 
                      onChange=${e=>this.portValueChange(e)}/>
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>需要和图床插件设置端口一致</label>
                  </div>
                </div>
                <div class="form-item inputBox">
                  <div class="tips">图床设置</div>
                  <div class="input">
                      <input value=${this.data.bed}  type="text" required 
                      onChange=${e=>this.bedValueChange(e)}/>
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>图床插件中图床值忽略大小写</label>
                  </div>
                </div>
                <div class="form-item">
                  <div class="tips">上传后关闭</div>
                  <div class="switchBox">
                    <input type="checkbox" id="uploadLaterClose" />
                    <label class="switch-label" for="uploadLaterClose" onclick=${e=>this.uploadLaterCloseHandler(e)}>Toggle</label>
                  </div>
                </div>
            </div>
        `}}},24:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UploadImage=__webpack_require__(704),OCR=__webpack_require__(880),SaveFileName=__webpack_require__(12);module.exports=class extends Component{render(){return jsx`
           <${UploadImage} />
           <${OCR} />
           <${SaveFileName} />
        `}}},68:(module,__unused_webpack_exports,__webpack_require__)=>{const{jsx,Component}=__webpack_require__(872),UToolsUtils=__webpack_require__(864);module.exports=class extends Component{defaultData=[{name:"move",label:"拖拽工具",enable:!0},{name:"rectangle",label:"矩形工具",enable:!0},{name:"circle",label:"圆形工具",enable:!0},{name:"arrow",label:"箭头工具",enable:!0},{name:"straightLine",label:"直线工具",enable:!0},{name:"brush",label:"画笔工具",enable:!0},{name:"textBox",label:"文本工具",enable:!0},{name:"serialNumberBox",label:"序号工具",enable:!0},{name:"erasure",label:"橡皮擦工具",enable:!0},{name:"mosaic",label:"马赛克工具",enable:!0},{name:"backout",label:"撤回工具",enable:!0},{name:"suspension",label:"去悬浮插件工具",enable:!0},{name:"uploadImage",label:"上传图床工具",enable:!0},{name:"ocr",label:"识别工具",enable:!0},{name:"saveImage",label:"保存工具",enable:!0},{name:"close",label:"关闭工具",enable:!0},{name:"saveClose",label:"复制并关闭",enable:!0}];constructor(props){super(props);const readData=UToolsUtils.read("toolShowSwitchData");this.toolData=readData?this.defaultData.map((defaultItem=>{const item=readData.find((i=>i.name===defaultItem.name))||{};return{...defaultItem,...item}})):this.defaultData,console.log(this.toolData)}swatchStatusChange(e,name){this.toolData.find((item=>item.name===name)).enable=e.target.checked,this.saveData()}saveData(){UToolsUtils.save("toolShowSwitchData",this.toolData)}render(_update){return jsx`
             <div style="display: grid;justify-items: center;grid-template-columns: 45% 45%;width: 100%;">
                ${this.toolData.map((item=>jsx`
                        <div class="form-item">
                            <div class="tips">${item.label}</div>
                            <div class="switchBox">
                               ${item.enable?jsx`<input type="checkbox" id="${item.name}" checked onchange="${e=>this.swatchStatusChange(e,item.name)}"/>`:jsx`<input type="checkbox" id="${item.name}"  onchange="${e=>this.swatchStatusChange(e,item.name)}"/>`}
                              <label class="switch-label" for="${item.name}">Toggle</label>
                            </div>
                        </div>
                    `))}
            </div>
        `}}},56:module=>{module.exports={CustomCss:"\n  * {\n      box-sizing: border-box;\n      padding: 0;\n      margin: 0;\n  }\n  a {\n      text-decoration: none; \n      outline: none; \n      color: #000; \n  }\n  body {\n    /*padding: 20px;*/\n    background: #ffffff !important;\n    color: #000000 !important;\n  }\n  #setting {\n      display: flex;\n      flex-flow: row wrap;\n      align-content: flex-start;\n  }\n  #setting>div:first-child {\n      width: 20%;\n  }\n  #setting>div:nth-child(2) {\n      width: 80%;\n  }\n  .router {\n      max-height: 100vh;\n      overflow-y: auto;\n      padding: 10px 0 10px;\n  }\n  .router::-webkit-scrollbar-track, .router::-webkit-scrollbar-track-piece {\n      border-radius: 0;\n      background: #ffffff;\n  }\n  .router::-webkit-scrollbar-thumb {\n      border-radius: 3px;\n      background: #c3c3c3;\n      border: none;\n  }\n  .router::-webkit-scrollbar {\n      width: 8px;\n      height: 8px;\n  }\n  #showTips {\n      padding: 6px;\n      position: fixed;\n      width: auto;\n      transform: translateX(-50%);\n      top: 0;\n      left: 50%;\n      background: rgb(0, 0, 0);\n      line-height: 24px;\n      text-align: center;\n      color: #fff;\n      border-radius: 10px;\n      display: none;\n      transition: all 200ms linear;\n      z-index: 100;\n  }\n  \n  .form-button-group {\n    text-align: center;\n  }\n\n  .form-button-group button + button {\n    margin-left: 5px;\n  }\n  #setting {\n      width: 100%;\n  }\n  .menu {\n      font-weight: 700;\n      font-size: 16px;\n      line-height: 30px;\n      cursor: pointer;\n      border: 1px dashed rgba(0,0,0,0);\n      text-align: center;\n      margin: 10px;\n      border-radius: 10px;\n      transition: all 200ms linear;\n      display: block;\n  }\n  .menu:hover {\n      border: 1px dashed rgba(0,0,0,0.9);\n  }\n  .active {\n      border: 1px dashed rgba(0,0,0,0.9);\n  }\n  .content {\n      display: flex;\n      align-items: center;\n      flex-direction: column;\n  }\n  .modal {\n      padding: 10px;\n      width: 80%;\n      box-shadow: 1px 1px 1px #c3c3c3;\n      border-radius: 10px;\n      margin-bottom: 6px;\n      display: flex;\n      flex-direction: column;\n  }\n  .tips {\n      width: 120px;\n  }\n  .title {\n      font-size: 16px;\n      font-weight: 700;\n      padding-bottom: 10px;\n      border-bottom: 1px dashed #c3c3c3;\n  }\n  .form-item {\n      display: flex;\n      align-items: center;\n  }\n  .form-item>div {\n      padding: 5px;\n  }\n  /* input */\n  .inputBox {\n      margin-top: 20px;\n  }\n  .input {\n      position: relative;\n  }\n  .inputBox input {\n      font-size: 16px;\n      padding: 5px;\n      display: block;\n      width: 350px;\n      border: none;\n      border-bottom: 1px dashed rgba(82,100,174, 0.6);\n      background: #ffffff !important;\n      color: #000000 !important;\n  }\n\n  .inputBox input:focus {\n      outline: none;\n  }\n\n  /* LABEL ======================================= */\n  .inputBox label {\n      color: #999;\n      font-size: 16px;\n      font-weight: normal;\n      position: absolute;\n      pointer-events: none;\n      left: 5px;\n      top: 10px;\n      transition: 0.2s ease all;\n      -moz-transition: 0.2s ease all;\n      -webkit-transition: 0.2s ease all;\n  }\n\n  /* active state */\n  .inputBox input:focus ~ label, .inputBox input:valid ~ label {\n      top: -14px;\n      font-size: 14px;\n      color: #5264AE;\n  }\n\n  /* BOTTOM BARS ================================= */\n  .bar {\n      position: relative;\n      display: block;\n      width: 350px;\n  }\n\n  .bar:before, .bar:after {\n      content: '';\n      height: 2px;\n      width: 0;\n      bottom: 1px;\n      position: absolute;\n      background: #5264AE;\n      transition: 0.2s ease all;\n      -moz-transition: 0.2s ease all;\n      -webkit-transition: 0.2s ease all;\n  }\n\n  .bar:before {\n      left: 50%;\n  }\n\n  .bar:after {\n      right: 50%;\n  }\n\n  /* active state */\n  input:focus ~ .bar:before, input:focus ~ .bar:after {\n      width: 50%;\n  }\n\n  /* HIGHLIGHTER ================================== */\n  .highlight {\n      position: absolute;\n      height: 60%;\n      width: 100px;\n      top: 25%;\n      left: 0;\n      pointer-events: none;\n      opacity: 0.5;\n  }\n\n  /* active state */\n  input:focus ~ .highlight {\n      -webkit-animation: inputHighlighter 0.3s ease;\n      -moz-animation: inputHighlighter 0.3s ease;\n      animation: inputHighlighter 0.3s ease;\n  }\n\n  /* ANIMATIONS ================ */\n  @-webkit-keyframes inputHighlighter {\n      from {\n          background: #5264AE;\n      }\n      to {\n          width: 0;\n          background: transparent;\n      }\n  }\n\n  @-moz-keyframes inputHighlighter {\n      from {\n          background: #5264AE;\n      }\n      to {\n          width: 0;\n          background: transparent;\n      }\n  }\n\n  @keyframes inputHighlighter {\n      from {\n          background: #5264AE;\n      }\n      to {\n          width: 0;\n          background: transparent;\n      }\n  }\n  /* switch start */\n  .switchBox {\n      transform: translateY(-6px);\n  }\n  input[type=checkbox] {\n      height: 0;\n      width: 0;\n      visibility: hidden;\n  }\n\n  .switchBox label {\n      cursor: pointer;\n      text-indent: -9999px;\n      width: 50px;\n      height: 25px;\n      background: grey;\n      display: block;\n      border-radius: 100px;\n      position: relative;\n  }\n  .switchBox label:after {\n      content: '';\n      position: absolute;\n      top: 5px;\n      left: 5px;\n      width: 15px;\n      height: 15px;\n      background: #fff;\n      border-radius: 90px;\n      transition: 0.3s;\n  }\n  \n  .switchBox input:checked + label {\n      background: #02b340;\n  }\n\n  .switchBox input:checked + label:after {\n      left: calc(100% - 5px);\n      transform: translateX(-100%);\n  }\n\n  .switchBox label:active:after {\n      width: 30px;\n  }\n  /* switch end */\n"}},240:(module,__unused_webpack_exports,__webpack_require__)=>{const{Fragment,jsx,Component}=__webpack_require__(872),{CustomCss}=__webpack_require__(56),ToolSetting=__webpack_require__(24),GlobalKeyWord=__webpack_require__(425),ToolShowSwitch=__webpack_require__(68),OtherSetting=__webpack_require__(744),{enable:enableDarkMode,disable:disableDarkMode}=__webpack_require__(616);class SettingUI extends Component{settingMenu={currentMenu:"工具设置",menus:[{id:1,name:"工具设置",component:ToolSetting},{id:2,name:"全局快捷键",component:GlobalKeyWord},{id:3,name:"工具显示切换",component:ToolShowSwitch},{id:4,name:"其他设置",component:OtherSetting}]};constructor(props){super(props)}swatchMenu({name}){this.settingMenu.currentMenu=name,this.update()}didMount(){return super.didMount()}setTheme(){utools.isDarkColors()?enableDarkMode({darkSchemeBackgroundColor:"#303133"}):disableDarkMode()}render(){return this.setTheme(),window.setSettingTheme=this.setTheme,jsx`
         <div id="setting">
            <div>
             ${this.settingMenu.menus.map((item=>jsx` <div class="${this.settingMenu.currentMenu===item.name?"menu active":"menu"}" 
                           onClick=${()=>this.swatchMenu(item)}>
                        ${item.name}
                    </div>`))}
            </div>
            <div class="content router" style="position:relative;">
                <${this.settingMenu.menus.find((item=>item.name===this.settingMenu.currentMenu)).component}/>
            </div>
          </div>`}}module.exports={SettingUI:()=>jsx`
<${Fragment}>
<head>
  <title>Setting</title>
  <script src="index.js"/>
  <style>${CustomCss}</style>
</head>
<body>
  <div id="root"/>
   <${SettingUI} />
</body>
</${Fragment}>`}},21:(module,exports,__webpack_require__)=>{var __WEBPACK_AMD_DEFINE_RESULT__;!function(q,u,c){function v(a,b,g){a.addEventListener?a.addEventListener(b,g,!1):a.attachEvent("on"+b,g)}function z(a){if("keypress"==a.type){var b=String.fromCharCode(a.which);return a.shiftKey||(b=b.toLowerCase()),b}return n[a.which]?n[a.which]:r[a.which]?r[a.which]:String.fromCharCode(a.which).toLowerCase()}function w(a){return"shift"==a||"ctrl"==a||"alt"==a||"meta"==a}function A(a,b){var g,d=[],e=a;for("+"===e?e=["+"]:e=(e=e.replace(/\+{2}/g,"+plus")).split("+"),g=0;g<e.length;++g){var m=e[g];B[m]&&(m=B[m]),b&&"keypress"!=b&&C[m]&&(m=C[m],d.push("shift")),w(m)&&d.push(m)}if(e=m,!(g=b)){if(!p)for(var c in p={},n)95<c&&112>c||n.hasOwnProperty(c)&&(p[n[c]]=c);g=p[e]?"keydown":"keypress"}return"keypress"==g&&d.length&&(g="keydown"),{key:m,modifiers:d,action:g}}function D(a,b){return null!==a&&a!==u&&(a===b||D(a.parentNode,b))}function d(a){function b(a){a=a||{};var l,b=!1;for(l in p)a[l]?b=!0:p[l]=0;b||(x=!1)}function g(a,b,t,f,g,d){var l,E=[],h=t.type;if(!k._callbacks[a])return[];for("keyup"==h&&w(a)&&(b=[a]),l=0;l<k._callbacks[a].length;++l){var e,c=k._callbacks[a][l];if((f||!c.seq||p[c.seq]==c.level)&&h==c.action)(e="keypress"==h&&!t.metaKey&&!t.ctrlKey)||(e=c.modifiers,e=b.sort().join(",")===e.sort().join(",")),e&&(e=f&&c.seq==f&&c.level==d,(!f&&c.combo==g||e)&&k._callbacks[a].splice(l,1),E.push(c))}return E}function c(a,b,c,f){k.stopCallback(b,b.target||b.srcElement,c,f)||!1!==a(b,c)||(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0)}function e(a){"number"!=typeof a.which&&(a.which=a.keyCode);var b=z(a);b&&("keyup"==a.type&&y===b?y=!1:k.handleKey(b,function(a){var b=[];return a.shiftKey&&b.push("shift"),a.altKey&&b.push("alt"),a.ctrlKey&&b.push("ctrl"),a.metaKey&&b.push("meta"),b}(a),a))}function m(a,g,t,f){function h(c){return function(){x=c,++p[a],clearTimeout(q),q=setTimeout(b,1e3)}}function l(g){c(t,g,a),"keyup"!==f&&(y=z(g)),setTimeout(b,10)}for(var d=p[a]=0;d<g.length;++d){var e=d+1===g.length?l:h(f||A(g[d+1]).action);n(g[d],e,f,a,d)}}function n(a,b,c,f,d){k._directMap[a+":"+c]=b;var e=(a=a.replace(/\s+/g," ")).split(" ");1<e.length?m(a,e,b,c):(c=A(a,c),k._callbacks[c.key]=k._callbacks[c.key]||[],g(c.key,c.modifiers,{type:c.action},f,a,d),k._callbacks[c.key][f?"unshift":"push"]({callback:b,modifiers:c.modifiers,action:c.action,seq:f,level:d,combo:a}))}var k=this;if(a=a||u,!(k instanceof d))return new d(a);k.target=a,k._callbacks={},k._directMap={};var q,p={},y=!1,r=!1,x=!1;k._handleKey=function(a,d,e){var h,f=g(a,d,e);d={};var k=0,l=!1;for(h=0;h<f.length;++h)f[h].seq&&(k=Math.max(k,f[h].level));for(h=0;h<f.length;++h)f[h].seq?f[h].level==k&&(l=!0,d[f[h].seq]=1,c(f[h].callback,e,f[h].combo,f[h].seq)):l||c(f[h].callback,e,f[h].combo);f="keypress"==e.type&&r,e.type!=x||w(a)||f||b(d),r=l&&"keydown"==e.type},k._bindMultiple=function(a,b,c){for(var d=0;d<a.length;++d)n(a[d],b,c)},v(a,"keypress",e),v(a,"keydown",e),v(a,"keyup",e)}if(q){var p,n={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},r={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},C={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},B={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(c=1;20>c;++c)n[111+c]="f"+c;for(c=0;9>=c;++c)n[c+96]=c.toString();d.prototype.bind=function(a,b,c){return a=a instanceof Array?a:[a],this._bindMultiple.call(this,a,b,c),this},d.prototype.unbind=function(a,b){return this.bind.call(this,a,(function(){}),b)},d.prototype.trigger=function(a,b){return this._directMap[a+":"+b]&&this._directMap[a+":"+b]({},a),this},d.prototype.reset=function(){return this._callbacks={},this._directMap={},this},d.prototype.stopCallback=function(a,b){if(-1<(" "+b.className+" ").indexOf(" mousetrap ")||D(b,this.target))return!1;if("composedPath"in a&&"function"==typeof a.composedPath){var c=a.composedPath()[0];c!==a.target&&(b=c)}return"INPUT"==b.tagName||"SELECT"==b.tagName||"TEXTAREA"==b.tagName||b.isContentEditable},d.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},d.addKeycodes=function(a){for(var b in a)a.hasOwnProperty(b)&&(n[b]=a[b]);p=null},d.init=function(){var b,a=d(u);for(b in a)"_"!==b.charAt(0)&&(d[b]=function(b){return function(){return a[b].apply(a,arguments)}}(b))},d.init(),q.Mousetrap=d,module.exports&&(module.exports=d),void 0===(__WEBPACK_AMD_DEFINE_RESULT__=function(){return d}.call(exports,__webpack_require__,exports,module))||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},616:function(__unused_webpack_module,exports){!function(exports){"use strict";var MessageTypeUItoBG,MessageTypeBGtoUI,DebugMessageTypeBGtoUI,MessageTypeBGtoCS,DebugMessageTypeBGtoCS,MessageTypeCStoBG,DebugMessageTypeCStoBG,MessageTypeCStoUI,MessageTypeUItoCS,__assign=function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))}function __generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;g&&(g=0,op[0]&&(_=0)),_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!((t=(t=_.trys).length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}}function __values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function __spreadArray(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))}"function"==typeof SuppressedError&&SuppressedError,function(MessageTypeUItoBG){MessageTypeUItoBG.GET_DATA="ui-bg-get-data",MessageTypeUItoBG.GET_DEVTOOLS_DATA="ui-bg-get-devtools-data",MessageTypeUItoBG.SUBSCRIBE_TO_CHANGES="ui-bg-subscribe-to-changes",MessageTypeUItoBG.UNSUBSCRIBE_FROM_CHANGES="ui-bg-unsubscribe-from-changes",MessageTypeUItoBG.CHANGE_SETTINGS="ui-bg-change-settings",MessageTypeUItoBG.SET_THEME="ui-bg-set-theme",MessageTypeUItoBG.TOGGLE_ACTIVE_TAB="ui-bg-toggle-active-tab",MessageTypeUItoBG.MARK_NEWS_AS_READ="ui-bg-mark-news-as-read",MessageTypeUItoBG.MARK_NEWS_AS_DISPLAYED="ui-bg-mark-news-as-displayed",MessageTypeUItoBG.LOAD_CONFIG="ui-bg-load-config",MessageTypeUItoBG.APPLY_DEV_DYNAMIC_THEME_FIXES="ui-bg-apply-dev-dynamic-theme-fixes",MessageTypeUItoBG.RESET_DEV_DYNAMIC_THEME_FIXES="ui-bg-reset-dev-dynamic-theme-fixes",MessageTypeUItoBG.APPLY_DEV_INVERSION_FIXES="ui-bg-apply-dev-inversion-fixes",MessageTypeUItoBG.RESET_DEV_INVERSION_FIXES="ui-bg-reset-dev-inversion-fixes",MessageTypeUItoBG.APPLY_DEV_STATIC_THEMES="ui-bg-apply-dev-static-themes",MessageTypeUItoBG.RESET_DEV_STATIC_THEMES="ui-bg-reset-dev-static-themes",MessageTypeUItoBG.COLOR_SCHEME_CHANGE="ui-bg-color-scheme-change",MessageTypeUItoBG.HIDE_HIGHLIGHTS="ui-bg-hide-highlights"}(MessageTypeUItoBG||(MessageTypeUItoBG={})),function(MessageTypeBGtoUI){MessageTypeBGtoUI.CHANGES="bg-ui-changes"}(MessageTypeBGtoUI||(MessageTypeBGtoUI={})),function(DebugMessageTypeBGtoUI){DebugMessageTypeBGtoUI.CSS_UPDATE="debug-bg-ui-css-update",DebugMessageTypeBGtoUI.UPDATE="debug-bg-ui-update"}(DebugMessageTypeBGtoUI||(DebugMessageTypeBGtoUI={})),function(MessageTypeBGtoCS){MessageTypeBGtoCS.ADD_CSS_FILTER="bg-cs-add-css-filter",MessageTypeBGtoCS.ADD_DYNAMIC_THEME="bg-cs-add-dynamic-theme",MessageTypeBGtoCS.ADD_STATIC_THEME="bg-cs-add-static-theme",MessageTypeBGtoCS.ADD_SVG_FILTER="bg-cs-add-svg-filter",MessageTypeBGtoCS.CLEAN_UP="bg-cs-clean-up",MessageTypeBGtoCS.FETCH_RESPONSE="bg-cs-fetch-response",MessageTypeBGtoCS.UNSUPPORTED_SENDER="bg-cs-unsupported-sender"}(MessageTypeBGtoCS||(MessageTypeBGtoCS={})),function(DebugMessageTypeBGtoCS){DebugMessageTypeBGtoCS.RELOAD="debug-bg-cs-reload"}(DebugMessageTypeBGtoCS||(DebugMessageTypeBGtoCS={})),function(MessageTypeCStoBG){MessageTypeCStoBG.COLOR_SCHEME_CHANGE="cs-bg-color-scheme-change",MessageTypeCStoBG.DARK_THEME_DETECTED="cs-bg-dark-theme-detected",MessageTypeCStoBG.DARK_THEME_NOT_DETECTED="cs-bg-dark-theme-not-detected",MessageTypeCStoBG.FETCH="cs-bg-fetch",MessageTypeCStoBG.DOCUMENT_CONNECT="cs-bg-document-connect",MessageTypeCStoBG.DOCUMENT_FORGET="cs-bg-document-forget",MessageTypeCStoBG.DOCUMENT_FREEZE="cs-bg-document-freeze",MessageTypeCStoBG.DOCUMENT_RESUME="cs-bg-document-resume"}(MessageTypeCStoBG||(MessageTypeCStoBG={})),function(DebugMessageTypeCStoBG){DebugMessageTypeCStoBG.LOG="debug-cs-bg-log"}(DebugMessageTypeCStoBG||(DebugMessageTypeCStoBG={})),function(MessageTypeCStoUI){MessageTypeCStoUI.EXPORT_CSS_RESPONSE="cs-ui-export-css-response"}(MessageTypeCStoUI||(MessageTypeCStoUI={})),function(MessageTypeUItoCS){MessageTypeUItoCS.EXPORT_CSS="ui-cs-export-css"}(MessageTypeUItoCS||(MessageTypeUItoCS={}));var isNavigatorDefined="undefined"!=typeof navigator,userAgent=isNavigatorDefined?navigator.userAgentData&&Array.isArray(navigator.userAgentData.brands)?navigator.userAgentData.brands.map((function(brand){return"".concat(brand.brand.toLowerCase()," ").concat(brand.version)})).join(" "):navigator.userAgent.toLowerCase():"some useragent",platform=isNavigatorDefined?navigator.userAgentData&&"string"==typeof navigator.userAgentData.platform?navigator.userAgentData.platform.toLowerCase():navigator.platform.toLowerCase():"some platform",isChromium=userAgent.includes("chrome")||userAgent.includes("chromium"),isFirefox=userAgent.includes("firefox")||userAgent.includes("thunderbird")||userAgent.includes("librewolf"),isSafari=userAgent.includes("safari")&&!isChromium,isWindows=platform.startsWith("win"),isMacOS=platform.startsWith("mac");isNavigatorDefined&&navigator.userAgentData?navigator.userAgentData.mobile:userAgent.includes("mobile");var m,isShadowDomSupported="function"==typeof ShadowRoot,isMatchMediaChangeEventListenerSupported="function"==typeof MediaQueryList&&"function"==typeof MediaQueryList.prototype.addEventListener;(m=userAgent.match(/chrom(?:e|ium)(?:\/| )([^ ]+)/))&&m[1]&&m[1],function(){var m=userAgent.match(/(?:firefox|librewolf)(?:\/| )([^ ]+)/);m&&m[1]&&m[1]}();var isDefinedSelectorSupported=function(){try{return document.querySelector(":defined"),!0}catch(err){return!1}}(),isCSSColorSchemePropSupported=function(){try{if("undefined"==typeof document)return!1;var el=document.createElement("div");return!(!el||"object"!=typeof el.style||"string"!=typeof el.style.colorScheme&&(el.setAttribute("style","color-scheme: dark"),"dark"!==el.style.colorScheme))}catch(e){return!1}}();function getOKResponse(url,mimeType,origin){return __awaiter(this,void 0,void 0,(function(){var response;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,fetch(url,{cache:"force-cache",credentials:"omit",referrer:origin})];case 1:if(response=_a.sent(),isFirefox&&"text/css"===mimeType&&url.startsWith("moz-extension://")&&url.endsWith(".css"))return[2,response];if(mimeType&&!response.headers.get("Content-Type").startsWith(mimeType))throw new Error("Mime type mismatch when loading ".concat(url));if(!response.ok)throw new Error("Unable to load ".concat(url," ").concat(response.status," ").concat(response.statusText));return[2,response]}}))}))}function loadAsDataURL(url,mimeType){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,getOKResponse(url,mimeType)];case 1:return[4,readResponseAsDataURL(_a.sent())];case 2:return[2,_a.sent()]}}))}))}function loadAsBlob(url,mimeType){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,getOKResponse(url,mimeType)];case 1:return[4,_a.sent().blob()];case 2:return[2,_a.sent()]}}))}))}function readResponseAsDataURL(response){return __awaiter(this,void 0,void 0,(function(){var blob;return __generator(this,(function(_a){switch(_a.label){case 0:return[4,response.blob()];case 1:return blob=_a.sent(),[4,new Promise((function(resolve){var reader=new FileReader;reader.onloadend=function(){return resolve(reader.result)},reader.readAsDataURL(blob)}))];case 2:return[2,_a.sent()]}}))}))}var throwCORSError=function(url){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,Promise.reject(new Error(["Embedded Dark Reader cannot access a cross-origin resource",url,"Overview your URLs and CORS policies or use","`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.","See if using `DarkReader.setFetchMethod(window.fetch)`","before `DarkReader.enable()` works."].join(" ")))]}))}))},fetcher=throwCORSError;function setFetchMethod$1(fetch){fetcher=fetch||throwCORSError}function callFetchMethod(url){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,fetcher(url)];case 1:return[2,_a.sent()]}}))}))}window.chrome||(window.chrome={}),chrome.runtime||(chrome.runtime={});var ThemeEngine,AutomationMode,messageListeners=new Set;function sendMessage(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return __awaiter(this,void 0,void 0,(function(){var id_1,_a,url,responseType,response,text_1,error_1;return __generator(this,(function(_b){switch(_b.label){case 0:if(!args[0]||args[0].type!==MessageTypeCStoBG.FETCH)return[3,8];id_1=args[0].id,_b.label=1;case 1:return _b.trys.push([1,7,,8]),_a=args[0].data,url=_a.url,responseType=_a.responseType,[4,callFetchMethod(url)];case 2:return response=_b.sent(),"data-url"!==responseType?[3,4]:[4,readResponseAsDataURL(response)];case 3:return text_1=_b.sent(),[3,6];case 4:return[4,response.text()];case 5:text_1=_b.sent(),_b.label=6;case 6:return messageListeners.forEach((function(cb){return cb({type:MessageTypeBGtoCS.FETCH_RESPONSE,data:text_1,error:null,id:id_1})})),[3,8];case 7:return error_1=_b.sent(),console.error(error_1),messageListeners.forEach((function(cb){return cb({type:MessageTypeBGtoCS.FETCH_RESPONSE,data:null,error:error_1,id:id_1})})),[3,8];case 8:return[2]}}))}))}function addMessageListener(callback){messageListeners.add(callback)}if("function"==typeof chrome.runtime.sendMessage){var nativeSendMessage_1=chrome.runtime.sendMessage;chrome.runtime.sendMessage=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];sendMessage.apply(void 0,__spreadArray([],__read(args),!1)),nativeSendMessage_1.apply(chrome.runtime,args)}}else chrome.runtime.sendMessage=sendMessage;if(chrome.runtime.onMessage||(chrome.runtime.onMessage={}),"function"==typeof chrome.runtime.onMessage.addListener){var nativeAddListener_1=chrome.runtime.onMessage.addListener;chrome.runtime.onMessage.addListener=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];addMessageListener(args[0]),nativeAddListener_1.apply(chrome.runtime.onMessage,args)}}else chrome.runtime.onMessage.addListener=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return addMessageListener(args[0])};(function(ThemeEngine){ThemeEngine.cssFilter="cssFilter",ThemeEngine.svgFilter="svgFilter",ThemeEngine.staticTheme="staticTheme",ThemeEngine.dynamicTheme="dynamicTheme"})(ThemeEngine||(ThemeEngine={})),function(AutomationMode){AutomationMode.NONE="",AutomationMode.TIME="time",AutomationMode.SYSTEM="system",AutomationMode.LOCATION="location"}(AutomationMode||(AutomationMode={}));var DEFAULT_COLORS={darkScheme:{background:"#181a1b",text:"#e8e6e3"},lightScheme:{background:"#dcdad7",text:"#181a1b"}},DEFAULT_THEME={mode:1,brightness:100,contrast:100,grayscale:0,sepia:0,useFont:!1,fontFamily:isMacOS?"Helvetica Neue":isWindows?"Segoe UI":"Open Sans",textStroke:0,engine:ThemeEngine.dynamicTheme,stylesheet:"",darkSchemeBackgroundColor:DEFAULT_COLORS.darkScheme.background,darkSchemeTextColor:DEFAULT_COLORS.darkScheme.text,lightSchemeBackgroundColor:DEFAULT_COLORS.lightScheme.background,lightSchemeTextColor:DEFAULT_COLORS.lightScheme.text,scrollbarColor:isMacOS?"":"auto",selectionColor:"auto",styleSystemControls:!isCSSColorSchemePropSupported,lightColorScheme:"Default",darkColorScheme:"Default",immediateModify:!1};function isArrayLike(items){return null!=items.length}function forEach(items,iterator){var e_1,_a;if(isArrayLike(items))for(var i=0,len=items.length;i<len;i++)iterator(items[i]);else try{for(var items_1=__values(items),items_1_1=items_1.next();!items_1_1.done;items_1_1=items_1.next())iterator(items_1_1.value)}catch(e_1_1){e_1={error:e_1_1}}finally{try{items_1_1&&!items_1_1.done&&(_a=items_1.return)&&_a.call(items_1)}finally{if(e_1)throw e_1.error}}}function push(array,addition){forEach(addition,(function(a){return array.push(a)}))}function toArray(items){for(var results=[],i=0,len=items.length;i<len;i++)results.push(items[i]);return results}function logInfo(){}function logWarn(){}function throttle(callback){var lastArgs,pending=!1,frameId=null,throttled=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];lastArgs=args,frameId?pending=!0:(callback.apply(void 0,__spreadArray([],__read(lastArgs),!1)),frameId=requestAnimationFrame((function(){frameId=null,pending&&(callback.apply(void 0,__spreadArray([],__read(lastArgs),!1)),pending=!1)})))},cancel=function(){cancelAnimationFrame(frameId),pending=!1,frameId=null};return Object.assign(throttled,{cancel})}function createAsyncTasksQueue(){var tasks=[],frameId=null;function runTasks(){for(var task;task=tasks.shift();)task();frameId=null}function add(task){tasks.push(task),frameId||(frameId=requestAnimationFrame(runTasks))}function cancel(){tasks.splice(0),cancelAnimationFrame(frameId),frameId=null}return{add,cancel}}AutomationMode.NONE;var delayTokens=new Set;function requestAnimationFrameOnce(token,callback){delayTokens.has(token)||(delayTokens.add(token),requestAnimationFrame((function(){delayTokens.delete(token),callback()})))}function getDuration(time){var duration=0;return time.seconds&&(duration+=1e3*time.seconds),time.minutes&&(duration+=60*time.minutes*1e3),time.hours&&(duration+=60*time.hours*60*1e3),time.days&&(duration+=24*time.days*60*60*1e3),duration}function removeNode(node){node&&node.parentNode&&node.parentNode.removeChild(node)}function watchForNodePosition(node,mode,onRestore){void 0===onRestore&&(onRestore=Function.prototype);var MAX_ATTEMPTS_COUNT=10,RETRY_TIMEOUT=getDuration({seconds:2}),ATTEMPTS_INTERVAL=getDuration({seconds:10}),prevSibling=node.previousSibling,parent=node.parentNode;if(!parent)throw new Error("Unable to watch for node position: parent element not found");if("prev-sibling"===mode&&!prevSibling)throw new Error("Unable to watch for node position: there is no previous sibling");var attempts=0,start=null,timeoutId=null,restore=throttle((function(){if(!timeoutId){attempts++;var now=Date.now();if(null==start)start=now;else if(attempts>=MAX_ATTEMPTS_COUNT){if(now-start<ATTEMPTS_INTERVAL)return void(timeoutId=setTimeout((function(){start=null,attempts=0,timeoutId=null,restore()}),RETRY_TIMEOUT));start=now,attempts=1}if("head"===mode&&prevSibling&&prevSibling.parentNode!==parent)stop();else{if("prev-sibling"===mode){if(null==prevSibling.parentNode)return void stop();prevSibling.parentNode!==parent&&updateParent(prevSibling.parentNode)}"head"!==mode||parent.isConnected||(parent=document.head),parent.insertBefore(node,prevSibling&&prevSibling.isConnected?prevSibling.nextSibling:parent.firstChild),observer.takeRecords(),onRestore&&onRestore()}}})),observer=new MutationObserver((function(){("head"===mode&&(node.parentNode!==parent||!node.parentNode.isConnected)||"prev-sibling"===mode&&node.previousSibling!==prevSibling)&&restore()})),run=function(){observer.observe(parent,{childList:!0})},stop=function(){clearTimeout(timeoutId),observer.disconnect(),restore.cancel()},skip=function(){observer.takeRecords()},updateParent=function(parentNode){parent=parentNode,stop(),run()};return run(),{run,stop,skip}}function iterateShadowHosts(root,iterator){if(null!=root)for(var walker=document.createTreeWalker(root,NodeFilter.SHOW_ELEMENT,{acceptNode:function(node){return null==node.shadowRoot?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}}),node=root.shadowRoot?walker.currentNode:walker.nextNode();null!=node;node=walker.nextNode())node.classList.contains("surfingkeys_hints_host")||(iterator(node),iterateShadowHosts(node.shadowRoot,iterator))}var isDOMReady=function(){return"complete"===document.readyState||"interactive"===document.readyState};function setIsDOMReady(newFunc){isDOMReady=newFunc}var readyStateListeners=new Set;function addDOMReadyListener(listener){isDOMReady()?listener():readyStateListeners.add(listener)}function removeDOMReadyListener(listener){readyStateListeners.delete(listener)}function isReadyStateComplete(){return"complete"===document.readyState}var readyStateCompleteListeners=new Set;function addReadyStateCompleteListener(listener){isReadyStateComplete()?listener():readyStateCompleteListeners.add(listener)}function cleanReadyStateCompleteListeners(){readyStateCompleteListeners.clear()}if(!isDOMReady()){var onReadyStateChange_1=function(){isDOMReady()&&(readyStateListeners.forEach((function(listener){return listener()})),readyStateListeners.clear(),isReadyStateComplete()&&(document.removeEventListener("readystatechange",onReadyStateChange_1),readyStateCompleteListeners.forEach((function(listener){return listener()})),readyStateCompleteListeners.clear()))};document.addEventListener("readystatechange",onReadyStateChange_1)}var HUGE_MUTATIONS_COUNT=1e3;function isHugeMutation(mutations){if(mutations.length>HUGE_MUTATIONS_COUNT)return!0;for(var addedNodesCount=0,i=0;i<mutations.length;i++)if((addedNodesCount+=mutations[i].addedNodes.length)>HUGE_MUTATIONS_COUNT)return!0;return!1}function getElementsTreeOperations(mutations){var additions=new Set,deletions=new Set,moves=new Set;mutations.forEach((function(m){forEach(m.addedNodes,(function(n){n instanceof Element&&n.isConnected&&additions.add(n)})),forEach(m.removedNodes,(function(n){n instanceof Element&&(n.isConnected?(moves.add(n),additions.delete(n)):deletions.add(n))}))}));var duplicateAdditions=[],duplicateDeletions=[];return additions.forEach((function(node){additions.has(node.parentElement)&&duplicateAdditions.push(node)})),deletions.forEach((function(node){deletions.has(node.parentElement)&&duplicateDeletions.push(node)})),duplicateAdditions.forEach((function(node){return additions.delete(node)})),duplicateDeletions.forEach((function(node){return deletions.delete(node)})),{additions,moves,deletions}}var anchor,optimizedTreeObservers=new Map,optimizedTreeCallbacks=new WeakMap;function createOptimizedTreeObserver(root,callbacks){var observer,observerCallbacks,domReadyListener;if(optimizedTreeObservers.has(root))observer=optimizedTreeObservers.get(root),observerCallbacks=optimizedTreeCallbacks.get(observer);else{var hadHugeMutationsBefore_1=!1,subscribedForReadyState_1=!1;(observer=new MutationObserver((function(mutations){if(isHugeMutation(mutations))!hadHugeMutationsBefore_1||isDOMReady()?observerCallbacks.forEach((function(_a){return(0,_a.onHugeMutations)(root)})):subscribedForReadyState_1||(addDOMReadyListener(domReadyListener=function(){return observerCallbacks.forEach((function(_a){return(0,_a.onHugeMutations)(root)}))}),subscribedForReadyState_1=!0),hadHugeMutationsBefore_1=!0;else{var elementsOperations_1=getElementsTreeOperations(mutations);observerCallbacks.forEach((function(_a){return(0,_a.onMinorMutations)(elementsOperations_1)}))}}))).observe(root,{childList:!0,subtree:!0}),optimizedTreeObservers.set(root,observer),observerCallbacks=new Set,optimizedTreeCallbacks.set(observer,observerCallbacks)}return observerCallbacks.add(callbacks),{disconnect:function(){observerCallbacks.delete(callbacks),domReadyListener&&removeDOMReadyListener(domReadyListener),0===observerCallbacks.size&&(observer.disconnect(),optimizedTreeCallbacks.delete(observer),optimizedTreeObservers.delete(root))}}}var parsedURLCache=new Map;function fixBaseURL($url){return anchor||(anchor=document.createElement("a")),anchor.href=$url,anchor.href}function parseURL($url,$base){void 0===$base&&($base=null);var key="".concat($url).concat($base?";".concat($base):"");if(parsedURLCache.has(key))return parsedURLCache.get(key);if($base){var parsedURL_1=new URL($url,fixBaseURL($base));return parsedURLCache.set(key,parsedURL_1),parsedURL_1}var parsedURL=new URL(fixBaseURL($url));return parsedURLCache.set($url,parsedURL),parsedURL}function getAbsoluteURL($base,$relative){if($relative.match(/^data\\?\:/))return $relative;if(/^\/\//.test($relative))return"".concat(location.protocol).concat($relative);var b=parseURL($base);return parseURL($relative,b.href).href}function isRelativeHrefOnAbsolutePath(href){if(href.startsWith("data:"))return!0;var url=parseURL(href);return url.protocol===location.protocol&&url.hostname===location.hostname&&url.port===location.port&&url.pathname===location.pathname}function iterateCSSRules(rules,iterate,onMediaRuleError){forEach(rules,(function(rule){if(rule.selectorText)iterate(rule);else if(rule.href)try{iterateCSSRules(rule.styleSheet.cssRules,iterate,onMediaRuleError)}catch(err){logInfo("Found a non-loaded link."),onMediaRuleError&&onMediaRuleError()}else if(rule.media){var media=Array.from(rule.media),isScreenOrAllOrQuery=media.some((function(m){return m.startsWith("screen")||m.startsWith("all")||m.startsWith("(")})),isPrintOrSpeech=media.some((function(m){return m.startsWith("print")||m.startsWith("speech")}));!isScreenOrAllOrQuery&&isPrintOrSpeech||iterateCSSRules(rule.cssRules,iterate,onMediaRuleError)}else rule.conditionText?CSS.supports(rule.conditionText)&&iterateCSSRules(rule.cssRules,iterate,onMediaRuleError):logWarn("CSSRule type not supported",rule)}))}var shorthandVarDependantProperties=["background","border","border-color","border-bottom","border-left","border-right","border-top","outline","outline-color"],shorthandVarDepPropRegexps=isSafari?shorthandVarDependantProperties.map((function(prop){return[prop,new RegExp("".concat(prop,":\\s*(.*?)\\s*;"))]})):null;function iterateCSSDeclarations(style,iterate){forEach(style,(function(property){var value=style.getPropertyValue(property).trim();value&&iterate(property,value)}));var cssText=style.cssText;cssText.includes("var(")&&(isSafari?shorthandVarDepPropRegexps.forEach((function(_a){var _b=__read(_a,2),prop=_b[0],regexp=_b[1],match=cssText.match(regexp);if(match&&match[1]){var val=match[1].trim();iterate(prop,val)}})):shorthandVarDependantProperties.forEach((function(prop){var val=style.getPropertyValue(prop);val&&val.includes("var(")&&iterate(prop,val)})))}var cssURLRegex=/url\((('.*?')|(".*?")|([^\)]*?))\)/g,cssImportRegex=/@import\s*(url\()?(('.+?')|(".+?")|([^\)]*?))\)? ?(screen)?;?/gi;function getCSSURLValue(cssURL){return cssURL.trim().replace(/[\n\r\\]+/g,"").replace(/^url\((.*)\)$/,"$1").trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1").replace(/(?:\\(.))/g,"$1")}function getCSSBaseBath(url){var cssURL=parseURL(url);return"".concat(cssURL.origin).concat(cssURL.pathname.replace(/\?.*$/,"").replace(/(\/)([^\/]+)$/i,"$1"))}function replaceCSSRelativeURLsWithAbsolute($css,cssBasePath){return $css.replace(cssURLRegex,(function(match){var pathValue=getCSSURLValue(match);try{return"url('".concat(getAbsoluteURL(cssBasePath,pathValue),"')")}catch(err){return match}}))}var cssCommentsRegex=/\/\*[\s\S]*?\*\//g;function removeCSSComments($css){return $css.replace(cssCommentsRegex,"")}var fontFaceRegex=/@font-face\s*{[^}]*}/g;function replaceCSSFontFace($css){return $css.replace(fontFaceRegex,"")}function evalMath(expression){for(var lastToken,rpnStack=[],workingStack=[],i=0,len=expression.length;i<len;i++){var token=expression[i];if(token&&" "!==token){if(operators.has(token)){for(var op=operators.get(token);workingStack.length;){var currentOp=operators.get(workingStack[0]);if(!currentOp)break;if(!op.lessOrEqualThan(currentOp))break;rpnStack.push(workingStack.shift())}workingStack.unshift(token)}else!lastToken||operators.has(lastToken)?rpnStack.push(token):rpnStack[rpnStack.length-1]+=token;lastToken=token}}rpnStack.push.apply(rpnStack,__spreadArray([],__read(workingStack),!1));var stack=[];for(i=0,len=rpnStack.length;i<len;i++)if(op=operators.get(rpnStack[i])){var args=stack.splice(0,2);stack.push(op.exec(args[1],args[0]))}else stack.unshift(parseFloat(rpnStack[i]));return stack[0]}var Operator=function(){function Operator(precedence,method){this.precendce=precedence,this.execMethod=method}return Operator.prototype.exec=function(left,right){return this.execMethod(left,right)},Operator.prototype.lessOrEqualThan=function(op){return this.precendce<=op.precendce},Operator}(),operators=new Map([["+",new Operator(1,(function(left,right){return left+right}))],["-",new Operator(1,(function(left,right){return left-right}))],["*",new Operator(2,(function(left,right){return left*right}))],["/",new Operator(2,(function(left,right){return left/right}))]]);function getMatches(regex,input,group){void 0===group&&(group=0);for(var m,matches=[];m=regex.exec(input);)matches.push(m[group]);return matches}function formatCSS(text){function trimLeft(text){return text.replace(/^\s+/,"")}function getIndent(depth){return 0===depth?"":" ".repeat(4*depth)}if(text.length<5e4)for(var emptyRuleRegexp=/[^{}]+{\s*}/;emptyRuleRegexp.test(text);)text=text.replace(emptyRuleRegexp,"");for(var css=text.replace(/\s{2,}/g," ").replace(/\{/g,"{\n").replace(/\}/g,"\n}\n").replace(/\;(?![^\(|\"]*(\)|\"))/g,";\n").replace(/\,(?![^\(|\"]*(\)|\"))/g,",\n").replace(/\n\s*\n/g,"\n").split("\n"),depth=0,formatted=[],x=0,len=css.length;x<len;x++){var line="".concat(css[x],"\n");line.includes("{")?formatted.push(getIndent(depth++)+trimLeft(line)):line.includes("}")?formatted.push(getIndent(--depth)+trimLeft(line)):formatted.push(getIndent(depth)+trimLeft(line))}return formatted.join("").trim()}function getParenthesesRange(input,searchStartIndex){void 0===searchStartIndex&&(searchStartIndex=0);for(var length=input.length,depth=0,firstOpenIndex=-1,i=searchStartIndex;i<length;i++)if(0===depth){if((openIndex=input.indexOf("(",i))<0)break;firstOpenIndex=openIndex,depth++,i=openIndex}else{var openIndex,closingIndex=input.indexOf(")",i);if(closingIndex<0)break;if((openIndex=input.indexOf("(",i))<0||closingIndex<openIndex){if(0==--depth)return{start:firstOpenIndex,end:closingIndex+1};i=closingIndex}else depth++,i=openIndex}return null}var hslaParseCache=new Map,rgbaParseCache=new Map;function parseColorWithCache($color){if($color=$color.trim(),rgbaParseCache.has($color))return rgbaParseCache.get($color);$color.includes("calc(")&&($color=lowerCalcExpression($color));var color=parse($color);return color&&rgbaParseCache.set($color,color),color}function parseToHSLWithCache(color){if(hslaParseCache.has(color))return hslaParseCache.get(color);var rgb=parseColorWithCache(color);if(!rgb)return null;var hsl=rgbToHSL(rgb);return hslaParseCache.set(color,hsl),hsl}function clearColorCache(){hslaParseCache.clear(),rgbaParseCache.clear()}function hslToRGB(_a){var h=_a.h,s=_a.s,l=_a.l,_b=_a.a,a=void 0===_b?1:_b;if(0===s){var _c=__read([l,l,l].map((function(x){return Math.round(255*x)})),3),r_1=_c[0],b_1=_c[1];return{r:r_1,g:_c[2],b:b_1,a}}var c=(1-Math.abs(2*l-1))*s,x=c*(1-Math.abs(h/60%2-1)),m=l-c/2,_d=__read((h<60?[c,x,0]:h<120?[x,c,0]:h<180?[0,c,x]:h<240?[0,x,c]:h<300?[x,0,c]:[c,0,x]).map((function(n){return Math.round(255*(n+m))})),3);return{r:_d[0],g:_d[1],b:_d[2],a}}function rgbToHSL(_a){var r255=_a.r,g255=_a.g,b255=_a.b,_b=_a.a,a=void 0===_b?1:_b,r=r255/255,g=g255/255,b=b255/255,max=Math.max(r,g,b),min=Math.min(r,g,b),c=max-min,l=(max+min)/2;if(0===c)return{h:0,s:0,l,a};var h=60*(max===r?(g-b)/c%6:max===g?(b-r)/c+2:(r-g)/c+4);return h<0&&(h+=360),{h,s:c/(1-Math.abs(2*l-1)),l,a}}function toFixed(n,digits){void 0===digits&&(digits=0);var fixed=n.toFixed(digits);if(0===digits)return fixed;var dot=fixed.indexOf(".");if(dot>=0){var zerosMatch=fixed.match(/0+$/);if(zerosMatch)return zerosMatch.index===dot+1?fixed.substring(0,dot):fixed.substring(0,zerosMatch.index)}return fixed}function rgbToString(rgb){var r=rgb.r,g=rgb.g,b=rgb.b,a=rgb.a;return null!=a&&a<1?"rgba(".concat(toFixed(r),", ").concat(toFixed(g),", ").concat(toFixed(b),", ").concat(toFixed(a,2),")"):"rgb(".concat(toFixed(r),", ").concat(toFixed(g),", ").concat(toFixed(b),")")}function rgbToHexString(_a){var r=_a.r,g=_a.g,b=_a.b,a=_a.a;return"#".concat((null!=a&&a<1?[r,g,b,Math.round(255*a)]:[r,g,b]).map((function(x){return"".concat(x<16?"0":"").concat(x.toString(16))})).join(""))}function hslToString(hsl){var h=hsl.h,s=hsl.s,l=hsl.l,a=hsl.a;return null!=a&&a<1?"hsla(".concat(toFixed(h),", ").concat(toFixed(100*s),"%, ").concat(toFixed(100*l),"%, ").concat(toFixed(a,2),")"):"hsl(".concat(toFixed(h),", ").concat(toFixed(100*s),"%, ").concat(toFixed(100*l),"%)")}var rgbMatch=/^rgba?\([^\(\)]+\)$/,hslMatch=/^hsla?\([^\(\)]+\)$/,hexMatch=/^#[0-9a-f]+$/i;function parse($color){var c=$color.trim().toLowerCase();return c.match(rgbMatch)?parseRGB(c):c.match(hslMatch)?parseHSL(c):c.match(hexMatch)?parseHex(c):knownColors.has(c)?getColorByName(c):systemColors.has(c)?getSystemColor(c):"transparent"===$color?{r:0,g:0,b:0,a:0}:null}function getNumbers($color){var numbers=[],prevPos=0,isMining=!1,startIndex=$color.indexOf("(");$color=$color.substring(startIndex+1,$color.length-1);for(var i=0;i<$color.length;i++){var c=$color[i];c>="0"&&c<="9"||"."===c||"+"===c||"-"===c?isMining=!0:!isMining||" "!==c&&","!==c&&"/"!==c?isMining||(prevPos=i+1):(numbers.push($color.substring(prevPos,i)),isMining=!1,prevPos=i+1)}return isMining&&numbers.push($color.substring(prevPos,$color.length)),numbers}function getNumbersFromString(str,range,units){var raw=getNumbers(str),unitsList=Object.entries(units);return raw.map((function(r){return r.trim()})).map((function(r,i){var n,unit=unitsList.find((function(_a){var u=__read(_a,1)[0];return r.endsWith(u)}));return n=unit?parseFloat(r.substring(0,r.length-unit[0].length))/unit[1]*range[i]:parseFloat(r),range[i]>1?Math.round(n):n}))}var rgbRange=[255,255,255,1],rgbUnits={"%":100};function parseRGB($rgb){var _a=__read(getNumbersFromString($rgb,rgbRange,rgbUnits),4),r=_a[0],g=_a[1],b=_a[2],_b=_a[3];return{r,g,b,a:void 0===_b?1:_b}}var hslRange=[360,1,1,1],hslUnits={"%":100,deg:360,rad:2*Math.PI,turn:1};function parseHSL($hsl){var _a=__read(getNumbersFromString($hsl,hslRange,hslUnits),4),h=_a[0],s=_a[1],l=_a[2],_b=_a[3];return hslToRGB({h,s,l,a:void 0===_b?1:_b})}function parseHex($hex){var h=$hex.substring(1);switch(h.length){case 3:case 4:var _a=__read([0,1,2].map((function(i){return parseInt("".concat(h[i]).concat(h[i]),16)})),3);return{r:_a[0],g:_a[1],b:_a[2],a:3===h.length?1:parseInt("".concat(h[3]).concat(h[3]),16)/255};case 6:case 8:var _b=__read([0,2,4].map((function(i){return parseInt(h.substring(i,i+2),16)})),3);return{r:_b[0],g:_b[1],b:_b[2],a:6===h.length?1:parseInt(h.substring(6,8),16)/255}}return null}function getColorByName($color){var n=knownColors.get($color);return{r:n>>16&255,g:n>>8&255,b:n>>0&255,a:1}}function getSystemColor($color){var n=systemColors.get($color);return{r:n>>16&255,g:n>>8&255,b:n>>0&255,a:1}}function lowerCalcExpression(color){for(var searchIndex=0,replaceBetweenIndices=function(start,end,replacement){color=color.substring(0,start)+replacement+color.substring(end)};-1!==(searchIndex=color.indexOf("calc("));){var range=getParenthesesRange(color,searchIndex);if(!range)break;var slice=color.slice(range.start+1,range.end-1),includesPercentage=slice.includes("%");slice=slice.split("%").join("");var output=Math.round(evalMath(slice));replaceBetweenIndices(range.start-4,range.end,output+(includesPercentage?"%":""))}return color}var knownColors=new Map(Object.entries({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074})),systemColors=new Map(Object.entries({ActiveBorder:3906044,ActiveCaption:0,AppWorkspace:11184810,Background:6513614,ButtonFace:16777215,ButtonHighlight:15329769,ButtonShadow:10461343,ButtonText:0,CaptionText:0,GrayText:8355711,Highlight:11720703,HighlightText:0,InactiveBorder:16777215,InactiveCaption:16777215,InactiveCaptionText:0,InfoBackground:16514245,InfoText:0,Menu:16185078,MenuText:16777215,Scrollbar:11184810,ThreeDDarkShadow:0,ThreeDFace:12632256,ThreeDHighlight:16777215,ThreeDLightShadow:16777215,ThreeDShadow:0,Window:15527148,WindowFrame:11184810,WindowText:0,"-webkit-focus-ring-color":15046400}).map((function(_a){var _b=__read(_a,2),key=_b[0],value=_b[1];return[key.toLowerCase(),value]})));function getSRGBLightness(r,g,b){return(.2126*r+.7152*g+.0722*b)/255}function scale(x,inLow,inHigh,outLow,outHigh){return(x-inLow)*(outHigh-outLow)/(inHigh-inLow)+outLow}function clamp(x,min,max){return Math.min(max,Math.max(min,x))}function multiplyMatrices(m1,m2){for(var result=[],i=0,len=m1.length;i<len;i++){result[i]=[];for(var j=0,len2=m2[0].length;j<len2;j++){for(var sum=0,k=0,len3=m1[0].length;k<len3;k++)sum+=m1[i][k]*m2[k][j];result[i][j]=sum}}return result}function createFilterMatrix(config){var m=Matrix.identity();return 0!==config.sepia&&(m=multiplyMatrices(m,Matrix.sepia(config.sepia/100))),0!==config.grayscale&&(m=multiplyMatrices(m,Matrix.grayscale(config.grayscale/100))),100!==config.contrast&&(m=multiplyMatrices(m,Matrix.contrast(config.contrast/100))),100!==config.brightness&&(m=multiplyMatrices(m,Matrix.brightness(config.brightness/100))),1===config.mode&&(m=multiplyMatrices(m,Matrix.invertNHue())),m}function applyColorMatrix(_a,matrix){var _b=__read(_a,3),result=multiplyMatrices(matrix,[[_b[0]/255],[_b[1]/255],[_b[2]/255],[1],[1]]);return[0,1,2].map((function(i){return clamp(Math.round(255*result[i][0]),0,255)}))}var Matrix={identity:function(){return[[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0],[0,0,0,1,0],[0,0,0,0,1]]},invertNHue:function(){return[[.333,-.667,-.667,0,1],[-.667,.333,-.667,0,1],[-.667,-.667,.333,0,1],[0,0,0,1,0],[0,0,0,0,1]]},brightness:function(v){return[[v,0,0,0,0],[0,v,0,0,0],[0,0,v,0,0],[0,0,0,1,0],[0,0,0,0,1]]},contrast:function(v){var t=(1-v)/2;return[[v,0,0,0,t],[0,v,0,0,t],[0,0,v,0,t],[0,0,0,1,0],[0,0,0,0,1]]},sepia:function(v){return[[.393+.607*(1-v),.769-.769*(1-v),.189-.189*(1-v),0,0],[.349-.349*(1-v),.686+.314*(1-v),.168-.168*(1-v),0,0],[.272-.272*(1-v),.534-.534*(1-v),.131+.869*(1-v),0,0],[0,0,0,1,0],[0,0,0,0,1]]},grayscale:function(v){return[[.2126+.7874*(1-v),.7152-.7152*(1-v),.0722-.0722*(1-v),0,0],[.2126-.2126*(1-v),.7152+.2848*(1-v),.0722-.0722*(1-v),0,0],[.2126-.2126*(1-v),.7152-.7152*(1-v),.0722+.9278*(1-v),0,0],[0,0,0,1,0],[0,0,0,0,1]]}};function getBgPole(theme){return theme[1===theme.mode?"darkSchemeBackgroundColor":"lightSchemeBackgroundColor"]}function getFgPole(theme){return theme[1===theme.mode?"darkSchemeTextColor":"lightSchemeTextColor"]}var colorModificationCache=new Map;function clearColorModificationCache(){colorModificationCache.clear()}var rgbCacheKeys=["r","g","b","a"],themeCacheKeys$1=["mode","brightness","contrast","grayscale","sepia","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor"];function getCacheId(rgb,theme){var resultId="";return rgbCacheKeys.forEach((function(key){resultId+="".concat(rgb[key],";")})),themeCacheKeys$1.forEach((function(key){resultId+="".concat(theme[key],";")})),resultId}function modifyColorWithCache(rgb,theme,modifyHSL,poleColor,anotherPoleColor){var fnCache;colorModificationCache.has(modifyHSL)?fnCache=colorModificationCache.get(modifyHSL):(fnCache=new Map,colorModificationCache.set(modifyHSL,fnCache));var id=getCacheId(rgb,theme);if(fnCache.has(id))return fnCache.get(id);var _a=hslToRGB(modifyHSL(rgbToHSL(rgb),null==poleColor?null:parseToHSLWithCache(poleColor),null==anotherPoleColor?null:parseToHSLWithCache(anotherPoleColor))),r=_a.r,g=_a.g,b=_a.b,a=_a.a,_b=__read(applyColorMatrix([r,g,b],createFilterMatrix(theme)),3),rf=_b[0],gf=_b[1],bf=_b[2],color=1===a?rgbToHexString({r:rf,g:gf,b:bf}):rgbToString({r:rf,g:gf,b:bf,a});return fnCache.set(id,color),color}function noopHSL(hsl){return hsl}function modifyColor(rgb,theme){return modifyColorWithCache(rgb,theme,noopHSL)}function modifyLightSchemeColor(rgb,theme){var poleBg=getBgPole(theme);return modifyColorWithCache(rgb,theme,modifyLightModeHSL,getFgPole(theme),poleBg)}function modifyLightModeHSL(_a,poleFg,poleBg){var h=_a.h,s=_a.s,l=_a.l,a=_a.a,isDark=l<.5,hx=h,sx=l;return(isDark?l<.2||s<.12:s<.24||l>.8&&h>200&&h<280)&&(isDark?(hx=poleFg.h,sx=poleFg.s):(hx=poleBg.h,sx=poleBg.s)),{h:hx,s:sx,l:scale(l,0,1,poleFg.l,poleBg.l),a}}var MAX_BG_LIGHTNESS=.4;function modifyBgHSL(_a,pole){var h=_a.h,s=_a.s,l=_a.l,a=_a.a,isNeutral=s<.12||l>.8&&h>200&&h<280;if(l<.5){var lx_1=scale(l,0,.5,0,MAX_BG_LIGHTNESS);return isNeutral?{h:pole.h,s:pole.s,l:lx_1,a}:{h,s,l:lx_1,a}}var lx=scale(l,.5,1,MAX_BG_LIGHTNESS,pole.l);if(isNeutral)return{h:pole.h,s:pole.s,l:lx,a};var hx=h;return h>60&&h<180&&(hx=h>120?scale(h,120,180,135,180):scale(h,60,120,60,105)),hx>40&&hx<80&&(lx*=.75),{h:hx,s,l:lx,a}}function modifyBackgroundColor(rgb,theme){if(0===theme.mode)return modifyLightSchemeColor(rgb,theme);var pole=getBgPole(theme);return modifyColorWithCache(rgb,__assign(__assign({},theme),{mode:0}),modifyBgHSL,pole)}var FilterMode,MIN_FG_LIGHTNESS=.55;function modifyBlueFgHue(hue){return scale(hue,205,245,205,220)}function modifyFgHSL(_a,pole){var h=_a.h,s=_a.s,l=_a.l,a=_a.a,isNeutral=l<.2||s<.24,isBlue=!isNeutral&&h>205&&h<245;if(l>.5){var lx_2=scale(l,.5,1,MIN_FG_LIGHTNESS,pole.l);if(isNeutral)return{h:pole.h,s:pole.s,l:lx_2,a};var hx_4=h;return isBlue&&(hx_4=modifyBlueFgHue(h)),{h:hx_4,s,l:lx_2,a}}if(isNeutral)return{h:pole.h,s:pole.s,l:scale(l,0,.5,pole.l,MIN_FG_LIGHTNESS),a};var lx,hx=h;return isBlue?(hx=modifyBlueFgHue(h),lx=scale(l,0,.5,pole.l,Math.min(1,MIN_FG_LIGHTNESS+.05))):lx=scale(l,0,.5,pole.l,MIN_FG_LIGHTNESS),{h:hx,s,l:lx,a}}function modifyForegroundColor(rgb,theme){if(0===theme.mode)return modifyLightSchemeColor(rgb,theme);var pole=getFgPole(theme);return modifyColorWithCache(rgb,__assign(__assign({},theme),{mode:0}),modifyFgHSL,pole)}function modifyBorderHSL(_a,poleFg,poleBg){var h=_a.h,s=_a.s,l=_a.l,a=_a.a,hx=h,sx=s;return(l<.2||s<.24)&&(l<.5?(hx=poleFg.h,sx=poleFg.s):(hx=poleBg.h,sx=poleBg.s)),{h:hx,s:sx,l:scale(l,0,1,.5,.2),a}}function modifyBorderColor(rgb,theme){if(0===theme.mode)return modifyLightSchemeColor(rgb,theme);var poleFg=getFgPole(theme),poleBg=getBgPole(theme);return modifyColorWithCache(rgb,__assign(__assign({},theme),{mode:0}),modifyBorderHSL,poleFg,poleBg)}function modifyShadowColor(rgb,filter){return modifyBackgroundColor(rgb,filter)}function modifyGradientColor(rgb,filter){return modifyBackgroundColor(rgb,filter)}function createTextStyle(config){var lines=[];return lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*="vjs-"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*="mu-"], .glyphicon, .icon) {'),config.useFont&&config.fontFamily&&lines.push("  font-family: ".concat(config.fontFamily," !important;")),config.textStroke>0&&(lines.push("  -webkit-text-stroke: ".concat(config.textStroke,"px !important;")),lines.push("  text-stroke: ".concat(config.textStroke,"px !important;"))),lines.push("}"),lines.join("\n")}function getCSSFilterValue(config){var filters=[];return config.mode===FilterMode.dark&&filters.push("invert(100%) hue-rotate(180deg)"),100!==config.brightness&&filters.push("brightness(".concat(config.brightness,"%)")),100!==config.contrast&&filters.push("contrast(".concat(config.contrast,"%)")),0!==config.grayscale&&filters.push("grayscale(".concat(config.grayscale,"%)")),0!==config.sepia&&filters.push("sepia(".concat(config.sepia,"%)")),0===filters.length?null:filters.join(" ")}function toSVGMatrix(matrix){return matrix.slice(0,4).map((function(m){return m.map((function(m){return m.toFixed(3)})).join(" ")})).join(" ")}function getSVGFilterMatrixValue(config){return toSVGMatrix(createFilterMatrix(config))}function hexify(number){return(number<16?"0":"")+number.toString(16)}function generateUID(){if("randomUUID"in crypto){var uuid=crypto.randomUUID();return uuid.substring(0,8)+uuid.substring(9,13)+uuid.substring(14,18)+uuid.substring(19,23)+uuid.substring(24)}return"getRandomValues"in crypto?Array.from(crypto.getRandomValues(new Uint8Array(16))).map((function(x){return hexify(x)})).join(""):Math.floor(Math.random()*Math.pow(2,55)).toString(36)}!function(FilterMode){FilterMode[FilterMode.light=0]="light",FilterMode[FilterMode.dark=1]="dark"}(FilterMode||(FilterMode={}));var resolvers$1=new Map,rejectors=new Map;function bgFetch(request){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,new Promise((function(resolve,reject){var id=generateUID();resolvers$1.set(id,resolve),rejectors.set(id,reject),chrome.runtime.sendMessage({type:MessageTypeCStoBG.FETCH,data:request,id})}))]}))}))}chrome.runtime.onMessage.addListener((function(_a){var type=_a.type,data=_a.data,error=_a.error,id=_a.id;if(type===MessageTypeBGtoCS.FETCH_RESPONSE){var resolve=resolvers$1.get(id),reject=rejectors.get(id);resolvers$1.delete(id),rejectors.delete(id),error?reject&&reject(error):resolve&&resolve(data)}}));var MAX_FRAME_DURATION=1e3/60,imageManager=new(function(){function AsyncQueue(){this.queue=[],this.timerId=null}return AsyncQueue.prototype.addTask=function(task){this.queue.push(task),this.scheduleFrame()},AsyncQueue.prototype.stop=function(){null!==this.timerId&&(cancelAnimationFrame(this.timerId),this.timerId=null),this.queue=[]},AsyncQueue.prototype.scheduleFrame=function(){var _this=this;this.timerId||(this.timerId=requestAnimationFrame((function(){_this.timerId=null;for(var cb,start=Date.now();cb=_this.queue.shift();)if(cb(),Date.now()-start>=MAX_FRAME_DURATION){_this.scheduleFrame();break}})))},AsyncQueue}());function getImageDetails(url){return __awaiter(this,void 0,void 0,(function(){var _this=this;return __generator(this,(function(_a){return[2,new Promise((function(resolve,reject){return __awaiter(_this,void 0,void 0,(function(){var dataURL_1,_a,blob_1,_b,image_1,_c,error_1,_d,_e;return __generator(this,(function(_f){switch(_f.label){case 0:return _f.trys.push([0,14,,15]),url.startsWith("data:")?(_a=url,[3,3]):[3,1];case 1:return[4,getDataURL(url)];case 2:_a=_f.sent(),_f.label=3;case 3:return null===(_d=tryConvertDataURLToBlobSync(dataURL_1=_a))||void 0===_d?[3,4]:(_b=_d,[3,6]);case 4:return[4,loadAsBlob(url)];case 5:_b=_f.sent(),_f.label=6;case 6:return blob_1=_b,dataURL_1.startsWith("data:image/svg+xml")?[4,loadImage(dataURL_1)]:[3,8];case 7:return image_1=_f.sent(),[3,13];case 8:return[4,tryCreateImageBitmap(blob_1)];case 9:return null===(_e=_f.sent())||void 0===_e?[3,10]:(_c=_e,[3,12]);case 10:return[4,loadImage(dataURL_1)];case 11:_c=_f.sent(),_f.label=12;case 12:image_1=_c,_f.label=13;case 13:return imageManager.addTask((function(){var analysis=analyzeImage(image_1);resolve(__assign({src:url,blob:blob_1,dataURL:dataURL_1,width:image_1.width,height:image_1.height},analysis))})),[3,15];case 14:return error_1=_f.sent(),reject(error_1),[3,15];case 15:return[2]}}))}))}))]}))}))}function getDataURL(url){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return new URL(url).origin!==location.origin?[3,2]:[4,loadAsDataURL(url)];case 1:case 3:return[2,_a.sent()];case 2:return[4,bgFetch({url,responseType:"data-url"})]}}))}))}function tryCreateImageBitmap(blob){return __awaiter(this,void 0,void 0,(function(){var err_1;return __generator(this,(function(_a){switch(_a.label){case 0:return _a.trys.push([0,2,,3]),[4,createImageBitmap(blob)];case 1:return[2,_a.sent()];case 2:return err_1=_a.sent(),logWarn("Unable to create image bitmap for type ".concat(blob.type,": ").concat(String(err_1))),[2,null];case 3:return[2]}}))}))}var INCOMPLETE_DOC_LOADING_IMAGE_LIMIT=256,loadingImagesCount=0;function loadImage(url){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,new Promise((function(resolve,reject){var image=new Image;image.onload=function(){return resolve(image)},image.onerror=function(){return reject("Unable to load image ".concat(url))},++loadingImagesCount<=INCOMPLETE_DOC_LOADING_IMAGE_LIMIT||isReadyStateComplete()?image.src=url:addReadyStateCompleteListener((function(){return image.src=url}))}))]}))}))}var canvas,context,MAX_ANALYSIS_PIXELS_COUNT=1024;function createCanvas(){var maxWidth=MAX_ANALYSIS_PIXELS_COUNT,maxHeight=MAX_ANALYSIS_PIXELS_COUNT;(canvas=document.createElement("canvas")).width=maxWidth,canvas.height=maxHeight,(context=canvas.getContext("2d",{willReadFrequently:!0})).imageSmoothingEnabled=!1}function removeCanvas(){canvas=null,context=null}var LARGE_IMAGE_PIXELS_COUNT=262144;function analyzeImage(image){var sw,sh;if(canvas||createCanvas(),image instanceof HTMLImageElement?(sw=image.naturalWidth,sh=image.naturalHeight):(sw=image.width,sh=image.height),0===sw||0===sh)return{isDark:!1,isLight:!1,isTransparent:!1,isLarge:!1,isTooLarge:!1};if(sw*sh>LARGE_IMAGE_PIXELS_COUNT)return{isDark:!1,isLight:!1,isTransparent:!1,isLarge:!0};var sourcePixelsCount=sw*sh,k=Math.min(1,Math.sqrt(MAX_ANALYSIS_PIXELS_COUNT/sourcePixelsCount)),width=Math.ceil(sw*k),height=Math.ceil(sh*k);context.clearRect(0,0,width,height),context.drawImage(image,0,0,sw,sh,0,0,width,height);var i,x,y,r,g,b,l,d=context.getImageData(0,0,width,height).data,TRANSPARENT_ALPHA_THRESHOLD=.05,DARK_LIGHTNESS_THRESHOLD=.4,LIGHT_LIGHTNESS_THRESHOLD=.7,transparentPixelsCount=0,darkPixelsCount=0,lightPixelsCount=0;for(y=0;y<height;y++)for(x=0;x<width;x++)r=d[0+(i=4*(y*width+x))],g=d[i+1],b=d[i+2],d[i+3]/255<TRANSPARENT_ALPHA_THRESHOLD?transparentPixelsCount++:((l=getSRGBLightness(r,g,b))<DARK_LIGHTNESS_THRESHOLD&&darkPixelsCount++,l>LIGHT_LIGHTNESS_THRESHOLD&&lightPixelsCount++);var totalPixelsCount=width*height,opaquePixelsCount=totalPixelsCount-transparentPixelsCount;return{isDark:darkPixelsCount/opaquePixelsCount>=.7,isLight:lightPixelsCount/opaquePixelsCount>=.7,isTransparent:transparentPixelsCount/totalPixelsCount>=.1,isLarge:!1}}var isBlobURLSupported=null,canUseProxy=!1,blobURLCheckRequested=!1,blobURLCheckAwaiters=[];function requestBlobURLCheck(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return canUseProxy?blobURLCheckRequested?[4,new Promise((function(resolve){return blobURLCheckAwaiters.push(resolve)}))]:[3,2]:[2];case 1:return[2,_a.sent()];case 2:return blobURLCheckRequested=!0,[4,new Promise((function(resolve){document.addEventListener("__darkreader__blobURLCheckResponse",(function(e){isBlobURLSupported=e.detail.blobURLAllowed,resolve(),blobURLCheckAwaiters.forEach((function(r){return r()})),blobURLCheckAwaiters.splice(0)}),{once:!0}),document.dispatchEvent(new CustomEvent("__darkreader__blobURLCheckRequest"))}))];case 3:return _a.sent(),[2]}}))}))}function isBlobURLCheckResultReady(){return null!=isBlobURLSupported||!canUseProxy}function onCSPError(err){"blob"===err.blockedURI&&(isBlobURLSupported=!1,document.removeEventListener("securitypolicyviolation",onCSPError))}document.addEventListener("__darkreader__inlineScriptsAllowed",(function(){return canUseProxy=!0}),{once:!0}),document.addEventListener("securitypolicyviolation",onCSPError);var objectURLs=new Set;function getFilteredImageURL(_a,theme){var dataURL=_a.dataURL,width=_a.width,height=_a.height;dataURL.startsWith("data:image/svg+xml")&&(dataURL=escapeXML(dataURL));var matrix=getSVGFilterMatrixValue(theme),svg=['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'.concat(width,'" height="').concat(height,'">'),"<defs>",'<filter id="darkreader-image-filter">','<feColorMatrix type="matrix" values="'.concat(matrix,'" />'),"</filter>","</defs>",'<image width="'.concat(width,'" height="').concat(height,'" filter="url(#darkreader-image-filter)" xlink:href="').concat(dataURL,'" />'),"</svg>"].join("");if(!isBlobURLSupported)return"data:image/svg+xml;base64,".concat(btoa(svg));for(var bytes=new Uint8Array(svg.length),i=0;i<svg.length;i++)bytes[i]=svg.charCodeAt(i);var blob=new Blob([bytes],{type:"image/svg+xml"}),objectURL=URL.createObjectURL(blob);return objectURLs.add(objectURL),objectURL}var xmlEscapeChars={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&apos;",'"':"&quot;"};function escapeXML(str){return str.replace(/[<>&'"]/g,(function(c){var _a;return null!==(_a=xmlEscapeChars[c])&&void 0!==_a?_a:c}))}var dataURLBlobURLs=new Map;function tryConvertDataURLToBlobSync(dataURL){var colonIndex=dataURL.indexOf(":"),semicolonIndex=dataURL.indexOf(";",colonIndex+1),commaIndex=dataURL.indexOf(",",semicolonIndex+1),encoding=dataURL.substring(semicolonIndex+1,commaIndex).toLocaleLowerCase(),mediaType=dataURL.substring(colonIndex+1,semicolonIndex);if("base64"!==encoding||!mediaType)return null;for(var characters=atob(dataURL.substring(commaIndex+1)),bytes=new Uint8Array(characters.length),i=0;i<characters.length;i++)bytes[i]=characters.charCodeAt(i);return new Blob([bytes],{type:mediaType})}function tryConvertDataURLToBlobURL(dataURL){return __awaiter(this,void 0,void 0,(function(){var blobURL,blob;return __generator(this,(function(_a){switch(_a.label){case 0:return isBlobURLSupported?(blobURL=dataURLBlobURLs.get(dataURL))?[2,blobURL]:(blob=tryConvertDataURLToBlobSync(dataURL))?[3,3]:[4,fetch(dataURL)]:[2,null];case 1:return[4,_a.sent().blob()];case 2:blob=_a.sent(),_a.label=3;case 3:return blobURL=URL.createObjectURL(blob),dataURLBlobURLs.set(dataURL,blobURL),[2,blobURL]}}))}))}function cleanImageProcessingCache(){imageManager&&imageManager.stop(),removeCanvas(),objectURLs.forEach((function(u){return URL.revokeObjectURL(u)})),objectURLs.clear(),dataURLBlobURLs.forEach((function(u){return URL.revokeObjectURL(u)})),dataURLBlobURLs.clear()}var gradientLength=8,conicGradient="conic-",conicGradientLength=conicGradient.length,radialGradient="radial-",linearGradient="linear-";function parseGradient(value){for(var result=[],index=0,startIndex=conicGradient.length,_loop_1=function(){var typeGradient;if([linearGradient,radialGradient,conicGradient].find((function(possibleType){if(index-possibleType.length>=0&&value.substring(index-possibleType.length,index)===possibleType)return"repeating"===value.slice(index-possibleType.length-10,index-possibleType.length-1)?(typeGradient="repeating-".concat(possibleType,"gradient"),!0):"-webkit"===value.slice(index-possibleType.length-8,index-possibleType.length-1)?(typeGradient="-webkit-".concat(possibleType,"gradient"),!0):(typeGradient="".concat(possibleType,"gradient"),!0)})),!typeGradient)return"break";var _a=getParenthesesRange(value,index+gradientLength),start=_a.start,end=_a.end,match=value.substring(start+1,end-1);startIndex=end+1+conicGradientLength,result.push({typeGradient,match,offset:typeGradient.length+2,index:index-typeGradient.length+gradientLength,hasComma:!0})};-1!==(index=value.indexOf("gradient",startIndex))&&"break"!==_loop_1(););return result.length&&(result[result.length-1].hasComma=!1),result}function getPriority(ruleStyle,property){return Boolean(ruleStyle&&ruleStyle.getPropertyPriority(property))}function getModifiableCSSDeclaration(property,value,rule,variablesStore,ignoreImageSelectors,isCancelled){if(property.startsWith("--")){if(modifier=getVariableModifier(variablesStore,property,value,rule,ignoreImageSelectors,isCancelled))return{property,value:modifier,important:getPriority(rule.style,property),sourceValue:value}}else if(value.includes("var(")){if(modifier=getVariableDependantModifier(variablesStore,property,value))return{property,value:modifier,important:getPriority(rule.style,property),sourceValue:value}}else{if("color-scheme"===property)return null;if(property.includes("color")&&"-webkit-print-color-adjust"!==property||"fill"===property||"stroke"===property||"stop-color"===property){if(modifier=getColorModifier(property,value,rule))return{property,value:modifier,important:getPriority(rule.style,property),sourceValue:value}}else if("background-image"===property||"list-style-image"===property){if(modifier=getBgImageModifier(value,rule,ignoreImageSelectors,isCancelled))return{property,value:modifier,important:getPriority(rule.style,property),sourceValue:value}}else if(property.includes("shadow")){var modifier;if(modifier=getShadowModifier(value))return{property,value:modifier,important:getPriority(rule.style,property),sourceValue:value}}}return null}function joinSelectors(){for(var selectors=[],_i=0;_i<arguments.length;_i++)selectors[_i]=arguments[_i];return selectors.filter(Boolean).join(", ")}function getModifiedUserAgentStyle(theme,isIFrame,styleSystemControls){var lines=[];isIFrame||(lines.push("html {"),lines.push("    background-color: ".concat(modifyBackgroundColor({r:255,g:255,b:255},theme)," !important;")),lines.push("}")),isCSSColorSchemePropSupported&&(lines.push("html {"),lines.push("    color-scheme: ".concat(1===theme.mode?"dark":"dark light"," !important;")),lines.push("}"));var bgSelectors=joinSelectors(isIFrame?"":"html, body",styleSystemControls?"input, textarea, select, button, dialog":"");return bgSelectors&&(lines.push("".concat(bgSelectors," {")),lines.push("    background-color: ".concat(modifyBackgroundColor({r:255,g:255,b:255},theme),";")),lines.push("}")),lines.push("".concat(joinSelectors("html, body",styleSystemControls?"input, textarea, select, button":"")," {")),lines.push("    border-color: ".concat(modifyBorderColor({r:76,g:76,b:76},theme),";")),lines.push("    color: ".concat(modifyForegroundColor({r:0,g:0,b:0},theme),";")),lines.push("}"),lines.push("a {"),lines.push("    color: ".concat(modifyForegroundColor({r:0,g:64,b:255},theme),";")),lines.push("}"),lines.push("table {"),lines.push("    border-color: ".concat(modifyBorderColor({r:128,g:128,b:128},theme),";")),lines.push("}"),lines.push("::placeholder {"),lines.push("    color: ".concat(modifyForegroundColor({r:169,g:169,b:169},theme),";")),lines.push("}"),lines.push("input:-webkit-autofill,"),lines.push("textarea:-webkit-autofill,"),lines.push("select:-webkit-autofill {"),lines.push("    background-color: ".concat(modifyBackgroundColor({r:250,g:255,b:189},theme)," !important;")),lines.push("    color: ".concat(modifyForegroundColor({r:0,g:0,b:0},theme)," !important;")),lines.push("}"),theme.scrollbarColor&&lines.push(getModifiedScrollbarStyle(theme)),theme.selectionColor&&lines.push(getModifiedSelectionStyle(theme)),lines.join("\n")}function getSelectionColor(theme){var backgroundColorSelection,foregroundColorSelection;if("auto"===theme.selectionColor)backgroundColorSelection=modifyBackgroundColor({r:0,g:96,b:212},__assign(__assign({},theme),{grayscale:0})),foregroundColorSelection=modifyForegroundColor({r:255,g:255,b:255},__assign(__assign({},theme),{grayscale:0}));else{var hsl=rgbToHSL(parseColorWithCache(theme.selectionColor));backgroundColorSelection=theme.selectionColor,foregroundColorSelection=hsl.l<.5?"#FFF":"#000"}return{backgroundColorSelection,foregroundColorSelection}}function getModifiedSelectionStyle(theme){var lines=[],modifiedSelectionColor=getSelectionColor(theme),backgroundColorSelection=modifiedSelectionColor.backgroundColorSelection,foregroundColorSelection=modifiedSelectionColor.foregroundColorSelection;return["::selection","::-moz-selection"].forEach((function(selection){lines.push("".concat(selection," {")),lines.push("    background-color: ".concat(backgroundColorSelection," !important;")),lines.push("    color: ".concat(foregroundColorSelection," !important;")),lines.push("}")})),lines.join("\n")}function getModifiedScrollbarStyle(theme){var colorTrack,colorIcons,colorThumb,colorThumbHover,colorThumbActive,colorCorner,lines=[];if("auto"===theme.scrollbarColor)colorTrack=modifyBackgroundColor({r:241,g:241,b:241},theme),colorIcons=modifyForegroundColor({r:96,g:96,b:96},theme),colorThumb=modifyBackgroundColor({r:176,g:176,b:176},theme),colorThumbHover=modifyBackgroundColor({r:144,g:144,b:144},theme),colorThumbActive=modifyBackgroundColor({r:96,g:96,b:96},theme),colorCorner=modifyBackgroundColor({r:255,g:255,b:255},theme);else{var hsl_1=rgbToHSL(parseColorWithCache(theme.scrollbarColor)),isLight=hsl_1.l>.5,lighten=function(lighter){return __assign(__assign({},hsl_1),{l:clamp(hsl_1.l+lighter,0,1)})},darken=function(darker){return __assign(__assign({},hsl_1),{l:clamp(hsl_1.l-darker,0,1)})};colorTrack=hslToString(darken(.4)),colorIcons=hslToString(isLight?darken(.4):lighten(.4)),colorThumb=hslToString(hsl_1),colorThumbHover=hslToString(lighten(.1)),colorThumbActive=hslToString(lighten(.2)),colorCorner=hslToString(darken(.5))}return lines.push("::-webkit-scrollbar {"),lines.push("    background-color: ".concat(colorTrack,";")),lines.push("    color: ".concat(colorIcons,";")),lines.push("}"),lines.push("::-webkit-scrollbar-thumb {"),lines.push("    background-color: ".concat(colorThumb,";")),lines.push("}"),lines.push("::-webkit-scrollbar-thumb:hover {"),lines.push("    background-color: ".concat(colorThumbHover,";")),lines.push("}"),lines.push("::-webkit-scrollbar-thumb:active {"),lines.push("    background-color: ".concat(colorThumbActive,";")),lines.push("}"),lines.push("::-webkit-scrollbar-corner {"),lines.push("    background-color: ".concat(colorCorner,";")),lines.push("}"),isFirefox&&(lines.push("* {"),lines.push("    scrollbar-color: ".concat(colorThumb," ").concat(colorTrack,";")),lines.push("}")),lines.join("\n")}function getModifiedFallbackStyle(filter,_a){return defaultFallbackFactory(filter,{strict:_a.strict})}function defaultFallbackFactory(filter,_a){var strict=_a.strict,lines=[],isMicrosoft=["microsoft.com","docs.microsoft.com"].includes(location.hostname);return lines.push("html, body, ".concat(strict?"body :not(iframe)".concat(isMicrosoft?':not(div[style^="position:absolute;top:0;left:-"]':""):"body > :not(iframe)"," {")),lines.push("    background-color: ".concat(modifyBackgroundColor({r:255,g:255,b:255},filter)," !important;")),lines.push("    border-color: ".concat(modifyBorderColor({r:64,g:64,b:64},filter)," !important;")),lines.push("    color: ".concat(modifyForegroundColor({r:0,g:0,b:0},filter)," !important;")),lines.push("}"),lines.join("\n")}var unparsableColors=new Set(["inherit","transparent","initial","currentcolor","none","unset"]);function getColorModifier(prop,value,rule){if(unparsableColors.has(value.toLowerCase()))return value;var rgb=parseColorWithCache(value);return rgb?prop.includes("background")?rule.style.webkitMaskImage&&"none"!==rule.style.webkitMaskImage||rule.style.webkitMask&&!rule.style.webkitMask.startsWith("none")||rule.style.mask&&"none"!==rule.style.mask||rule.style.getPropertyValue("mask-image")&&"none"!==rule.style.getPropertyValue("mask-image")?function(filter){return modifyForegroundColor(rgb,filter)}:function(filter){return modifyBackgroundColor(rgb,filter)}:prop.includes("border")||prop.includes("outline")?function(filter){return modifyBorderColor(rgb,filter)}:function(filter){return modifyForegroundColor(rgb,filter)}:null}var imageDetailsCache=new Map,awaitingForImageLoading=new Map;function shouldIgnoreImage(selectorText,selectors){if(!selectorText||0===selectors.length)return!1;if(selectors.some((function(s){return"*"===s})))return!0;for(var ruleSelectors=selectorText.split(/,\s*/g),_loop_1=function(i){var ignoredSelector=selectors[i];if(ruleSelectors.some((function(s){return s===ignoredSelector})))return{value:!0}},i=0;i<selectors.length;i++){var state_1=_loop_1(i);if("object"==typeof state_1)return state_1.value}return!1}function getBgImageModifier(value,rule,ignoreImageSelectors,isCancelled){var _this=this;try{var gradients=parseGradient(value),urls=getMatches(cssURLRegex,value);if(0===urls.length&&0===gradients.length)return value;var getIndices=function(matches){var index=0;return matches.map((function(match){var valueIndex=value.indexOf(match,index);return index=valueIndex+match.length,{match,index:valueIndex}}))},matches_1=gradients.map((function(i){return __assign({type:"gradient"},i)})).concat(getIndices(urls).map((function(i){return __assign({type:"url",offset:0},i)}))).sort((function(a,b){return a.index>b.index?1:-1})),getGradientModifier_1=function(gradient){var typeGradient=gradient.typeGradient,match=gradient.match,hasComma=gradient.hasComma,colorStopRegex=/^(from|color-stop|to)\(([^\(\)]*?,\s*)?(.*?)\)$/,parts=getMatches(/([^\(\),]+(\([^\(\)]*(\([^\(\)]*\)*[^\(\)]*)?\))?([^\(\), ]|( (?!calc)))*),?/g,match,1).map((function(part){var rgb=parseColorWithCache(part=part.trim());if(rgb)return function(filter){return modifyGradientColor(rgb,filter)};var space=part.lastIndexOf(" ");if(rgb=parseColorWithCache(part.substring(0,space)))return function(filter){return"".concat(modifyGradientColor(rgb,filter)," ").concat(part.substring(space+1))};var colorStopMatch=part.match(colorStopRegex);return colorStopMatch&&(rgb=parseColorWithCache(colorStopMatch[3]))?function(filter){return"".concat(colorStopMatch[1],"(").concat(colorStopMatch[2]?"".concat(colorStopMatch[2],", "):"").concat(modifyGradientColor(rgb,filter),")")}:function(){return part}}));return function(filter){return"".concat(typeGradient,"(").concat(parts.map((function(modify){return modify(filter)})).join(", "),")").concat(hasComma?", ":"")}},getURLModifier_1=function(urlValue){var _a;if(shouldIgnoreImage(rule.selectorText,ignoreImageSelectors))return null;var url=getCSSURLValue(urlValue),isURLEmpty=0===url.length,parentStyleSheet=rule.parentStyleSheet,baseURL=parentStyleSheet&&parentStyleSheet.href?getCSSBaseBath(parentStyleSheet.href):(null===(_a=parentStyleSheet.ownerNode)||void 0===_a?void 0:_a.baseURI)||location.origin;return url=getAbsoluteURL(baseURL,url),function(filter){return __awaiter(_this,void 0,void 0,(function(){var imageDetails,awaiters_1,bgImageValue,blobURL;return __generator(this,(function(_a){switch(_a.label){case 0:return isURLEmpty?[2,"url('')"]:(imageDetails=null,imageDetailsCache.has(url)?(imageDetails=imageDetailsCache.get(url),[3,9]):[3,1]);case 1:return _a.trys.push([1,8,,9]),isBlobURLCheckResultReady()?[3,3]:[4,requestBlobURLCheck()];case 2:_a.sent(),_a.label=3;case 3:return awaitingForImageLoading.has(url)?(awaiters_1=awaitingForImageLoading.get(url),[4,new Promise((function(resolve){return awaiters_1.push(resolve)}))]):[3,5];case 4:return(imageDetails=_a.sent())?[3,7]:[2,null];case 5:return awaitingForImageLoading.set(url,[]),[4,getImageDetails(url)];case 6:imageDetails=_a.sent(),imageDetailsCache.set(url,imageDetails),awaitingForImageLoading.get(url).forEach((function(resolve){return resolve(imageDetails)})),awaitingForImageLoading.delete(url),_a.label=7;case 7:return isCancelled()?[2,null]:[3,9];case 8:return logWarn(_a.sent()),awaitingForImageLoading.has(url)&&(awaitingForImageLoading.get(url).forEach((function(resolve){return resolve(null)})),awaitingForImageLoading.delete(url)),[3,9];case 9:return imageDetails&&(bgImageValue=getBgImageValue_1(imageDetails,filter))?[2,bgImageValue]:url.startsWith("data:")?[4,tryConvertDataURLToBlobURL(url)]:[3,11];case 10:if(blobURL=_a.sent())return[2,'url("'.concat(blobURL,'")')];_a.label=11;case 11:return[2,'url("'.concat(url,'")')]}}))}))}},getBgImageValue_1=function(imageDetails,filter){var result,isDark=imageDetails.isDark,isLight=imageDetails.isLight,isTransparent=imageDetails.isTransparent,isLarge=imageDetails.isLarge,width=imageDetails.width,logSrc=imageDetails.src.startsWith("data:")?"data:":imageDetails.src;if(isLarge)logInfo("Not modifying too large image ".concat(logSrc)),result=null;else if(isDark&&isTransparent&&1===filter.mode&&width>2){logInfo("Inverting dark image ".concat(logSrc));var inverted=getFilteredImageURL(imageDetails,__assign(__assign({},filter),{sepia:clamp(filter.sepia+10,0,100)}));result='url("'.concat(inverted,'")')}else if(isLight&&!isTransparent&&1===filter.mode){logInfo("Dimming light image ".concat(logSrc));var dimmed=getFilteredImageURL(imageDetails,filter);result='url("'.concat(dimmed,'")')}else if(0===filter.mode&&isLight){logInfo("Applying filter to image ".concat(logSrc));var filtered=getFilteredImageURL(imageDetails,__assign(__assign({},filter),{brightness:clamp(filter.brightness-10,5,200),sepia:clamp(filter.sepia+10,0,100)}));result='url("'.concat(filtered,'")')}else logInfo("Not modifying the image ".concat(logSrc)),result=null;return result},modifiers_1=[],matchIndex_1=0,prevHasComma_1=!1;return matches_1.forEach((function(_a,i){var type=_a.type,match=_a.match,index=_a.index,typeGradient=_a.typeGradient,hasComma=_a.hasComma,offset=_a.offset,matchStart=index,prefixStart=matchIndex_1,matchEnd=matchStart+match.length+offset;matchIndex_1=matchEnd,prefixStart!==matchStart&&(prevHasComma_1?modifiers_1.push((function(){var betweenValue=value.substring(prefixStart,matchStart);return","===betweenValue[0]&&(betweenValue=betweenValue.substring(1)),betweenValue})):modifiers_1.push((function(){return value.substring(prefixStart,matchStart)}))),prevHasComma_1=hasComma||!1,"url"===type?modifiers_1.push(getURLModifier_1(match)):"gradient"===type&&modifiers_1.push(getGradientModifier_1({match,index,typeGradient,hasComma:hasComma||!1,offset})),i===matches_1.length-1&&modifiers_1.push((function(){return value.substring(matchEnd)}))})),function(filter){var results=modifiers_1.filter(Boolean).map((function(modify){return modify(filter)}));if(results.some((function(r){return r instanceof Promise})))return Promise.all(results).then((function(asyncResults){return asyncResults.filter(Boolean).join("")}));var combinedResult=results.join("");return combinedResult.endsWith(", initial")?combinedResult.slice(0,-9):combinedResult}}catch(err){return null}}function getShadowModifierWithInfo(value){try{var index_1=0,colorMatches_1=getMatches(/(^|\s)(?!calc)([a-z]+\(.+?\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/gi,value,2),notParsed_1=0,modifiers_2=colorMatches_1.map((function(match,i){var prefixIndex=index_1,matchIndex=value.indexOf(match,index_1),matchEnd=matchIndex+match.length;index_1=matchEnd;var rgb=parseColorWithCache(match);return rgb?function(filter){return"".concat(value.substring(prefixIndex,matchIndex)).concat(modifyShadowColor(rgb,filter)).concat(i===colorMatches_1.length-1?value.substring(matchEnd):"")}:(notParsed_1++,function(){return value.substring(prefixIndex,matchEnd)})}));return function(filter){var modified=modifiers_2.map((function(modify){return modify(filter)})).join("");return{matchesLength:colorMatches_1.length,unparseableMatchesLength:notParsed_1,result:modified}}}catch(err){return null}}function getShadowModifier(value){var shadowModifier=getShadowModifierWithInfo(value);return shadowModifier?function(theme){return shadowModifier(theme).result}:null}function getVariableModifier(variablesStore,prop,value,rule,ignoredImgSelectors,isCancelled){return variablesStore.getModifierForVariable({varName:prop,sourceValue:value,rule,ignoredImgSelectors,isCancelled})}function getVariableDependantModifier(variablesStore,prop,value){return variablesStore.getModifierForVarDependant(prop,value)}function cleanModificationCache(){clearColorModificationCache(),imageDetailsCache.clear(),cleanImageProcessingCache(),awaitingForImageLoading.clear()}var VAR_TYPE_BGCOLOR=1,VAR_TYPE_TEXTCOLOR=2,VAR_TYPE_BORDERCOLOR=4,VAR_TYPE_BGIMG=8,variablesStore=new(function(){function VariablesStore(){this.varTypes=new Map,this.rulesQueue=[],this.inlineStyleQueue=[],this.definedVars=new Set,this.varRefs=new Map,this.unknownColorVars=new Set,this.unknownBgVars=new Set,this.undefinedVars=new Set,this.initialVarTypes=new Map,this.changedTypeVars=new Set,this.typeChangeSubscriptions=new Map,this.unstableVarValues=new Map}return VariablesStore.prototype.clear=function(){this.varTypes.clear(),this.rulesQueue.splice(0),this.inlineStyleQueue.splice(0),this.definedVars.clear(),this.varRefs.clear(),this.unknownColorVars.clear(),this.unknownBgVars.clear(),this.undefinedVars.clear(),this.initialVarTypes.clear(),this.changedTypeVars.clear(),this.typeChangeSubscriptions.clear(),this.unstableVarValues.clear()},VariablesStore.prototype.isVarType=function(varName,typeNum){return this.varTypes.has(varName)&&(this.varTypes.get(varName)&typeNum)>0},VariablesStore.prototype.addRulesForMatching=function(rules){this.rulesQueue.push(rules)},VariablesStore.prototype.addInlineStyleForMatching=function(style){this.inlineStyleQueue.push(style)},VariablesStore.prototype.matchVariablesAndDependents=function(){var _this=this;0===this.rulesQueue.length&&0===this.inlineStyleQueue.length||(this.changedTypeVars.clear(),this.initialVarTypes=new Map(this.varTypes),this.collectRootVariables(),this.collectVariablesAndVarDep(),this.collectRootVarDependents(),this.varRefs.forEach((function(refs,v){refs.forEach((function(r){_this.varTypes.has(v)&&_this.resolveVariableType(r,_this.varTypes.get(v))}))})),this.unknownColorVars.forEach((function(v){_this.unknownBgVars.has(v)?(_this.unknownColorVars.delete(v),_this.unknownBgVars.delete(v),_this.resolveVariableType(v,VAR_TYPE_BGCOLOR)):_this.isVarType(v,VAR_TYPE_BGCOLOR|VAR_TYPE_TEXTCOLOR|VAR_TYPE_BORDERCOLOR)?_this.unknownColorVars.delete(v):_this.undefinedVars.add(v)})),this.unknownBgVars.forEach((function(v){null!=_this.findVarRef(v,(function(ref){return _this.unknownColorVars.has(ref)||_this.isVarType(ref,VAR_TYPE_TEXTCOLOR|VAR_TYPE_BORDERCOLOR)}))?_this.iterateVarRefs(v,(function(ref){_this.resolveVariableType(ref,VAR_TYPE_BGCOLOR)})):_this.isVarType(v,VAR_TYPE_BGCOLOR|VAR_TYPE_BGIMG)?_this.unknownBgVars.delete(v):_this.undefinedVars.add(v)})),this.changedTypeVars.forEach((function(varName){_this.typeChangeSubscriptions.has(varName)&&_this.typeChangeSubscriptions.get(varName).forEach((function(callback){callback()}))})),this.changedTypeVars.clear())},VariablesStore.prototype.getModifierForVariable=function(options){var _this=this;return function(theme){var varName=options.varName,sourceValue=options.sourceValue,rule=options.rule,ignoredImgSelectors=options.ignoredImgSelectors,isCancelled=options.isCancelled,getDeclarations=function(){var declarations=[],addModifiedValue=function(typeNum,varNameWrapper,colorModifier){if(_this.isVarType(varName,typeNum)){var modifiedValue,property=varNameWrapper(varName);if(isVarDependant(sourceValue))if(isConstructedColorVar(sourceValue)){var value=insertVarValues(sourceValue,_this.unstableVarValues);value||(value=typeNum===VAR_TYPE_BGCOLOR?"#ffffff":"#000000"),modifiedValue=colorModifier(value,theme)}else modifiedValue=replaceCSSVariablesNames(sourceValue,(function(v){return varNameWrapper(v)}),(function(fallback){return colorModifier(fallback,theme)}));else modifiedValue=colorModifier(sourceValue,theme);declarations.push({property,value:modifiedValue})}};if(addModifiedValue(VAR_TYPE_BGCOLOR,wrapBgColorVariableName,tryModifyBgColor),addModifiedValue(VAR_TYPE_TEXTCOLOR,wrapTextColorVariableName,tryModifyTextColor),addModifiedValue(VAR_TYPE_BORDERCOLOR,wrapBorderColorVariableName,tryModifyBorderColor),_this.isVarType(varName,VAR_TYPE_BGIMG)){var property=wrapBgImgVariableName(varName),modifiedValue=sourceValue;isVarDependant(sourceValue)&&(modifiedValue=replaceCSSVariablesNames(sourceValue,(function(v){return wrapBgColorVariableName(v)}),(function(fallback){return tryModifyBgColor(fallback,theme)})));var bgModifier=getBgImageModifier(modifiedValue,rule,ignoredImgSelectors,isCancelled);modifiedValue="function"==typeof bgModifier?bgModifier(theme):bgModifier,declarations.push({property,value:modifiedValue})}return declarations},callbacks=new Set,addListener=function(onTypeChange){var callback=function(){var decs=getDeclarations();onTypeChange(decs)};callbacks.add(callback),_this.subscribeForVarTypeChange(varName,callback)},removeListeners=function(){callbacks.forEach((function(callback){_this.unsubscribeFromVariableTypeChanges(varName,callback)}))};return{declarations:getDeclarations(),onTypeChange:{addListener,removeListeners}}}},VariablesStore.prototype.getModifierForVarDependant=function(property,sourceValue){var _this=this;if(sourceValue.match(/^\s*(rgb|hsl)a?\(/)){var isBg_1=property.startsWith("background"),isText_1=isTextColorProperty(property);return function(theme){var value=insertVarValues(sourceValue,_this.unstableVarValues);return value||(value=isBg_1?"#ffffff":"#000000"),(isBg_1?tryModifyBgColor:isText_1?tryModifyTextColor:tryModifyBorderColor)(value,theme)}}return"background-color"===property?function(theme){return replaceCSSVariablesNames(sourceValue,(function(v){return wrapBgColorVariableName(v)}),(function(fallback){return tryModifyBgColor(fallback,theme)}))}:isTextColorProperty(property)?function(theme){return replaceCSSVariablesNames(sourceValue,(function(v){return wrapTextColorVariableName(v)}),(function(fallback){return tryModifyTextColor(fallback,theme)}))}:"background"===property||"background-image"===property||"box-shadow"===property?function(theme){var unknownVars=new Set,modify=function(){var variableReplaced=replaceCSSVariablesNames(sourceValue,(function(v){return _this.isVarType(v,VAR_TYPE_BGCOLOR)?wrapBgColorVariableName(v):_this.isVarType(v,VAR_TYPE_BGIMG)?wrapBgImgVariableName(v):(unknownVars.add(v),v)}),(function(fallback){return tryModifyBgColor(fallback,theme)}));if("box-shadow"===property){var modifiedShadow=getShadowModifierWithInfo(variableReplaced)(theme);if(modifiedShadow.unparseableMatchesLength!==modifiedShadow.matchesLength)return modifiedShadow.result}return variableReplaced},modified=modify();return unknownVars.size>0?modified.match(/^var\(.*?, var\(--darkreader-bg--.*\)\)$/)?modified:new Promise((function(resolve){var firstUnknownVar=unknownVars.values().next().value,callback=function(){_this.unsubscribeFromVariableTypeChanges(firstUnknownVar,callback);var newValue=modify();resolve(newValue)};_this.subscribeForVarTypeChange(firstUnknownVar,callback)})):modified}:property.startsWith("border")||property.startsWith("outline")?function(theme){return replaceCSSVariablesNames(sourceValue,(function(v){return wrapBorderColorVariableName(v)}),(function(fallback){return tryModifyBorderColor(fallback,theme)}))}:null},VariablesStore.prototype.subscribeForVarTypeChange=function(varName,callback){this.typeChangeSubscriptions.has(varName)||this.typeChangeSubscriptions.set(varName,new Set);var rootStore=this.typeChangeSubscriptions.get(varName);rootStore.has(callback)||rootStore.add(callback)},VariablesStore.prototype.unsubscribeFromVariableTypeChanges=function(varName,callback){this.typeChangeSubscriptions.has(varName)&&this.typeChangeSubscriptions.get(varName).delete(callback)},VariablesStore.prototype.collectVariablesAndVarDep=function(){var _this=this;this.rulesQueue.forEach((function(rules){iterateCSSRules(rules,(function(rule){rule.style&&_this.collectVarsFromCSSDeclarations(rule.style)}))})),this.inlineStyleQueue.forEach((function(style){_this.collectVarsFromCSSDeclarations(style)})),this.rulesQueue.splice(0),this.inlineStyleQueue.splice(0)},VariablesStore.prototype.collectVarsFromCSSDeclarations=function(style){var _this=this;iterateCSSDeclarations(style,(function(property,value){isVariable(property)&&_this.inspectVariable(property,value),isVarDependant(value)&&_this.inspectVarDependant(property,value)}))},VariablesStore.prototype.shouldProcessRootVariables=function(){var _a;return this.rulesQueue.length>0&&(null===(_a=document.documentElement.getAttribute("style"))||void 0===_a?void 0:_a.includes("--"))},VariablesStore.prototype.collectRootVariables=function(){var _this=this;this.shouldProcessRootVariables()&&iterateCSSDeclarations(document.documentElement.style,(function(property,value){isVariable(property)&&_this.inspectVariable(property,value)}))},VariablesStore.prototype.inspectVariable=function(varName,value){this.unstableVarValues.set(varName,value),isVarDependant(value)&&isConstructedColorVar(value)&&(this.unknownColorVars.add(varName),this.definedVars.add(varName)),this.definedVars.has(varName)||(this.definedVars.add(varName),rawValueRegex.test(value)||parseColorWithCache(value)?this.unknownColorVars.add(varName):(value.includes("url(")||value.includes("linear-gradient(")||value.includes("radial-gradient("))&&this.resolveVariableType(varName,VAR_TYPE_BGIMG))},VariablesStore.prototype.resolveVariableType=function(varName,typeNum){var initialType=this.initialVarTypes.get(varName)||0,newType=(this.varTypes.get(varName)||0)|typeNum;this.varTypes.set(varName,newType),(newType!==initialType||this.undefinedVars.has(varName))&&(this.changedTypeVars.add(varName),this.undefinedVars.delete(varName)),this.unknownColorVars.delete(varName),this.unknownBgVars.delete(varName)},VariablesStore.prototype.collectRootVarDependents=function(){var _this=this;this.shouldProcessRootVariables()&&iterateCSSDeclarations(document.documentElement.style,(function(property,value){isVarDependant(value)&&_this.inspectVarDependant(property,value)}))},VariablesStore.prototype.inspectVarDependant=function(property,value){var _this=this;isVariable(property)?this.iterateVarDeps(value,(function(ref){_this.varRefs.has(property)||_this.varRefs.set(property,new Set),_this.varRefs.get(property).add(ref)})):"background-color"===property||"box-shadow"===property?this.iterateVarDeps(value,(function(v){return _this.resolveVariableType(v,VAR_TYPE_BGCOLOR)})):isTextColorProperty(property)?this.iterateVarDeps(value,(function(v){return _this.resolveVariableType(v,VAR_TYPE_TEXTCOLOR)})):property.startsWith("border")||property.startsWith("outline")?this.iterateVarDeps(value,(function(v){return _this.resolveVariableType(v,VAR_TYPE_BORDERCOLOR)})):"background"!==property&&"background-image"!==property||this.iterateVarDeps(value,(function(v){if(!_this.isVarType(v,VAR_TYPE_BGCOLOR|VAR_TYPE_BGIMG)){var isBgColor=null!=_this.findVarRef(v,(function(ref){return _this.unknownColorVars.has(ref)||_this.isVarType(ref,VAR_TYPE_TEXTCOLOR|VAR_TYPE_BORDERCOLOR)}));_this.iterateVarRefs(v,(function(ref){isBgColor?_this.resolveVariableType(ref,VAR_TYPE_BGCOLOR):_this.unknownBgVars.add(ref)}))}}))},VariablesStore.prototype.iterateVarDeps=function(value,iterator){var varDeps=new Set;iterateVarDependencies(value,(function(v){return varDeps.add(v)})),varDeps.forEach((function(v){return iterator(v)}))},VariablesStore.prototype.findVarRef=function(varName,iterator,stack){var e_1,_a;if(void 0===stack&&(stack=new Set),stack.has(varName))return null;if(stack.add(varName),iterator(varName))return varName;var refs=this.varRefs.get(varName);if(!refs||0===refs.size)return null;try{for(var refs_1=__values(refs),refs_1_1=refs_1.next();!refs_1_1.done;refs_1_1=refs_1.next()){var ref=refs_1_1.value,found=this.findVarRef(ref,iterator,stack);if(found)return found}}catch(e_1_1){e_1={error:e_1_1}}finally{try{refs_1_1&&!refs_1_1.done&&(_a=refs_1.return)&&_a.call(refs_1)}finally{if(e_1)throw e_1.error}}return null},VariablesStore.prototype.iterateVarRefs=function(varName,iterator){this.findVarRef(varName,(function(ref){return iterator(ref),!1}))},VariablesStore.prototype.setOnRootVariableChange=function(callback){this.onRootVariableDefined=callback},VariablesStore.prototype.putRootVars=function(styleElement,theme){var e_2,_a,_this=this,sheet=styleElement.sheet;sheet.cssRules.length>0&&sheet.deleteRule(0);var declarations=new Map;iterateCSSDeclarations(document.documentElement.style,(function(property,value){isVariable(property)&&(_this.isVarType(property,VAR_TYPE_BGCOLOR)&&declarations.set(wrapBgColorVariableName(property),tryModifyBgColor(value,theme)),_this.isVarType(property,VAR_TYPE_TEXTCOLOR)&&declarations.set(wrapTextColorVariableName(property),tryModifyTextColor(value,theme)),_this.isVarType(property,VAR_TYPE_BORDERCOLOR)&&declarations.set(wrapBorderColorVariableName(property),tryModifyBorderColor(value,theme)),_this.subscribeForVarTypeChange(property,_this.onRootVariableDefined))}));var cssLines=[];cssLines.push(":root {");try{for(var declarations_1=__values(declarations),declarations_1_1=declarations_1.next();!declarations_1_1.done;declarations_1_1=declarations_1.next()){var _b=__read(declarations_1_1.value,2),property=_b[0],value=_b[1];cssLines.push("    ".concat(property,": ").concat(value,";"))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{declarations_1_1&&!declarations_1_1.done&&(_a=declarations_1.return)&&_a.call(declarations_1)}finally{if(e_2)throw e_2.error}}cssLines.push("}");var cssText=cssLines.join("\n");sheet.insertRule(cssText)},VariablesStore}());function getVariableRange(input,searchStart){void 0===searchStart&&(searchStart=0);var start=input.indexOf("var(",searchStart);if(start>=0){var range=getParenthesesRange(input,start+3);if(range)return{start,end:range.end}}return null}function getVariablesMatches(input){for(var range,ranges=[],i=0;range=getVariableRange(input,i);){var start=range.start,end=range.end;ranges.push({start,end,value:input.substring(start,end)}),i=range.end+1}return ranges}function replaceVariablesMatches(input,replacer){var matches=getVariablesMatches(input),matchesCount=matches.length;if(0===matchesCount)return input;var inputLength=input.length,replacements=matches.map((function(m){return replacer(m.value)})),parts=[];parts.push(input.substring(0,matches[0].start));for(var i=0;i<matchesCount;i++){parts.push(replacements[i]);var start=matches[i].end,end=i<matchesCount-1?matches[i+1].start:inputLength;parts.push(input.substring(start,end))}return parts.join("")}function getVariableNameAndFallback(match){var name,fallback,commaIndex=match.indexOf(",");return commaIndex>=0?(name=match.substring(4,commaIndex).trim(),fallback=match.substring(commaIndex+1,match.length-1).trim()):(name=match.substring(4,match.length-1).trim(),fallback=""),{name,fallback}}function replaceCSSVariablesNames(value,nameReplacer,fallbackReplacer){return replaceVariablesMatches(value,(function(match){var newFallback,_a=getVariableNameAndFallback(match),name=_a.name,fallback=_a.fallback,newName=nameReplacer(name);return fallback?(newFallback=isVarDependant(fallback)?replaceCSSVariablesNames(fallback,nameReplacer,fallbackReplacer):fallbackReplacer?fallbackReplacer(fallback):fallback,"var(".concat(newName,", ").concat(newFallback,")")):"var(".concat(newName,")")}))}function iterateVarDependencies(value,iterator){replaceCSSVariablesNames(value,(function(varName){return iterator(varName),varName}))}function wrapBgColorVariableName(name){return"--darkreader-bg".concat(name)}function wrapTextColorVariableName(name){return"--darkreader-text".concat(name)}function wrapBorderColorVariableName(name){return"--darkreader-border".concat(name)}function wrapBgImgVariableName(name){return"--darkreader-bgimg".concat(name)}function isVariable(property){return property.startsWith("--")}function isVarDependant(value){return value.includes("var(")}function isConstructedColorVar(value){return value.match(/^\s*(rgb|hsl)a?\(/)}function isTextColorProperty(property){return"color"===property||"caret-color"===property||"-webkit-text-fill-color"===property}var rawValueRegex=/^\d{1,3}, ?\d{1,3}, ?\d{1,3}$/;function parseRawValue(color){if(rawValueRegex.test(color)){var splitted=color.split(","),resultInRGB_1="rgb(";return splitted.forEach((function(number){resultInRGB_1+="".concat(number.trim(),", ")})),resultInRGB_1=resultInRGB_1.substring(0,resultInRGB_1.length-2),{isRaw:!0,color:resultInRGB_1+=")"}}return{isRaw:!1,color}}function handleRawValue(color,theme,modifyFunction){var _a=parseRawValue(color),isRaw=_a.isRaw,newColor=_a.color,rgb=parseColorWithCache(newColor);if(rgb){var outputColor=modifyFunction(rgb,theme);if(isRaw){var outputInRGB=parseColorWithCache(outputColor);return outputInRGB?"".concat(outputInRGB.r,", ").concat(outputInRGB.g,", ").concat(outputInRGB.b):outputColor}return outputColor}return newColor}function tryModifyBgColor(color,theme){return handleRawValue(color,theme,modifyBackgroundColor)}function tryModifyTextColor(color,theme){return handleRawValue(color,theme,modifyForegroundColor)}function tryModifyBorderColor(color,theme){return handleRawValue(color,theme,modifyBorderColor)}function insertVarValues(source,varValues,stack){void 0===stack&&(stack=new Set);var containsUnresolvedVar=!1,replaced=replaceVariablesMatches(source,(function(match){var _a=getVariableNameAndFallback(match),name=_a.name,fallback=_a.fallback;if(stack.has(name))return containsUnresolvedVar=!0,null;stack.add(name);var varValue=varValues.get(name)||fallback,inserted=null;return varValue&&(inserted=isVarDependant(varValue)?insertVarValues(varValue,varValues,stack):varValue),inserted||(containsUnresolvedVar=!0,null)}));return containsUnresolvedVar?null:replaced}var overrides$1={"background-color":{customProp:"--darkreader-inline-bgcolor",cssProp:"background-color",dataAttr:"data-darkreader-inline-bgcolor"},"background-image":{customProp:"--darkreader-inline-bgimage",cssProp:"background-image",dataAttr:"data-darkreader-inline-bgimage"},"border-color":{customProp:"--darkreader-inline-border",cssProp:"border-color",dataAttr:"data-darkreader-inline-border"},"border-bottom-color":{customProp:"--darkreader-inline-border-bottom",cssProp:"border-bottom-color",dataAttr:"data-darkreader-inline-border-bottom"},"border-left-color":{customProp:"--darkreader-inline-border-left",cssProp:"border-left-color",dataAttr:"data-darkreader-inline-border-left"},"border-right-color":{customProp:"--darkreader-inline-border-right",cssProp:"border-right-color",dataAttr:"data-darkreader-inline-border-right"},"border-top-color":{customProp:"--darkreader-inline-border-top",cssProp:"border-top-color",dataAttr:"data-darkreader-inline-border-top"},"box-shadow":{customProp:"--darkreader-inline-boxshadow",cssProp:"box-shadow",dataAttr:"data-darkreader-inline-boxshadow"},color:{customProp:"--darkreader-inline-color",cssProp:"color",dataAttr:"data-darkreader-inline-color"},fill:{customProp:"--darkreader-inline-fill",cssProp:"fill",dataAttr:"data-darkreader-inline-fill"},stroke:{customProp:"--darkreader-inline-stroke",cssProp:"stroke",dataAttr:"data-darkreader-inline-stroke"},"outline-color":{customProp:"--darkreader-inline-outline",cssProp:"outline-color",dataAttr:"data-darkreader-inline-outline"},"stop-color":{customProp:"--darkreader-inline-stopcolor",cssProp:"stop-color",dataAttr:"data-darkreader-inline-stopcolor"}},shorthandOverrides={background:{customProp:"--darkreader-inline-bg",cssProp:"background",dataAttr:"data-darkreader-inline-bg"}},overridesList=Object.values(overrides$1),normalizedPropList={};overridesList.forEach((function(_a){var cssProp=_a.cssProp,customProp=_a.customProp;return normalizedPropList[customProp]=cssProp}));var INLINE_STYLE_ATTRS=["style","fill","stop-color","stroke","bgcolor","color"],INLINE_STYLE_SELECTOR=INLINE_STYLE_ATTRS.map((function(attr){return"[".concat(attr,"]")})).join(", ");function getInlineOverrideStyle(){return overridesList.concat(Object.values(shorthandOverrides)).map((function(_a){var dataAttr=_a.dataAttr,customProp=_a.customProp,cssProp=_a.cssProp;return["[".concat(dataAttr,"] {"),"  ".concat(cssProp,": var(").concat(customProp,") !important;"),"}"].join("\n")})).join("\n")}function getInlineStyleElements(root){var results=[];return root instanceof Element&&root.matches(INLINE_STYLE_SELECTOR)&&results.push(root),(root instanceof Element||isShadowDomSupported&&root instanceof ShadowRoot||root instanceof Document)&&push(results,root.querySelectorAll(INLINE_STYLE_SELECTOR)),results}var treeObservers=new Map,attrObservers=new Map;function watchForInlineStyles(elementStyleDidChange,shadowRootDiscovered){deepWatchForInlineStyles(document,elementStyleDidChange,shadowRootDiscovered),iterateShadowHosts(document.documentElement,(function(host){deepWatchForInlineStyles(host.shadowRoot,elementStyleDidChange,shadowRootDiscovered)}))}function deepWatchForInlineStyles(root,elementStyleDidChange,shadowRootDiscovered){treeObservers.has(root)&&(treeObservers.get(root).disconnect(),attrObservers.get(root).disconnect());var discoveredNodes=new WeakSet;function discoverNodes(node){getInlineStyleElements(node).forEach((function(el){discoveredNodes.has(el)||(discoveredNodes.add(el),elementStyleDidChange(el))})),iterateShadowHosts(node,(function(n){discoveredNodes.has(node)||(discoveredNodes.add(node),shadowRootDiscovered(n.shadowRoot),deepWatchForInlineStyles(n.shadowRoot,elementStyleDidChange,shadowRootDiscovered))})),variablesStore.matchVariablesAndDependents()}var treeObserver=createOptimizedTreeObserver(root,{onMinorMutations:function(_a){_a.additions.forEach((function(added){return discoverNodes(added)}))},onHugeMutations:function(){discoverNodes(root)}});treeObservers.set(root,treeObserver);var attemptCount=0,start=null,ATTEMPTS_INTERVAL=getDuration({seconds:10}),RETRY_TIMEOUT=getDuration({seconds:2}),MAX_ATTEMPTS_COUNT=50,cache=[],timeoutId=null,handleAttributeMutations=throttle((function(mutations){var handledTargets=new Set;mutations.forEach((function(m){var target=m.target;handledTargets.has(target)||INLINE_STYLE_ATTRS.includes(m.attributeName)&&(handledTargets.add(target),elementStyleDidChange(target))})),variablesStore.matchVariablesAndDependents()})),attrObserver=new MutationObserver((function(mutations){if(timeoutId)cache.push.apply(cache,__spreadArray([],__read(mutations),!1));else{attemptCount++;var now=Date.now();if(null==start)start=now;else if(attemptCount>=MAX_ATTEMPTS_COUNT){if(now-start<ATTEMPTS_INTERVAL)return timeoutId=setTimeout((function(){start=null,attemptCount=0,timeoutId=null;var attributeCache=cache;cache=[],handleAttributeMutations(attributeCache)}),RETRY_TIMEOUT),void cache.push.apply(cache,__spreadArray([],__read(mutations),!1));start=now,attemptCount=1}handleAttributeMutations(mutations)}}));attrObserver.observe(root,{attributes:!0,attributeFilter:INLINE_STYLE_ATTRS.concat(overridesList.map((function(_a){return _a.dataAttr}))),subtree:!0}),attrObservers.set(root,attrObserver)}function stopWatchingForInlineStyles(){treeObservers.forEach((function(o){return o.disconnect()})),attrObservers.forEach((function(o){return o.disconnect()})),treeObservers.clear(),attrObservers.clear()}var inlineStyleCache=new WeakMap,filterProps=["brightness","contrast","grayscale","sepia","mode"];function getInlineStyleCacheKey(el,theme){return INLINE_STYLE_ATTRS.map((function(attr){return"".concat(attr,'="').concat(el.getAttribute(attr),'"')})).concat(filterProps.map((function(prop){return"".concat(prop,'="').concat(theme[prop],'"')}))).join(" ")}function shouldIgnoreInlineStyle(element,selectors){for(var i=0,len=selectors.length;i<len;i++){var ingnoredSelector=selectors[i];if(element.matches(ingnoredSelector))return!0}return!1}function overrideInlineStyle(element,theme,ignoreInlineSelectors,ignoreImageSelectors){var _a;if(getInlineStyleCacheKey(element,theme)!==inlineStyleCache.get(element)){var unsetProps=new Set(Object.keys(overrides$1));if(ignoreInlineSelectors.length>0&&shouldIgnoreInlineStyle(element,ignoreInlineSelectors))unsetProps.forEach((function(cssProp){element.removeAttribute(overrides$1[cssProp].dataAttr)}));else{if(element.hasAttribute("bgcolor")&&(((value=element.getAttribute("bgcolor")).match(/^[0-9a-f]{3}$/i)||value.match(/^[0-9a-f]{6}$/i))&&(value="#".concat(value)),setCustomProp("background-color","background-color",value)),element.hasAttribute("color")&&"mask-icon"!==element.rel&&(((value=element.getAttribute("color")).match(/^[0-9a-f]{3}$/i)||value.match(/^[0-9a-f]{6}$/i))&&(value="#".concat(value)),setCustomProp("color","color",value)),element instanceof SVGElement){if(element.hasAttribute("fill")){var SMALL_SVG_LIMIT_1=32,value_1=element.getAttribute("fill");if("none"!==value_1)if(element instanceof SVGTextElement)setCustomProp("fill","color",value_1);else{var handleSVGElement=function(){var _a=element.getBoundingClientRect(),width=_a.width,height=_a.height;setCustomProp("fill",width>SMALL_SVG_LIMIT_1||height>SMALL_SVG_LIMIT_1?"background-color":"color",value_1)};isReadyStateComplete()?handleSVGElement():addReadyStateCompleteListener(handleSVGElement)}}element.hasAttribute("stop-color")&&setCustomProp("stop-color","background-color",element.getAttribute("stop-color"))}if(element.hasAttribute("stroke")){var value=element.getAttribute("stroke");setCustomProp("stroke",element instanceof SVGLineElement||element instanceof SVGTextElement?"border-color":"color",value)}element.style&&iterateCSSDeclarations(element.style,(function(property,value){if("background-image"!==property||!value.includes("url"))if(overrides$1.hasOwnProperty(property)||property.startsWith("--")&&!normalizedPropList[property])setCustomProp(property,property,value);else if("background"===property&&value.includes("var("))setCustomProp("background","background",value);else{var overriddenProp=normalizedPropList[property];if(overriddenProp&&!element.style.getPropertyValue(overriddenProp)&&!element.hasAttribute(overriddenProp)){if("background-color"===overriddenProp&&element.hasAttribute("bgcolor"))return;element.style.setProperty(property,"")}}})),element.style&&element instanceof SVGTextElement&&element.style.fill&&setCustomProp("fill","color",element.style.getPropertyValue("fill")),(null===(_a=element.getAttribute("style"))||void 0===_a?void 0:_a.includes("--"))&&variablesStore.addInlineStyleForMatching(element.style),forEach(unsetProps,(function(cssProp){element.removeAttribute(overrides$1[cssProp].dataAttr)})),inlineStyleCache.set(element,getInlineStyleCacheKey(element,theme))}}function setCustomProp(targetCSSProp,modifierCSSProp,cssVal){var mod=getModifiableCSSDeclaration(modifierCSSProp,cssVal,{style:element.style},variablesStore,ignoreImageSelectors,null);if(mod){var value="function"==typeof mod.value?mod.value(theme):mod.value;"string"==typeof value?setStaticValue(value):value instanceof Promise?setAsyncValue(value):"object"==typeof value&&setVarDeclaration(value)}function setStaticValue(value){var _a,_b=null!==(_a=overrides$1[targetCSSProp])&&void 0!==_a?_a:shorthandOverrides[targetCSSProp],customProp=_b.customProp,dataAttr=_b.dataAttr;element.style.setProperty(customProp,value),element.hasAttribute(dataAttr)||element.setAttribute(dataAttr,""),unsetProps.delete(targetCSSProp)}function setVarDeclaration(mod){var prevDeclarations=[];function setProps(declarations){prevDeclarations.forEach((function(_a){var property=_a.property;element.style.removeProperty(property)})),declarations.forEach((function(_a){var property=_a.property,value=_a.value;value instanceof Promise||element.style.setProperty(property,value)})),prevDeclarations=declarations}setProps(mod.declarations),mod.onTypeChange.addListener(setProps)}function setAsyncValue(promise){promise.then((function(value){value&&"background"===targetCSSProp&&value.startsWith("var(--darkreader-bg--")&&setStaticValue(value)}))}}}var metaThemeColorName="theme-color",metaThemeColorSelector='meta[name="'.concat(metaThemeColorName,'"]'),srcMetaThemeColor=null,observer=null;function changeMetaThemeColor(meta,theme){var color=parseColorWithCache(srcMetaThemeColor=srcMetaThemeColor||meta.content);color&&(meta.content=modifyBackgroundColor(color,theme))}function changeMetaThemeColorWhenAvailable(theme){var meta=document.querySelector(metaThemeColorSelector);meta?changeMetaThemeColor(meta,theme):(observer&&observer.disconnect(),(observer=new MutationObserver((function(mutations){loop:for(var i=0;i<mutations.length;i++)for(var addedNodes=mutations[i].addedNodes,j=0;j<addedNodes.length;j++){var node=addedNodes[j];if(node instanceof HTMLMetaElement&&node.name===metaThemeColorName){observer.disconnect(),observer=null,changeMetaThemeColor(node,theme);break loop}}}))).observe(document.head,{childList:!0}))}function restoreMetaThemeColor(){observer&&(observer.disconnect(),observer=null);var meta=document.querySelector(metaThemeColorSelector);meta&&srcMetaThemeColor&&(meta.content=srcMetaThemeColor)}var themeCacheKeys=["mode","brightness","contrast","grayscale","sepia","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor"];function getThemeKey(theme){var resultKey="";return themeCacheKeys.forEach((function(key){resultKey+="".concat(key,":").concat(theme[key],";")})),resultKey}var asyncQueue=createAsyncTasksQueue();function createStyleSheetModifier(){var renderId=0,rulesTextCache=new Set,rulesModCache=new Map,varTypeChangeCleaners=new Set,prevFilterKey=null,hasNonLoadedLink=!1,wasRebuilt=!1;function shouldRebuildStyle(){return hasNonLoadedLink&&!wasRebuilt}function modifySheet(options){var rules=options.sourceCSSRules,theme=options.theme,ignoreImageAnalysis=options.ignoreImageAnalysis,force=options.force,prepareSheet=options.prepareSheet,isAsyncCancelled=options.isAsyncCancelled,rulesChanged=0===rulesModCache.size,notFoundCacheKeys=new Set(rulesModCache.keys()),themeKey=getThemeKey(theme),themeChanged=themeKey!==prevFilterKey;hasNonLoadedLink&&(wasRebuilt=!0);var modRules=[];if(iterateCSSRules(rules,(function(rule){var cssText=rule.cssText,textDiffersFromPrev=!1;if(notFoundCacheKeys.delete(cssText),rule.parentRule instanceof CSSMediaRule&&(cssText+=";".concat(rule.parentRule.media.mediaText)),rulesTextCache.has(cssText)||(rulesTextCache.add(cssText),textDiffersFromPrev=!0),textDiffersFromPrev){if(rulesChanged=!0,"revert"!==rule.style.all){var modDecs=[];rule.style&&iterateCSSDeclarations(rule.style,(function(property,value){var mod=getModifiableCSSDeclaration(property,value,rule,variablesStore,ignoreImageAnalysis,isAsyncCancelled);mod&&modDecs.push(mod)}));var modRule=null;if(modDecs.length>0){var parentRule=rule.parentRule;modRule={selector:rule.selectorText,declarations:modDecs,parentRule},modRules.push(modRule)}rulesModCache.set(cssText,modRule)}}else modRules.push(rulesModCache.get(cssText))}),(function(){hasNonLoadedLink=!0})),notFoundCacheKeys.forEach((function(key){rulesTextCache.delete(key),rulesModCache.delete(key)})),prevFilterKey=themeKey,force||rulesChanged||themeChanged){renderId++;var asyncDeclarations=new Map,varDeclarations=new Map,asyncDeclarationCounter=0,varDeclarationCounter=0,rootReadyGroup={rule:null,rules:[],isGroup:!0},groupRefs=new WeakMap;varTypeChangeCleaners.forEach((function(clear){return clear()})),varTypeChangeCleaners.clear(),modRules.filter((function(r){return r})).forEach((function(_a){var selector=_a.selector,declarations=_a.declarations,group=getGroup(_a.parentRule),readyStyleRule={selector,declarations:[],isGroup:!1},readyDeclarations=readyStyleRule.declarations;function handleAsyncDeclaration(property,modified,important,sourceValue){var asyncKey=++asyncDeclarationCounter,asyncDeclaration={property,value:null,important,asyncKey,sourceValue};readyDeclarations.push(asyncDeclaration);var currentRenderId=renderId;modified.then((function(asyncValue){asyncValue&&!isAsyncCancelled()&&currentRenderId===renderId&&(asyncDeclaration.value=asyncValue,asyncQueue.add((function(){isAsyncCancelled()||currentRenderId!==renderId||rebuildAsyncRule(asyncKey)})))}))}function handleVarDeclarations(property,modified,important,sourceValue){var varDecs=modified.declarations,onTypeChange=modified.onTypeChange,varKey=++varDeclarationCounter,currentRenderId=renderId,initialIndex=readyDeclarations.length,oldDecs=[];if(0===varDecs.length){var tempDec={property,value:sourceValue,important,sourceValue,varKey};readyDeclarations.push(tempDec),oldDecs=[tempDec]}varDecs.forEach((function(mod){if(mod.value instanceof Promise)handleAsyncDeclaration(mod.property,mod.value,important,sourceValue);else{var readyDec={property:mod.property,value:mod.value,important,sourceValue,varKey};readyDeclarations.push(readyDec),oldDecs.push(readyDec)}})),onTypeChange.addListener((function(newDecs){if(!isAsyncCancelled()&&currentRenderId===renderId){var readyVarDecs=newDecs.map((function(mod){return{property:mod.property,value:mod.value,important,sourceValue,varKey}})),index=readyDeclarations.indexOf(oldDecs[0],initialIndex);readyDeclarations.splice.apply(readyDeclarations,__spreadArray([index,oldDecs.length],__read(readyVarDecs),!1)),oldDecs=readyVarDecs,rebuildVarRule(varKey)}})),varTypeChangeCleaners.add((function(){return onTypeChange.removeListeners()}))}group.rules.push(readyStyleRule),declarations.forEach((function(_a){var property=_a.property,value=_a.value,important=_a.important,sourceValue=_a.sourceValue;if("function"==typeof value){var modified=value(theme);modified instanceof Promise?handleAsyncDeclaration(property,modified,important,sourceValue):property.startsWith("--")?handleVarDeclarations(property,modified,important,sourceValue):readyDeclarations.push({property,value:modified,important,sourceValue})}else readyDeclarations.push({property,value,important,sourceValue})}))}));var sheet=prepareSheet();buildStyleSheet()}function setRule(target,index,rule){var e_1,_a,selector=rule.selector,declarations=rule.declarations,selectorText=selector,emptyIsWhereSelector=isChromium&&selector.startsWith(":is(")&&(selector.includes(":is()")||selector.includes(":where()")||selector.includes(":where(")&&selector.includes(":-moz")),viewTransitionSelector=selector.includes("::view-transition-");(emptyIsWhereSelector||viewTransitionSelector)&&(selectorText=".darkreader-unsupported-selector");var ruleText="".concat(selectorText," {");try{for(var declarations_1=__values(declarations),declarations_1_1=declarations_1.next();!declarations_1_1.done;declarations_1_1=declarations_1.next()){var dec=declarations_1_1.value,property=dec.property,value=dec.value,important=dec.important;value&&(ruleText+=" ".concat(property,": ").concat(value).concat(important?" !important":"",";"))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{declarations_1_1&&!declarations_1_1.done&&(_a=declarations_1.return)&&_a.call(declarations_1)}finally{if(e_1)throw e_1.error}}ruleText+=" }",target.insertRule(ruleText,index)}function getGroup(rule){if(null==rule)return rootReadyGroup;if(groupRefs.has(rule))return groupRefs.get(rule);var group={rule,rules:[],isGroup:!0};return groupRefs.set(rule,group),getGroup(rule.parentRule).rules.push(group),group}function buildStyleSheet(){function createTarget(group,parent){var rule=group.rule;if(rule instanceof CSSMediaRule){var media=rule.media,index=parent.cssRules.length;return parent.insertRule("@media ".concat(media.mediaText," {}"),index),parent.cssRules[index]}return parent}function iterateReadyRules(group,target,styleIterator){group.rules.forEach((function(r){r.isGroup?iterateReadyRules(r,createTarget(r,target),styleIterator):styleIterator(r,target)}))}iterateReadyRules(rootReadyGroup,sheet,(function(rule,target){var index=target.cssRules.length;rule.declarations.forEach((function(_a){var asyncKey=_a.asyncKey,varKey=_a.varKey;null!=asyncKey&&asyncDeclarations.set(asyncKey,{rule,target,index}),null!=varKey&&varDeclarations.set(varKey,{rule,target,index})})),setRule(target,index,rule)}))}function rebuildAsyncRule(key){var _a=asyncDeclarations.get(key),rule=_a.rule,target=_a.target,index=_a.index;target.deleteRule(index),setRule(target,index,rule),asyncDeclarations.delete(key)}function rebuildVarRule(key){var _a=varDeclarations.get(key),rule=_a.rule,target=_a.target,index=_a.index;target.deleteRule(index),setRule(target,index,rule)}}return{modifySheet,shouldRebuildStyle}}var STYLE_SELECTOR='style, link[rel*="stylesheet" i]:not([disabled])';function isFontsGoogleApiStyle(element){if(!element.href)return!1;try{return"fonts.googleapis.com"===new URL(element.href).hostname}catch(err){return logInfo("Couldn't construct ".concat(element.href," as URL")),!1}}var hostsBreakingOnSVGStyleOverride=["www.onet.pl"];function shouldManageStyle(element){return(element instanceof HTMLStyleElement||element instanceof SVGStyleElement&&!hostsBreakingOnSVGStyleOverride.includes(location.hostname)||element instanceof HTMLLinkElement&&Boolean(element.rel)&&element.rel.toLowerCase().includes("stylesheet")&&Boolean(element.href)&&!element.disabled&&(!isFirefox||!element.href.startsWith("moz-extension://"))&&!isFontsGoogleApiStyle(element))&&!element.classList.contains("darkreader")&&"print"!==element.media.toLowerCase()&&!element.classList.contains("stylus")}function getManageableStyles(node,results,deep){return void 0===results&&(results=[]),void 0===deep&&(deep=!0),shouldManageStyle(node)?results.push(node):(node instanceof Element||isShadowDomSupported&&node instanceof ShadowRoot||node===document)&&(forEach(node.querySelectorAll(STYLE_SELECTOR),(function(style){return getManageableStyles(style,results,!1)})),deep&&iterateShadowHosts(node,(function(host){return getManageableStyles(host.shadowRoot,results,!1)}))),results}var syncStyleSet=new WeakSet,corsStyleSet=new WeakSet,canOptimizeUsingProxy$1=!1;document.addEventListener("__darkreader__inlineScriptsAllowed",(function(){canOptimizeUsingProxy$1=!0}),{once:!0,passive:!0});var loadingLinkCounter=0,rejectorsForLoadingLinks=new Map;function cleanLoadingLinks(){rejectorsForLoadingLinks.clear()}function manageStyle(element,_a){for(var update=_a.update,loadingStart=_a.loadingStart,loadingEnd=_a.loadingEnd,prevStyles=[],next=element;(next=next.nextElementSibling)&&next.matches(".darkreader");)prevStyles.push(next);var corsCopy=prevStyles.find((function(el){return el.matches(".darkreader--cors")&&!corsStyleSet.has(el)}))||null,syncStyle=prevStyles.find((function(el){return el.matches(".darkreader--sync")&&!syncStyleSet.has(el)}))||null,corsCopyPositionWatcher=null,syncStylePositionWatcher=null,cancelAsyncOperations=!1,isOverrideEmpty=!0,sheetModifier=createStyleSheetModifier(),observer=new MutationObserver((function(){update()})),observerOptions={attributes:!0,childList:!0,subtree:!0,characterData:!0};function containsCSSImport(){var _a;return element instanceof HTMLStyleElement&&removeCSSComments(null!==(_a=element.textContent)&&void 0!==_a?_a:"").trim().match(cssImportRegex)}function hasImports(cssRules,checkCrossOrigin){var result=!1;if(cssRules){var rule=void 0;cssRulesLoop:for(var i=0,len=cssRules.length;i<len;i++)if((rule=cssRules[i]).href){if(!checkCrossOrigin){result=!0;break cssRulesLoop}if(!rule.href.startsWith("https://fonts.googleapis.com/")&&rule.href.startsWith("http")&&!rule.href.startsWith(location.origin)){result=!0;break cssRulesLoop}}}return result}function getRulesSync(){if(corsCopy)return corsCopy.sheet.cssRules;if(containsCSSImport())return null;var cssRules=safeGetSheetRules();return element instanceof HTMLLinkElement&&!isRelativeHrefOnAbsolutePath(element.href)&&hasImports(cssRules,!1)||hasImports(cssRules,!0)?null:cssRules}function insertStyle(){corsCopy?(element.nextSibling!==corsCopy&&element.parentNode.insertBefore(corsCopy,element.nextSibling),corsCopy.nextSibling!==syncStyle&&element.parentNode.insertBefore(syncStyle,corsCopy.nextSibling)):element.nextSibling!==syncStyle&&element.parentNode.insertBefore(syncStyle,element.nextSibling)}function createSyncStyle(){(syncStyle=element instanceof SVGStyleElement?document.createElementNS("http://www.w3.org/2000/svg","style"):document.createElement("style")).classList.add("darkreader"),syncStyle.classList.add("darkreader--sync"),syncStyle.media="screen",element.title&&(syncStyle.title=element.title),syncStyleSet.add(syncStyle)}var isLoadingRules=!1,wasLoadingError=!1,loadingLinkId=++loadingLinkCounter;function getRulesAsync(){return __awaiter(this,void 0,void 0,(function(){var cssText,cssBasePath,_a,cssRules,accessError,fullCSSText,_b;return __generator(this,(function(_c){switch(_c.label){case 0:if(!(element instanceof HTMLLinkElement))return[3,7];if(_a=__read(getRulesOrError(),2),cssRules=_a[0],accessError=_a[1],(!isSafari||element.sheet)&&(isSafari||cssRules||accessError)&&!isStillLoadingError(accessError))return[3,5];_c.label=1;case 1:return _c.trys.push([1,3,,4]),[4,linkLoading(element,loadingLinkId)];case 2:return _c.sent(),[3,4];case 3:return _c.sent(),wasLoadingError=!0,[3,4];case 4:if(cancelAsyncOperations)return[2,null];_b=__read(getRulesOrError(),2),cssRules=_b[0],accessError=_b[1],_c.label=5;case 5:return cssRules&&!hasImports(cssRules,!1)?[2,cssRules]:[4,loadText(element.href)];case 6:return cssText=_c.sent(),cssBasePath=getCSSBaseBath(element.href),cancelAsyncOperations?[2,null]:[3,8];case 7:if(!containsCSSImport())return[2,null];cssText=element.textContent.trim(),cssBasePath=getCSSBaseBath(location.href),_c.label=8;case 8:if(!cssText)return[3,13];_c.label=9;case 9:return _c.trys.push([9,11,,12]),[4,replaceCSSImports(cssText,cssBasePath)];case 10:return fullCSSText=_c.sent(),corsCopy=createCORSCopy(element,fullCSSText),[3,12];case 11:return _c.sent(),[3,12];case 12:if(corsCopy)return corsCopyPositionWatcher=watchForNodePosition(corsCopy,"prev-sibling"),[2,corsCopy.sheet.cssRules];_c.label=13;case 13:return[2,null]}}))}))}function details(options){var rules=getRulesSync();return rules?{rules}:(options.secondRound||isLoadingRules||wasLoadingError||(isLoadingRules=!0,loadingStart(),getRulesAsync().then((function(results){isLoadingRules=!1,loadingEnd(),results&&update()})).catch((function(err){isLoadingRules=!1,loadingEnd()}))),null)}var forceRenderStyle=!1;function render(theme,ignoreImageAnalysis){var rules=getRulesSync();function removeCSSRulesFromSheet(sheet){if(sheet)for(var i=sheet.cssRules.length-1;i>=0;i--)sheet.deleteRule(i)}function prepareOverridesSheet(){return syncStyle||createSyncStyle(),syncStylePositionWatcher&&syncStylePositionWatcher.stop(),insertStyle(),null==syncStyle.sheet&&(syncStyle.textContent=""),removeCSSRulesFromSheet(syncStyle.sheet),syncStylePositionWatcher?syncStylePositionWatcher.run():syncStylePositionWatcher=watchForNodePosition(syncStyle,"prev-sibling",(function(){forceRenderStyle=!0,buildOverrides()})),syncStyle.sheet}function buildOverrides(){var force=forceRenderStyle;forceRenderStyle=!1,sheetModifier.modifySheet({prepareSheet:prepareOverridesSheet,sourceCSSRules:rules,theme,ignoreImageAnalysis,force,isAsyncCancelled:function(){return cancelAsyncOperations}}),isOverrideEmpty=0===syncStyle.sheet.cssRules.length,sheetModifier.shouldRebuildStyle()&&addReadyStateCompleteListener((function(){return update()}))}rules&&(cancelAsyncOperations=!1,buildOverrides())}function getRulesOrError(){try{return null==element.sheet?[null,null]:[element.sheet.cssRules,null]}catch(err){return[null,err]}}function isStillLoadingError(error){return error&&error.message&&error.message.includes("loading")}function safeGetSheetRules(){var _a=__read(getRulesOrError(),2),cssRules=_a[0];return _a[1]?null:cssRules}function watchForSheetChanges(){watchForSheetChangesUsingProxy(),canOptimizeUsingProxy$1&&element.sheet||watchForSheetChangesUsingRAF()}var rulesChangeKey=null,rulesCheckFrameId=null;function getRulesChangeKey(){var rules=safeGetSheetRules();return rules?rules.length:null}function didRulesKeyChange(){return getRulesChangeKey()!==rulesChangeKey}function watchForSheetChangesUsingRAF(){rulesChangeKey=getRulesChangeKey(),stopWatchingForSheetChangesUsingRAF();var checkForUpdate=function(){didRulesKeyChange()&&(rulesChangeKey=getRulesChangeKey(),update()),canOptimizeUsingProxy$1&&element.sheet?stopWatchingForSheetChangesUsingRAF():rulesCheckFrameId=requestAnimationFrame(checkForUpdate)};checkForUpdate()}function stopWatchingForSheetChangesUsingRAF(){cancelAnimationFrame(rulesCheckFrameId)}var areSheetChangesPending=!1;function onSheetChange(){function handleSheetChanges(){areSheetChangesPending=!1,cancelAsyncOperations||update()}canOptimizeUsingProxy$1=!0,stopWatchingForSheetChangesUsingRAF(),areSheetChangesPending||(areSheetChangesPending=!0,"function"==typeof queueMicrotask?queueMicrotask(handleSheetChanges):requestAnimationFrame(handleSheetChanges))}function watchForSheetChangesUsingProxy(){element.addEventListener("__darkreader__updateSheet",onSheetChange,{passive:!0})}function stopWatchingForSheetChangesUsingProxy(){element.removeEventListener("__darkreader__updateSheet",onSheetChange)}function stopWatchingForSheetChanges(){stopWatchingForSheetChangesUsingProxy(),stopWatchingForSheetChangesUsingRAF()}function pause(){observer.disconnect(),cancelAsyncOperations=!0,corsCopyPositionWatcher&&corsCopyPositionWatcher.stop(),syncStylePositionWatcher&&syncStylePositionWatcher.stop(),stopWatchingForSheetChanges()}function destroy(){if(pause(),removeNode(corsCopy),removeNode(syncStyle),loadingEnd(),rejectorsForLoadingLinks.has(loadingLinkId)){var reject=rejectorsForLoadingLinks.get(loadingLinkId);rejectorsForLoadingLinks.delete(loadingLinkId),reject&&reject()}}function watch(){observer.observe(element,observerOptions),element instanceof HTMLStyleElement&&watchForSheetChanges()}var maxMoveCount=10,moveCount=0;function restore(){syncStyle&&(++moveCount>maxMoveCount||(insertStyle(),corsCopyPositionWatcher&&corsCopyPositionWatcher.skip(),syncStylePositionWatcher&&syncStylePositionWatcher.skip(),isOverrideEmpty||(forceRenderStyle=!0,update())))}return{details,render,pause,destroy,watch,restore}}function linkLoading(link,loadingId){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,new Promise((function(resolve,reject){var cleanUp=function(){link.removeEventListener("load",onLoad),link.removeEventListener("error",onError),rejectorsForLoadingLinks.delete(loadingId)},onLoad=function(){cleanUp(),resolve()},onError=function(){cleanUp(),reject("Linkelement ".concat(loadingId," couldn't be loaded. ").concat(link.href))};rejectorsForLoadingLinks.set(loadingId,(function(){cleanUp(),reject()})),link.addEventListener("load",onLoad,{passive:!0}),link.addEventListener("error",onError,{passive:!0}),link.href||onError()}))]}))}))}function getCSSImportURL(importDeclaration){return getCSSURLValue(importDeclaration.substring(7).trim().replace(/;$/,"").replace(/screen$/,""))}function loadText(url){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return url.startsWith("data:")?[4,fetch(url)]:[3,3];case 1:return[4,_a.sent().text()];case 2:case 4:return[2,_a.sent()];case 3:return[4,bgFetch({url,responseType:"text",mimeType:"text/css",origin:window.location.origin})]}}))}))}function replaceCSSImports(cssText,basePath,cache){return void 0===cache&&(cache=new Map),__awaiter(this,void 0,void 0,(function(){var importMatches,importMatches_1,importMatches_1_1,match,importURL,absoluteURL,importedCSS,e_1_1,e_1,_a;return __generator(this,(function(_b){switch(_b.label){case 0:cssText=replaceCSSRelativeURLsWithAbsolute(cssText=replaceCSSFontFace(cssText=removeCSSComments(cssText)),basePath),importMatches=getMatches(cssImportRegex,cssText),_b.label=1;case 1:_b.trys.push([1,10,11,12]),importMatches_1=__values(importMatches),importMatches_1_1=importMatches_1.next(),_b.label=2;case 2:return importMatches_1_1.done?[3,9]:(match=importMatches_1_1.value,importURL=getCSSImportURL(match),absoluteURL=getAbsoluteURL(basePath,importURL),importedCSS=void 0,cache.has(absoluteURL)?(importedCSS=cache.get(absoluteURL),[3,7]):[3,3]);case 3:return _b.trys.push([3,6,,7]),[4,loadText(absoluteURL)];case 4:return importedCSS=_b.sent(),cache.set(absoluteURL,importedCSS),[4,replaceCSSImports(importedCSS,getCSSBaseBath(absoluteURL),cache)];case 5:return importedCSS=_b.sent(),[3,7];case 6:return _b.sent(),importedCSS="",[3,7];case 7:cssText=cssText.split(match).join(importedCSS),_b.label=8;case 8:return importMatches_1_1=importMatches_1.next(),[3,2];case 9:return[3,12];case 10:return e_1_1=_b.sent(),e_1={error:e_1_1},[3,12];case 11:try{importMatches_1_1&&!importMatches_1_1.done&&(_a=importMatches_1.return)&&_a.call(importMatches_1)}finally{if(e_1)throw e_1.error}return[7];case 12:return[2,cssText=cssText.trim()]}}))}))}function createCORSCopy(srcElement,cssText){if(!cssText)return null;var cors=document.createElement("style");return cors.classList.add("darkreader"),cors.classList.add("darkreader--cors"),cors.media="screen",cors.textContent=cssText,srcElement.parentNode.insertBefore(cors,srcElement.nextSibling),cors.sheet.disabled=!0,corsStyleSet.add(cors),cors}var observedRoots,elementsDefinitionCallback,observers=[],definedCustomElements=new Set,undefinedGroups=new Map;function isCustomElement(element){return!(!element.tagName.includes("-")&&!element.getAttribute("is"))}function recordUndefinedElement(element){var tag=element.tagName.toLowerCase();if(!tag.includes("-")){var extendedTag=element.getAttribute("is");if(!extendedTag)return;tag=extendedTag}undefinedGroups.has(tag)||(undefinedGroups.set(tag,new Set),customElementsWhenDefined(tag).then((function(){if(elementsDefinitionCallback){var elements=undefinedGroups.get(tag);undefinedGroups.delete(tag),elementsDefinitionCallback(Array.from(elements))}}))),undefinedGroups.get(tag).add(element)}function collectUndefinedElements(root){isDefinedSelectorSupported&&forEach(root.querySelectorAll(":not(:defined)"),recordUndefinedElement)}var canOptimizeUsingProxy=!1;document.addEventListener("__darkreader__inlineScriptsAllowed",(function(){canOptimizeUsingProxy=!0}),{once:!0,passive:!0});var resolvers=new Map;function handleIsDefined(e){canOptimizeUsingProxy=!0;var tag=e.detail.tag;if(definedCustomElements.add(tag),resolvers.has(tag)){var r=resolvers.get(tag);resolvers.delete(tag),r.forEach((function(r){return r()}))}}function customElementsWhenDefined(tag){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return definedCustomElements.has(tag)?[2]:[2,new Promise((function(resolve){if(window.customElements&&"function"==typeof customElements.whenDefined)customElements.whenDefined(tag).then((function(){return resolve()}));else if(canOptimizeUsingProxy)resolvers.has(tag)?resolvers.get(tag).push(resolve):resolvers.set(tag,[resolve]),document.dispatchEvent(new CustomEvent("__darkreader__addUndefinedResolver",{detail:{tag}}));else{var checkIfDefined_1=function(){var elements=undefinedGroups.get(tag);elements&&elements.size>0&&(elements.values().next().value.matches(":defined")?resolve():requestAnimationFrame(checkIfDefined_1))};requestAnimationFrame(checkIfDefined_1)}}))]}))}))}function watchWhenCustomElementsDefined(callback){elementsDefinitionCallback=callback}function unsubscribeFromDefineCustomElements(){elementsDefinitionCallback=null,undefinedGroups.clear(),document.removeEventListener("__darkreader__isDefined",handleIsDefined)}function watchForStyleChanges(currentStyles,update,shadowRootDiscovered){stopWatchingForStyleChanges();var prevStyles=new Set(currentStyles),prevStyleSiblings=new WeakMap,nextStyleSiblings=new WeakMap;function saveStylePosition(style){prevStyleSiblings.set(style,style.previousElementSibling),nextStyleSiblings.set(style,style.nextElementSibling)}function forgetStylePosition(style){prevStyleSiblings.delete(style),nextStyleSiblings.delete(style)}function didStylePositionChange(style){return style.previousElementSibling!==prevStyleSiblings.get(style)||style.nextElementSibling!==nextStyleSiblings.get(style)}function handleStyleOperations(operations){var createdStyles=operations.createdStyles,removedStyles=operations.removedStyles,movedStyles=operations.movedStyles;createdStyles.forEach((function(s){return saveStylePosition(s)})),movedStyles.forEach((function(s){return saveStylePosition(s)})),removedStyles.forEach((function(s){return forgetStylePosition(s)})),createdStyles.forEach((function(s){return prevStyles.add(s)})),removedStyles.forEach((function(s){return prevStyles.delete(s)})),createdStyles.size+removedStyles.size+movedStyles.size>0&&update({created:Array.from(createdStyles),removed:Array.from(removedStyles),moved:Array.from(movedStyles),updated:[]})}function handleMinorTreeMutations(_a){var additions=_a.additions,moves=_a.moves,deletions=_a.deletions,createdStyles=new Set,removedStyles=new Set,movedStyles=new Set;additions.forEach((function(node){return getManageableStyles(node).forEach((function(style){return createdStyles.add(style)}))})),deletions.forEach((function(node){return getManageableStyles(node).forEach((function(style){return removedStyles.add(style)}))})),moves.forEach((function(node){return getManageableStyles(node).forEach((function(style){return movedStyles.add(style)}))})),handleStyleOperations({createdStyles,removedStyles,movedStyles}),additions.forEach((function(n){extendedIterateShadowHosts(n),collectUndefinedElements(n)})),additions.forEach((function(node){return isCustomElement(node)&&recordUndefinedElement(node)}))}function handleHugeTreeMutations(root){var styles=new Set(getManageableStyles(root)),createdStyles=new Set,removedStyles=new Set,movedStyles=new Set;styles.forEach((function(s){prevStyles.has(s)||createdStyles.add(s)})),prevStyles.forEach((function(s){styles.has(s)||removedStyles.add(s)})),styles.forEach((function(s){createdStyles.has(s)||removedStyles.has(s)||!didStylePositionChange(s)||movedStyles.add(s)})),handleStyleOperations({createdStyles,removedStyles,movedStyles}),extendedIterateShadowHosts(root),collectUndefinedElements(root)}function handleAttributeMutations(mutations){var updatedStyles=new Set,removedStyles=new Set;mutations.forEach((function(m){var target=m.target;target.isConnected&&(shouldManageStyle(target)?updatedStyles.add(target):target instanceof HTMLLinkElement&&target.disabled&&removedStyles.add(target))})),updatedStyles.size+removedStyles.size>0&&update({updated:Array.from(updatedStyles),created:[],removed:Array.from(removedStyles),moved:[]})}function observe(root){if(!observedRoots.has(root)){var treeObserver=createOptimizedTreeObserver(root,{onMinorMutations:handleMinorTreeMutations,onHugeMutations:handleHugeTreeMutations}),attrObserver=new MutationObserver(handleAttributeMutations);attrObserver.observe(root,{attributeFilter:["rel","disabled","media","href"],subtree:!0}),observers.push(treeObserver,attrObserver),observedRoots.add(root)}}function subscribeForShadowRootChanges(node){var shadowRoot=node.shadowRoot;null==shadowRoot||observedRoots.has(shadowRoot)||(observe(shadowRoot),shadowRootDiscovered(shadowRoot))}function extendedIterateShadowHosts(node){iterateShadowHosts(node,subscribeForShadowRootChanges)}currentStyles.forEach(saveStylePosition),observe(document),extendedIterateShadowHosts(document.documentElement),watchWhenCustomElementsDefined((function(hosts){var newStyles=[];hosts.forEach((function(host){return push(newStyles,getManageableStyles(host.shadowRoot))})),update({created:newStyles,updated:[],removed:[],moved:[]}),hosts.forEach((function(host){var shadowRoot=host.shadowRoot;null!=shadowRoot&&(subscribeForShadowRootChanges(host),extendedIterateShadowHosts(shadowRoot),collectUndefinedElements(shadowRoot))}))})),document.addEventListener("__darkreader__isDefined",handleIsDefined,{passive:!0}),collectUndefinedElements(document)}function resetObservers(){observers.forEach((function(o){return o.disconnect()})),observers.splice(0,observers.length),observedRoots=new WeakSet}function stopWatchingForStyleChanges(){resetObservers(),unsubscribeFromDefineCustomElements()}var overrides=new WeakSet;function hasAdoptedStyleSheets(node){return Array.isArray(node.adoptedStyleSheets)&&node.adoptedStyleSheets.length>0}function createAdoptedStyleSheetOverride(node){var cancelAsyncOperations=!1;function iterateSourceSheets(iterator){node.adoptedStyleSheets.forEach((function(sheet){overrides.has(sheet)||iterator(sheet)}))}function injectSheet(sheet,override){var newSheets=__spreadArray([],__read(node.adoptedStyleSheets),!1),sheetIndex=newSheets.indexOf(sheet),overrideIndex=newSheets.indexOf(override);overrideIndex>=0&&newSheets.splice(overrideIndex,1),newSheets.splice(sheetIndex+1,0,override),node.adoptedStyleSheets=newSheets}function clear(){for(var newSheets=__spreadArray([],__read(node.adoptedStyleSheets),!1),i=newSheets.length-1;i>=0;i--){var sheet=newSheets[i];overrides.has(sheet)&&(newSheets.splice(i,1),overrides.delete(sheet))}node.adoptedStyleSheets.length!==newSheets.length&&(node.adoptedStyleSheets=newSheets)}function destroy(){cancelAsyncOperations=!0,clear(),frameId&&(cancelAnimationFrame(frameId),frameId=null)}var rulesChangeKey=0;function getRulesChangeKey(){var count=0;if(iterateSourceSheets((function(sheet){count+=sheet.cssRules.length})),1===count){var rule=node.adoptedStyleSheets[0].cssRules[0];return rule instanceof CSSStyleRule?rule.style.length:count}return count}function render(theme,ignoreImageAnalysis){clear();for(var _loop_1=function(i){var sheet=node.adoptedStyleSheets[i];if(overrides.has(sheet))return"continue";var rules=sheet.cssRules,override=new CSSStyleSheet,prepareSheet=function(){for(var i_1=override.cssRules.length-1;i_1>=0;i_1--)override.deleteRule(i_1);return injectSheet(sheet,override),overrides.add(override),override};createStyleSheetModifier().modifySheet({prepareSheet,sourceCSSRules:rules,theme,ignoreImageAnalysis,force:!1,isAsyncCancelled:function(){return cancelAsyncOperations}})},i=node.adoptedStyleSheets.length-1;i>=0;i--)_loop_1(i);rulesChangeKey=getRulesChangeKey()}function checkForUpdates(){return getRulesChangeKey()!==rulesChangeKey}var frameId=null;function watch(callback){frameId=requestAnimationFrame((function(){if(checkForUpdates()){var sheets=node.adoptedStyleSheets.filter((function(s){return!overrides.has(s)}));callback(sheets)}watch(callback)}))}return{render,destroy,watch}}var StyleSheetCommandBuilder=function(){function StyleSheetCommandBuilder(onChange){this.cssRules=[],this.commands=[],this.onChange=onChange}return StyleSheetCommandBuilder.prototype.insertRule=function(cssText,index){return void 0===index&&(index=0),this.commands.push({type:"insert",index,cssText}),this.cssRules.splice(index,0,new StyleSheetCommandBuilder(this.onChange)),this.onChange(),index},StyleSheetCommandBuilder.prototype.deleteRule=function(index){this.commands.push({type:"delete",index}),this.cssRules.splice(index,1),this.onChange()},StyleSheetCommandBuilder.prototype.replaceSync=function(cssText){if(this.commands.splice(0),this.commands.push({type:"replace",cssText}),""!==cssText)throw new Error("StyleSheetCommandBuilder.replaceSync() is not fully supported");this.cssRules.splice(0),this.onChange()},StyleSheetCommandBuilder.prototype.getDeepCSSCommands=function(){var deep=[];return this.commands.forEach((function(command){deep.push({type:command.type,cssText:"delete"!==command.type?command.cssText:"",path:"replace"===command.type?[]:[command.index]})})),this.cssRules.forEach((function(rule,i){rule.getDeepCSSCommands().forEach((function(c){return c.path.unshift(i)}))})),deep},StyleSheetCommandBuilder.prototype.clearDeepCSSCommands=function(){this.commands.splice(0),this.cssRules.forEach((function(rule){return rule.clearDeepCSSCommands()}))},StyleSheetCommandBuilder}();function createAdoptedStyleSheetFallback(onChange){var lastTheme,lastIgnoreImageAnalysis,cancelAsyncOperations=!1,sourceCSSRules=[];function updateCSS(cssRules){sourceCSSRules=cssRules,lastTheme&&lastIgnoreImageAnalysis&&render(lastTheme,lastIgnoreImageAnalysis)}var builder=new StyleSheetCommandBuilder(onChange);function render(theme,ignoreImageAnalysis){lastTheme=theme,lastIgnoreImageAnalysis=ignoreImageAnalysis;var prepareSheet=function(){return builder.replaceSync(""),builder};createStyleSheetModifier().modifySheet({prepareSheet,sourceCSSRules,theme,ignoreImageAnalysis,force:!1,isAsyncCancelled:function(){return cancelAsyncOperations}})}function commands(){var commands=builder.getDeepCSSCommands();return builder.clearDeepCSSCommands(),commands}function destroy(){cancelAsyncOperations=!0}return{render,destroy,updateCSS,commands}}function injectProxy(enableStyleSheetsProxy,enableCustomElementRegistryProxy){document.dispatchEvent(new CustomEvent("__darkreader__inlineScriptsAllowed"));var addRuleDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"addRule"),insertRuleDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"insertRule"),deleteRuleDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"deleteRule"),removeRuleDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"removeRule"),replaceDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"replace"),replaceSyncDescriptor=Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype,"replaceSync"),documentStyleSheetsDescriptor=enableStyleSheetsProxy?Object.getOwnPropertyDescriptor(Document.prototype,"styleSheets"):null,customElementRegistryDefineDescriptor=enableCustomElementRegistryProxy?Object.getOwnPropertyDescriptor(CustomElementRegistry.prototype,"define"):null,shouldWrapHTMLElement=["baidu.com","baike.baidu.com","ditu.baidu.com","map.baidu.com","maps.baidu.com","haokan.baidu.com","pan.baidu.com","passport.baidu.com","tieba.baidu.com","www.baidu.com"].includes(location.hostname),getElementsByTagNameDescriptor=shouldWrapHTMLElement?Object.getOwnPropertyDescriptor(Element.prototype,"getElementsByTagName"):null,shouldProxyChildNodes="www.vy.no"===location.hostname,childNodesDescriptor=shouldProxyChildNodes?Object.getOwnPropertyDescriptor(Node.prototype,"childNodes"):null,cleaners=[],cleanUp=function(){Object.defineProperty(CSSStyleSheet.prototype,"addRule",addRuleDescriptor),Object.defineProperty(CSSStyleSheet.prototype,"insertRule",insertRuleDescriptor),Object.defineProperty(CSSStyleSheet.prototype,"deleteRule",deleteRuleDescriptor),Object.defineProperty(CSSStyleSheet.prototype,"removeRule",removeRuleDescriptor),Object.defineProperty(CSSStyleSheet.prototype,"replace",replaceDescriptor),Object.defineProperty(CSSStyleSheet.prototype,"replaceSync",replaceSyncDescriptor),document.removeEventListener("__darkreader__cleanUp",cleanUp),document.removeEventListener("__darkreader__addUndefinedResolver",addUndefinedResolver),document.removeEventListener("__darkreader__blobURLCheckRequest",checkBlobURLSupport),enableStyleSheetsProxy&&Object.defineProperty(Document.prototype,"styleSheets",documentStyleSheetsDescriptor),enableCustomElementRegistryProxy&&Object.defineProperty(CustomElementRegistry.prototype,"define",customElementRegistryDefineDescriptor),shouldWrapHTMLElement&&Object.defineProperty(Element.prototype,"getElementsByTagName",getElementsByTagNameDescriptor),shouldProxyChildNodes&&Object.defineProperty(Node.prototype,"childNodes",childNodesDescriptor),cleaners.forEach((function(clean){return clean()})),cleaners.splice(0)},addUndefinedResolverInner=function(tag){customElements.whenDefined(tag).then((function(){document.dispatchEvent(new CustomEvent("__darkreader__isDefined",{detail:{tag}}))}))},addUndefinedResolver=function(e){return addUndefinedResolverInner(e.detail.tag)};document.addEventListener("__darkreader__cleanUp",cleanUp,{passive:!0}),document.addEventListener("__darkreader__addUndefinedResolver",addUndefinedResolver,{passive:!0}),document.addEventListener("__darkreader__blobURLCheckRequest",checkBlobURLSupport,{once:!0});var updateSheetEvent=new Event("__darkreader__updateSheet");function proxyAddRule(selector,style,index){return addRuleDescriptor.value.call(this,selector,style,index),!this.ownerNode||this.ownerNode.classList&&this.ownerNode.classList.contains("darkreader")||this.ownerNode.dispatchEvent(updateSheetEvent),-1}function proxyInsertRule(rule,index){var returnValue=insertRuleDescriptor.value.call(this,rule,index);return!this.ownerNode||this.ownerNode.classList&&this.ownerNode.classList.contains("darkreader")||this.ownerNode.dispatchEvent(updateSheetEvent),returnValue}function proxyDeleteRule(index){deleteRuleDescriptor.value.call(this,index),!this.ownerNode||this.ownerNode.classList&&this.ownerNode.classList.contains("darkreader")||this.ownerNode.dispatchEvent(updateSheetEvent)}function proxyRemoveRule(index){removeRuleDescriptor.value.call(this,index),!this.ownerNode||this.ownerNode.classList&&this.ownerNode.classList.contains("darkreader")||this.ownerNode.dispatchEvent(updateSheetEvent)}function proxyReplace(cssText){var _this=this,returnValue=replaceDescriptor.value.call(this,cssText);return this.ownerNode&&(!this.ownerNode.classList||!this.ownerNode.classList.contains("darkreader"))&&returnValue&&returnValue instanceof Promise&&returnValue.then((function(){return _this.ownerNode.dispatchEvent(updateSheetEvent)})),returnValue}function proxyReplaceSync(cssText){replaceSyncDescriptor.value.call(this,cssText),!this.ownerNode||this.ownerNode.classList&&this.ownerNode.classList.contains("darkreader")||this.ownerNode.dispatchEvent(updateSheetEvent)}function proxyDocumentStyleSheets(){var _this=this,getCurrentValue=function(){var filteredSheets=__spreadArray([],__read(documentStyleSheetsDescriptor.get.call(_this)),!1).filter((function(styleSheet){return styleSheet.ownerNode&&!(styleSheet.ownerNode.classList&&styleSheet.ownerNode.classList.contains("darkreader"))}));return filteredSheets.item=function(item){return filteredSheets[item]},Object.setPrototypeOf(filteredSheets,StyleSheetList.prototype)},elements=getCurrentValue();return elements=new Proxy(elements,{get:function(_,property){return getCurrentValue()[property]}})}function proxyCustomElementRegistryDefine(name,constructor,options){addUndefinedResolverInner(name),customElementRegistryDefineDescriptor.value.call(this,name,constructor,options)}function proxyGetElementsByTagName(tagName){var _this=this;if("style"!==tagName)return getElementsByTagNameDescriptor.value.call(this,tagName);var getCurrentElementValue=function(){var elements=getElementsByTagNameDescriptor.value.call(_this,tagName);return Object.setPrototypeOf(__spreadArray([],__read(elements),!1).filter((function(element){return element&&!(element.classList&&element.classList.contains("darkreader"))})),NodeList.prototype)},elements=getCurrentElementValue();return elements=new Proxy(elements,{get:function(_,property){return getCurrentElementValue()[Number(property)||property]}})}function proxyChildNodes(){var childNodes=childNodesDescriptor.get.call(this);return Object.setPrototypeOf(__spreadArray([],__read(childNodes),!1).filter((function(element){return!element.classList||!element.classList.contains("darkreader")})),NodeList.prototype)}function checkBlobURLSupport(){return __awaiter(this,void 0,void 0,(function(){var svg,bytes,i,blob,objectURL,blobURLAllowed,image_1;return __generator(this,(function(_a){switch(_a.label){case 0:for(svg='<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><rect width="1" height="1" fill="transparent"/></svg>',bytes=new Uint8Array(svg.length),i=0;i<svg.length;i++)bytes[i]=svg.charCodeAt(i);blob=new Blob([bytes],{type:"image/svg+xml"}),objectURL=URL.createObjectURL(blob),_a.label=1;case 1:return _a.trys.push([1,3,,4]),image_1=new Image,[4,new Promise((function(resolve,reject){image_1.onload=function(){return resolve()},image_1.onerror=function(){return reject()},image_1.src=objectURL}))];case 2:return _a.sent(),blobURLAllowed=!0,[3,4];case 3:return _a.sent(),blobURLAllowed=!1,[3,4];case 4:return document.dispatchEvent(new CustomEvent("__darkreader__blobURLCheckResponse",{detail:{blobURLAllowed}})),[2]}}))}))}Object.defineProperty(CSSStyleSheet.prototype,"addRule",__assign(__assign({},addRuleDescriptor),{value:proxyAddRule})),Object.defineProperty(CSSStyleSheet.prototype,"insertRule",__assign(__assign({},insertRuleDescriptor),{value:proxyInsertRule})),Object.defineProperty(CSSStyleSheet.prototype,"deleteRule",__assign(__assign({},deleteRuleDescriptor),{value:proxyDeleteRule})),Object.defineProperty(CSSStyleSheet.prototype,"removeRule",__assign(__assign({},removeRuleDescriptor),{value:proxyRemoveRule})),Object.defineProperty(CSSStyleSheet.prototype,"replace",__assign(__assign({},replaceDescriptor),{value:proxyReplace})),Object.defineProperty(CSSStyleSheet.prototype,"replaceSync",__assign(__assign({},replaceSyncDescriptor),{value:proxyReplaceSync})),enableStyleSheetsProxy&&Object.defineProperty(Document.prototype,"styleSheets",__assign(__assign({},documentStyleSheetsDescriptor),{get:proxyDocumentStyleSheets})),enableCustomElementRegistryProxy&&Object.defineProperty(CustomElementRegistry.prototype,"define",__assign(__assign({},customElementRegistryDefineDescriptor),{value:proxyCustomElementRegistryDefine})),shouldWrapHTMLElement&&Object.defineProperty(Element.prototype,"getElementsByTagName",__assign(__assign({},getElementsByTagNameDescriptor),{value:proxyGetElementsByTagName})),shouldProxyChildNodes&&Object.defineProperty(Node.prototype,"childNodes",__assign(__assign({},childNodesDescriptor),{get:proxyChildNodes}))}var documentVisibilityListener=null,documentIsVisible_=!document.hidden,listenerOptions={capture:!0,passive:!0};function watchForDocumentVisibility(){document.addEventListener("visibilitychange",documentVisibilityListener,listenerOptions),window.addEventListener("pageshow",documentVisibilityListener,listenerOptions),window.addEventListener("focus",documentVisibilityListener,listenerOptions)}function stopWatchingForDocumentVisibility(){document.removeEventListener("visibilitychange",documentVisibilityListener,listenerOptions),window.removeEventListener("pageshow",documentVisibilityListener,listenerOptions),window.removeEventListener("focus",documentVisibilityListener,listenerOptions)}function setDocumentVisibilityListener(callback){var alreadyWatching=Boolean(documentVisibilityListener);documentVisibilityListener=function(){document.hidden||(removeDocumentVisibilityListener(),callback(),documentIsVisible_=!0)},alreadyWatching||watchForDocumentVisibility()}function removeDocumentVisibilityListener(){stopWatchingForDocumentVisibility(),documentVisibilityListener=null}function documentIsVisible(){return documentIsVisible_}var INSTANCE_ID=generateUID(),styleManagers=new Map,adoptedStyleManagers=[],adoptedStyleFallbacks=new Map,adoptedStyleNodeIds=new WeakMap,adoptedStyleChangeTokens=new WeakMap,filter=null,fixes=null,isIFrame$1=null,ignoredImageAnalysisSelectors=[],ignoredInlineSelectors=[];function createOrUpdateStyle(className,root){void 0===root&&(root=document.head||document);var element=root.querySelector(".".concat(className));return element||((element=document.createElement("style")).classList.add("darkreader"),element.classList.add(className),element.media="screen",element.textContent=""),element}function createOrUpdateScript(className,root){void 0===root&&(root=document.head||document);var element=root.querySelector(".".concat(className));return element||((element=document.createElement("script")).classList.add("darkreader"),element.classList.add(className)),element}var nodePositionWatchers=new Map;function setupNodePositionWatcher(node,alias){nodePositionWatchers.has(alias)&&nodePositionWatchers.get(alias).stop(),nodePositionWatchers.set(alias,watchForNodePosition(node,"head"))}function stopStylePositionWatchers(){forEach(nodePositionWatchers.values(),(function(watcher){return watcher.stop()})),nodePositionWatchers.clear()}function createStaticStyleOverrides(){var fallbackStyle=createOrUpdateStyle("darkreader--fallback",document);fallbackStyle.textContent=getModifiedFallbackStyle(filter,{strict:!0}),document.head.insertBefore(fallbackStyle,document.head.firstChild),setupNodePositionWatcher(fallbackStyle,"fallback");var userAgentStyle=createOrUpdateStyle("darkreader--user-agent");userAgentStyle.textContent=getModifiedUserAgentStyle(filter,isIFrame$1,filter.styleSystemControls),document.head.insertBefore(userAgentStyle,fallbackStyle.nextSibling),setupNodePositionWatcher(userAgentStyle,"user-agent");var textStyle=createOrUpdateStyle("darkreader--text");filter.useFont||filter.textStroke>0?textStyle.textContent=createTextStyle(filter):textStyle.textContent="",document.head.insertBefore(textStyle,fallbackStyle.nextSibling),setupNodePositionWatcher(textStyle,"text");var invertStyle=createOrUpdateStyle("darkreader--invert");fixes&&Array.isArray(fixes.invert)&&fixes.invert.length>0?invertStyle.textContent=["".concat(fixes.invert.join(", ")," {"),"    filter: ".concat(getCSSFilterValue(__assign(__assign({},filter),{contrast:0===filter.mode?filter.contrast:clamp(filter.contrast-10,0,100)}))," !important;"),"}"].join("\n"):invertStyle.textContent="",document.head.insertBefore(invertStyle,textStyle.nextSibling),setupNodePositionWatcher(invertStyle,"invert");var inlineStyle=createOrUpdateStyle("darkreader--inline");inlineStyle.textContent=getInlineOverrideStyle(),document.head.insertBefore(inlineStyle,invertStyle.nextSibling),setupNodePositionWatcher(inlineStyle,"inline");var overrideStyle=createOrUpdateStyle("darkreader--override");overrideStyle.textContent=fixes&&fixes.css?replaceCSSTemplates(fixes.css):"",document.head.appendChild(overrideStyle),setupNodePositionWatcher(overrideStyle,"override");var variableStyle=createOrUpdateStyle("darkreader--variables"),selectionColors=getSelectionColor(filter),_a=filter,darkSchemeBackgroundColor=_a.darkSchemeBackgroundColor,darkSchemeTextColor=_a.darkSchemeTextColor,lightSchemeBackgroundColor=_a.lightSchemeBackgroundColor,lightSchemeTextColor=_a.lightSchemeTextColor,mode=_a.mode,schemeBackgroundColor=0===mode?lightSchemeBackgroundColor:darkSchemeBackgroundColor,schemeTextColor=0===mode?lightSchemeTextColor:darkSchemeTextColor;schemeBackgroundColor=modifyBackgroundColor(parseColorWithCache(schemeBackgroundColor),filter),schemeTextColor=modifyForegroundColor(parseColorWithCache(schemeTextColor),filter),variableStyle.textContent=[":root {","   --darkreader-neutral-background: ".concat(schemeBackgroundColor,";"),"   --darkreader-neutral-text: ".concat(schemeTextColor,";"),"   --darkreader-selection-background: ".concat(selectionColors.backgroundColorSelection,";"),"   --darkreader-selection-text: ".concat(selectionColors.foregroundColorSelection,";"),"}"].join("\n"),document.head.insertBefore(variableStyle,inlineStyle.nextSibling),setupNodePositionWatcher(variableStyle,"variables");var rootVarsStyle=createOrUpdateStyle("darkreader--root-vars");document.head.insertBefore(rootVarsStyle,variableStyle.nextSibling);var enableStyleSheetsProxy=!(fixes&&fixes.disableStyleSheetsProxy),enableCustomElementRegistryProxy=!(fixes&&fixes.disableCustomElementRegistryProxy),proxyScript=createOrUpdateScript("darkreader--proxy");proxyScript.append("(".concat(injectProxy,")(").concat(enableStyleSheetsProxy,", ").concat(enableCustomElementRegistryProxy,")")),document.head.insertBefore(proxyScript,rootVarsStyle.nextSibling),proxyScript.remove()}var shadowRootsWithOverrides=new Set;function createShadowStaticStyleOverridesInner(root){var inlineStyle=createOrUpdateStyle("darkreader--inline",root);inlineStyle.textContent=getInlineOverrideStyle(),root.insertBefore(inlineStyle,root.firstChild);var overrideStyle=createOrUpdateStyle("darkreader--override",root);overrideStyle.textContent=fixes&&fixes.css?replaceCSSTemplates(fixes.css):"",root.insertBefore(overrideStyle,inlineStyle.nextSibling);var invertStyle=createOrUpdateStyle("darkreader--invert",root);fixes&&Array.isArray(fixes.invert)&&fixes.invert.length>0?invertStyle.textContent=["".concat(fixes.invert.join(", ")," {"),"    filter: ".concat(getCSSFilterValue(__assign(__assign({},filter),{contrast:0===filter.mode?filter.contrast:clamp(filter.contrast-10,0,100)}))," !important;"),"}"].join("\n"):invertStyle.textContent="",root.insertBefore(invertStyle,overrideStyle.nextSibling),shadowRootsWithOverrides.add(root)}function delayedCreateShadowStaticStyleOverrides(root){new MutationObserver((function(mutations,observer){var e_1,_a,e_2,_b;observer.disconnect();try{for(var mutations_1=__values(mutations),mutations_1_1=mutations_1.next();!mutations_1_1.done;mutations_1_1=mutations_1.next()){var _c=mutations_1_1.value,type=_c.type,removedNodes=_c.removedNodes;if("childList"===type)try{for(var _d=(e_2=void 0,__values(removedNodes)),_e=_d.next();!_e.done;_e=_d.next()){var _f=_e.value,nodeName=_f.nodeName,className=_f.className;if("STYLE"===nodeName&&["darkreader darkreader--inline","darkreader darkreader--override","darkreader darkreader--invert"].includes(className))return void createShadowStaticStyleOverridesInner(root)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_e&&!_e.done&&(_b=_d.return)&&_b.call(_d)}finally{if(e_2)throw e_2.error}}}}catch(e_1_1){e_1={error:e_1_1}}finally{try{mutations_1_1&&!mutations_1_1.done&&(_a=mutations_1.return)&&_a.call(mutations_1)}finally{if(e_1)throw e_1.error}}})).observe(root,{childList:!0})}function createShadowStaticStyleOverrides(root){var uninit=null===root.firstChild;createShadowStaticStyleOverridesInner(root),uninit&&delayedCreateShadowStaticStyleOverrides(root)}function replaceCSSTemplates($cssText){return $cssText.replace(/\${(.+?)}/g,(function(_,$color){var color=parseColorWithCache($color);return color?modifyColor(color,filter):$color}))}function cleanFallbackStyle(){var fallback=document.querySelector(".darkreader--fallback");fallback&&(fallback.textContent="")}function createDynamicStyleOverrides(){cancelRendering();var newManagers=getManageableStyles(document).filter((function(style){return!styleManagers.has(style)})).map((function(style){return createManager(style)}));newManagers.map((function(manager){return manager.details({secondRound:!1})})).filter((function(detail){return detail&&detail.rules.length>0})).forEach((function(detail){variablesStore.addRulesForMatching(detail.rules)})),variablesStore.matchVariablesAndDependents(),variablesStore.setOnRootVariableChange((function(){var rootVarsStyle=createOrUpdateStyle("darkreader--root-vars");variablesStore.putRootVars(rootVarsStyle,filter)}));var rootVarsStyle=createOrUpdateStyle("darkreader--root-vars");variablesStore.putRootVars(rootVarsStyle,filter),styleManagers.forEach((function(manager){return manager.render(filter,ignoredImageAnalysisSelectors)})),0===loadingStyles.size&&cleanFallbackStyle(),newManagers.forEach((function(manager){return manager.watch()}));var inlineStyleElements=toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));if(iterateShadowHosts(document.documentElement,(function(host){createShadowStaticStyleOverrides(host.shadowRoot);var elements=host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);elements.length>0&&push(inlineStyleElements,elements)})),inlineStyleElements.forEach((function(el){return overrideInlineStyle(el,filter,ignoredInlineSelectors,ignoredImageAnalysisSelectors)})),handleAdoptedStyleSheets(document),variablesStore.matchVariablesAndDependents(),isFirefox){var MATCH_VAR_1=Symbol(),onAdoptedCSSChange_1=function(e){var _a=e.detail,node=_a.node,id=_a.id,cssRules=_a.cssRules,entries=_a.entries;Array.isArray(entries)?(entries.forEach((function(e){var cssRules=e[2];variablesStore.addRulesForMatching(cssRules)})),variablesStore.matchVariablesAndDependents()):cssRules&&(variablesStore.addRulesForMatching(cssRules),requestAnimationFrameOnce(MATCH_VAR_1,(function(){return variablesStore.matchVariablesAndDependents()}))),(Array.isArray(entries)?entries:node&&cssRules?[[node,id,cssRules]]:[]).forEach((function(_a){var _b=__read(_a,3),node=_b[0],id=_b[1],cssRules=_b[2];adoptedStyleNodeIds.set(node,id),getAdoptedStyleSheetFallback(node).updateCSS(cssRules)}))};document.addEventListener("__darkreader__adoptedStyleSheetsChange",onAdoptedCSSChange_1),cleaners.push((function(){return document.removeEventListener("__darkreader__adoptedStyleSheetsChange",onAdoptedCSSChange_1)})),document.dispatchEvent(new CustomEvent("__darkreader__startAdoptedStyleSheetsWatcher"))}}var loadingStylesCounter=0,loadingStyles=new Set;function createManager(element){var loadingStyleId=++loadingStylesCounter;function loadingStart(){if(!isDOMReady()||!documentIsVisible()){loadingStyles.add(loadingStyleId),logInfo("Current amount of styles loading: ".concat(loadingStyles.size));var fallbackStyle=document.querySelector(".darkreader--fallback");fallbackStyle.textContent||(fallbackStyle.textContent=getModifiedFallbackStyle(filter,{strict:!1}))}}function loadingEnd(){loadingStyles.delete(loadingStyleId),logInfo("Removed loadingStyle ".concat(loadingStyleId,", now awaiting: ").concat(loadingStyles.size)),0===loadingStyles.size&&isDOMReady()&&cleanFallbackStyle()}function update(){var details=manager.details({secondRound:!0});details&&(variablesStore.addRulesForMatching(details.rules),variablesStore.matchVariablesAndDependents(),manager.render(filter,ignoredImageAnalysisSelectors))}var manager=manageStyle(element,{update,loadingStart,loadingEnd});return styleManagers.set(element,manager),manager}function removeManager(element){var manager=styleManagers.get(element);manager&&(manager.destroy(),styleManagers.delete(element))}var throttledRenderAllStyles=throttle((function(callback){styleManagers.forEach((function(manager){return manager.render(filter,ignoredImageAnalysisSelectors)})),adoptedStyleManagers.forEach((function(manager){return manager.render(filter,ignoredImageAnalysisSelectors)})),callback&&callback()})),cancelRendering=function(){throttledRenderAllStyles.cancel()};function onDOMReady(){0!==loadingStyles.size||cleanFallbackStyle()}function runDynamicStyle(){createDynamicStyleOverrides(),watchForUpdates()}function createThemeAndWatchForUpdates(){createStaticStyleOverrides(),documentIsVisible()||filter.immediateModify?runDynamicStyle():setDocumentVisibilityListener(runDynamicStyle),changeMetaThemeColorWhenAvailable(filter)}var pendingAdoptedVarMatch=!1;function handleAdoptedStyleSheets(node){var theme=filter;if(isFirefox)getAdoptedStyleSheetFallback(node).render(theme,ignoredImageAnalysisSelectors);else if(hasAdoptedStyleSheets(node)){node.adoptedStyleSheets.forEach((function(s){variablesStore.addRulesForMatching(s.cssRules)}));var newManger_1=createAdoptedStyleSheetOverride(node);adoptedStyleManagers.push(newManger_1),newManger_1.render(theme,ignoredImageAnalysisSelectors),newManger_1.watch((function(sheets){sheets.forEach((function(s){variablesStore.addRulesForMatching(s.cssRules)})),newManger_1.render(theme,ignoredImageAnalysisSelectors),pendingAdoptedVarMatch=!0})),potentialAdoptedStyleNodes.delete(node)}else potentialAdoptedStyleNodes.has(node)||potentialAdoptedStyleNodes.add(node)}var metaObserver,potentialAdoptedStyleNodes=new Set,potentialAdoptedStyleFrameId=null;function watchPotentialAdoptedStyleNodes(){potentialAdoptedStyleFrameId=requestAnimationFrame((function(){var changed=!1;potentialAdoptedStyleNodes.forEach((function(node){node.isConnected?(handleAdoptedStyleSheets(node),changed=!0):potentialAdoptedStyleNodes.delete(node)})),(changed||pendingAdoptedVarMatch)&&(variablesStore.matchVariablesAndDependents(),pendingAdoptedVarMatch=!1),watchPotentialAdoptedStyleNodes()}))}function stopWatchingPotentialAdoptedStyleNodes(){potentialAdoptedStyleFrameId&&cancelAnimationFrame(potentialAdoptedStyleFrameId),potentialAdoptedStyleNodes.clear(),isFirefox&&document.dispatchEvent(new CustomEvent("__darkreader__stopAdoptedStyleSheetsWatcher"))}function getAdoptedStyleChangeToken(node){if(adoptedStyleChangeTokens.has(node))return adoptedStyleChangeTokens.get(node);var token=Symbol();return adoptedStyleChangeTokens.set(node,token),token}function getAdoptedStyleSheetFallback(node){var fallback=adoptedStyleFallbacks.get(node);return fallback||(fallback=createAdoptedStyleSheetFallback((function(){requestAnimationFrameOnce(getAdoptedStyleChangeToken(node),(function(){var id=adoptedStyleNodeIds.get(node),commands=null==fallback?void 0:fallback.commands();if(id&&commands){var data={id,commands};document.dispatchEvent(new CustomEvent("__darkreader__adoptedStyleSheetCommands",{detail:JSON.stringify(data)}))}}))})),adoptedStyleFallbacks.set(node,fallback)),fallback}function watchForUpdates(){watchForStyleChanges(Array.from(styleManagers.keys()),(function(_a){var created=_a.created,updated=_a.updated,removed=_a.removed,moved=_a.moved,stylesToRemove=removed,stylesToManage=created.concat(updated).concat(moved).filter((function(style){return!styleManagers.has(style)})),stylesToRestore=moved.filter((function(style){return styleManagers.has(style)}));stylesToRemove.forEach((function(style){return removeManager(style)}));var newManagers=stylesToManage.map((function(style){return createManager(style)}));newManagers.map((function(manager){return manager.details({secondRound:!1})})).filter((function(detail){return detail&&detail.rules.length>0})).forEach((function(detail){variablesStore.addRulesForMatching(detail.rules)})),variablesStore.matchVariablesAndDependents(),newManagers.forEach((function(manager){return manager.render(filter,ignoredImageAnalysisSelectors)})),newManagers.forEach((function(manager){return manager.watch()})),stylesToRestore.forEach((function(style){return styleManagers.get(style).restore()}))}),(function(shadowRoot){createShadowStaticStyleOverrides(shadowRoot),handleAdoptedStyleSheets(shadowRoot)})),watchPotentialAdoptedStyleNodes(),watchForInlineStyles((function(element){if(overrideInlineStyle(element,filter,ignoredInlineSelectors,ignoredImageAnalysisSelectors),element===document.documentElement&&(element.getAttribute("style")||"").includes("--")){variablesStore.matchVariablesAndDependents();var rootVarsStyle=createOrUpdateStyle("darkreader--root-vars");variablesStore.putRootVars(rootVarsStyle,filter)}}),(function(root){createShadowStaticStyleOverrides(root);var inlineStyleElements=root.querySelectorAll(INLINE_STYLE_SELECTOR);inlineStyleElements.length>0&&forEach(inlineStyleElements,(function(el){return overrideInlineStyle(el,filter,ignoredInlineSelectors,ignoredImageAnalysisSelectors)}))})),addDOMReadyListener(onDOMReady)}function stopWatchingForUpdates(){styleManagers.forEach((function(manager){return manager.pause()})),stopStylePositionWatchers(),stopWatchingForStyleChanges(),stopWatchingForInlineStyles(),removeDOMReadyListener(onDOMReady),cleanReadyStateCompleteListeners()}function addMetaListener(){(metaObserver=new MutationObserver((function(){document.querySelector('meta[name="darkreader-lock"]')&&(metaObserver.disconnect(),removeDynamicTheme())}))).observe(document.head,{childList:!0,subtree:!0})}function createDarkReaderInstanceMarker(){var metaElement=document.createElement("meta");metaElement.name="darkreader",metaElement.content=INSTANCE_ID,document.head.appendChild(metaElement)}function isAnotherDarkReaderInstanceActive(){if(document.querySelector('meta[name="darkreader-lock"]'))return!0;var meta=document.querySelector('meta[name="darkreader"]');return meta?meta.content!==INSTANCE_ID:(createDarkReaderInstanceMarker(),addMetaListener(),!1)}function createOrUpdateDynamicThemeInternal(filterConfig,dynamicThemeFixes,iframe){if(filter=filterConfig,(fixes=dynamicThemeFixes)?(ignoredImageAnalysisSelectors=Array.isArray(fixes.ignoreImageAnalysis)?fixes.ignoreImageAnalysis:[],ignoredInlineSelectors=Array.isArray(fixes.ignoreInlineStyle)?fixes.ignoreInlineStyle:[]):(ignoredImageAnalysisSelectors=[],ignoredInlineSelectors=[]),filter.immediateModify&&setIsDOMReady((function(){return!0})),isIFrame$1=iframe,document.head){if(isAnotherDarkReaderInstanceActive())return void removeDynamicTheme();document.documentElement.setAttribute("data-darkreader-mode","dynamic"),document.documentElement.setAttribute("data-darkreader-scheme",filter.mode?"dark":"dimmed"),createThemeAndWatchForUpdates()}else{if(!isFirefox){var fallbackStyle=createOrUpdateStyle("darkreader--fallback");document.documentElement.appendChild(fallbackStyle),fallbackStyle.textContent=getModifiedFallbackStyle(filter,{strict:!0})}var headObserver_1=new MutationObserver((function(){if(document.head){if(headObserver_1.disconnect(),isAnotherDarkReaderInstanceActive())return void removeDynamicTheme();createThemeAndWatchForUpdates()}}));headObserver_1.observe(document,{childList:!0,subtree:!0})}}function removeProxy(){document.dispatchEvent(new CustomEvent("__darkreader__cleanUp")),removeNode(document.head.querySelector(".darkreader--proxy"))}var cleaners=[];function removeDynamicTheme(){document.documentElement.removeAttribute("data-darkreader-mode"),document.documentElement.removeAttribute("data-darkreader-scheme"),cleanDynamicThemeCache(),removeNode(document.querySelector(".darkreader--fallback")),document.head&&(restoreMetaThemeColor(),removeNode(document.head.querySelector(".darkreader--user-agent")),removeNode(document.head.querySelector(".darkreader--text")),removeNode(document.head.querySelector(".darkreader--invert")),removeNode(document.head.querySelector(".darkreader--inline")),removeNode(document.head.querySelector(".darkreader--override")),removeNode(document.head.querySelector(".darkreader--variables")),removeNode(document.head.querySelector(".darkreader--root-vars")),removeNode(document.head.querySelector('meta[name="darkreader"]')),removeProxy()),shadowRootsWithOverrides.forEach((function(root){removeNode(root.querySelector(".darkreader--inline")),removeNode(root.querySelector(".darkreader--override"))})),shadowRootsWithOverrides.clear(),forEach(styleManagers.keys(),(function(el){return removeManager(el)})),loadingStyles.clear(),cleanLoadingLinks(),forEach(document.querySelectorAll(".darkreader"),removeNode),adoptedStyleManagers.forEach((function(manager){return manager.destroy()})),adoptedStyleManagers.splice(0),adoptedStyleFallbacks.forEach((function(fallback){return fallback.destroy()})),adoptedStyleFallbacks.clear(),stopWatchingPotentialAdoptedStyleNodes(),metaObserver&&metaObserver.disconnect(),cleaners.forEach((function(clean){return clean()})),cleaners.splice(0)}function cleanDynamicThemeCache(){variablesStore.clear(),parsedURLCache.clear(),removeDocumentVisibilityListener(),cancelRendering(),stopWatchingForUpdates(),cleanModificationCache(),clearColorCache()}var blobRegex=/url\(\"(blob\:.*?)\"\)/g;function replaceBlobs(text){return __awaiter(this,void 0,void 0,(function(){var promises,data;return __generator(this,(function(_a){switch(_a.label){case 0:return promises=[],getMatches(blobRegex,text,1).forEach((function(url){var promise=loadAsDataURL(url);promises.push(promise)})),[4,Promise.all(promises)];case 1:return data=_a.sent(),[2,text.replace(blobRegex,(function(){return'url("'.concat(data.shift(),'")')}))]}}))}))}var banner='/*\n                        _______\n                       /       \\\n                      .==.    .==.\n                     ((  ))==((  ))\n                    / "=="    "=="\\\n                   /____|| || ||___\\\n       ________     ____    ________  ___    ___\n       |  ___  \\   /    \\   |  ___  \\ |  |  /  /\n       |  |  \\  \\ /  /\\  \\  |  |  \\  \\|  |_/  /\n       |  |   )  /  /__\\  \\ |  |__/  /|  ___  \\\n       |  |__/  /  ______  \\|  ____  \\|  |  \\  \\\n_______|_______/__/ ____ \\__\\__|___\\__\\__|___\\__\\____\n|  ___  \\ |  ____/ /    \\   |  ___  \\ |  ____|  ___  \\\n|  |  \\  \\|  |___ /  /\\  \\  |  |  \\  \\|  |___|  |  \\  \\\n|  |__/  /|  ____/  /__\\  \\ |  |   )  |  ____|  |__/  /\n|  ____  \\|  |__/  ______  \\|  |__/  /|  |___|  ____  \\\n|__|   \\__\\____/__/      \\__\\_______/ |______|__|   \\__\\\n                https://darkreader.org\n*/\n\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/main/LICENSE */\n';function collectCSS(){return __awaiter(this,void 0,void 0,(function(){function addStaticCSS(selector,comment){var staticStyle=document.querySelector(selector);staticStyle&&staticStyle.textContent&&(css.push("/* ".concat(comment," */")),css.push(staticStyle.textContent),css.push(""))}var css,modifiedCSS,formattedCSS,_a,_b;return __generator(this,(function(_c){switch(_c.label){case 0:return css=[banner],addStaticCSS(".darkreader--fallback","Fallback Style"),addStaticCSS(".darkreader--user-agent","User-Agent Style"),addStaticCSS(".darkreader--text","Text Style"),addStaticCSS(".darkreader--invert","Invert Style"),addStaticCSS(".darkreader--variables","Variables Style"),modifiedCSS=[],document.querySelectorAll(".darkreader--sync").forEach((function(element){forEach(element.sheet.cssRules,(function(rule){rule&&rule.cssText&&modifiedCSS.push(rule.cssText)}))})),modifiedCSS.length?(formattedCSS=formatCSS(modifiedCSS.join("\n")),css.push("/* Modified CSS */"),_b=(_a=css).push,[4,replaceBlobs(formattedCSS)]):[3,2];case 1:_b.apply(_a,[_c.sent()]),css.push(""),_c.label=2;case 2:return addStaticCSS(".darkreader--override","Override Style"),[2,css.join("\n")]}}))}))}var isDarkReaderEnabled=!1,isIFrame=function(){try{return window.self!==window.top}catch(err){return console.warn(err),!0}}();function enable(themeOptions,fixes){void 0===themeOptions&&(themeOptions={}),void 0===fixes&&(fixes=null);var theme=__assign(__assign({},DEFAULT_THEME),themeOptions);if(theme.engine!==ThemeEngine.dynamicTheme)throw new Error("Theme engine is not supported.");createOrUpdateDynamicThemeInternal(theme,fixes,isIFrame),isDarkReaderEnabled=!0}function isEnabled(){return isDarkReaderEnabled}function disable(){removeDynamicTheme(),isDarkReaderEnabled=!1}var darkScheme=matchMedia("(prefers-color-scheme: dark)"),store={themeOptions:null,fixes:null};function handleColorScheme(){darkScheme.matches?enable(store.themeOptions,store.fixes):disable()}function auto(themeOptions,fixes){void 0===themeOptions&&(themeOptions={}),void 0===fixes&&(fixes=null),themeOptions?(store={themeOptions,fixes},handleColorScheme(),isMatchMediaChangeEventListenerSupported?darkScheme.addEventListener("change",handleColorScheme):darkScheme.addListener(handleColorScheme)):(isMatchMediaChangeEventListenerSupported?darkScheme.removeEventListener("change",handleColorScheme):darkScheme.removeListener(handleColorScheme),disable())}function exportGeneratedCSS(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){switch(_a.label){case 0:return[4,collectCSS()];case 1:return[2,_a.sent()]}}))}))}var setFetchMethod=setFetchMethod$1;exports.auto=auto,exports.disable=disable,exports.enable=enable,exports.exportGeneratedCSS=exportGeneratedCSS,exports.isEnabled=isEnabled,exports.setFetchMethod=setFetchMethod,Object.defineProperty(exports,"__esModule",{value:!0})}(exports)},196:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ResolutionUnitSpecifier:()=>ResolutionUnitSpecifier,decode:()=>decodePng,encode:()=>encodePng});const external_util_namespaceObject=require("util");function decode(bytes,encoding="utf8"){return new external_util_namespaceObject.TextDecoder(encoding).decode(bytes)}const encoder=new external_util_namespaceObject.TextEncoder;const hostBigEndian=(()=>{const array=new Uint8Array(4);return!((new Uint32Array(array.buffer)[0]=1)&array[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{constructor(data=8192,options={}){let dataIsGiven=!1;"number"==typeof data?data=new ArrayBuffer(data):(dataIsGiven=!0,this.lastWrittenByte=data.byteLength);const offset=options.offset?options.offset>>>0:0,byteLength=data.byteLength-offset;let dvOffset=offset;(ArrayBuffer.isView(data)||data instanceof IOBuffer)&&(data.byteLength!==data.buffer.byteLength&&(dvOffset=data.byteOffset+offset),data=data.buffer),this.lastWrittenByte=dataIsGiven?byteLength:0,this.buffer=data,this.length=byteLength,this.byteLength=byteLength,this.byteOffset=dvOffset,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,dvOffset,byteLength),this._mark=0,this._marks=[]}available(byteLength=1){return this.offset+byteLength<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(n=1){return this.offset+=n,this}back(n=1){return this.offset-=n,this}seek(offset){return this.offset=offset,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const offset=this._marks.pop();if(void 0===offset)throw new Error("Mark stack empty");return this.seek(offset),this}rewind(){return this.offset=0,this}ensureAvailable(byteLength=1){if(!this.available(byteLength)){const newLength=2*(this.offset+byteLength),newArray=new Uint8Array(newLength);newArray.set(new Uint8Array(this.buffer)),this.buffer=newArray.buffer,this.length=this.byteLength=newLength,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(n=1){return this.readArray(n,"uint8")}readArray(size,type){const bytes=typedArrays[type].BYTES_PER_ELEMENT*size,offset=this.byteOffset+this.offset,slice=this.buffer.slice(offset,offset+bytes);if(this.littleEndian===hostBigEndian&&"uint8"!==type&&"int8"!==type){const slice=new Uint8Array(this.buffer.slice(offset,offset+bytes));slice.reverse();const returnArray=new typedArrays[type](slice.buffer);return this.offset+=bytes,returnArray.reverse(),returnArray}const returnArray=new typedArrays[type](slice);return this.offset+=bytes,returnArray}readInt16(){const value=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,value}readUint16(){const value=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,value}readInt32(){const value=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,value}readUint32(){const value=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat32(){const value=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,value}readFloat64(){const value=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,value}readBigInt64(){const value=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,value}readBigUint64(){const value=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,value}readChar(){return String.fromCharCode(this.readInt8())}readChars(n=1){let result="";for(let i=0;i<n;i++)result+=this.readChar();return result}readUtf8(n=1){return decode(this.readBytes(n))}decodeText(n=1,encoding="utf-8"){return decode(this.readBytes(n),encoding)}writeBoolean(value){return this.writeUint8(value?255:0),this}writeInt8(value){return this.ensureAvailable(1),this._data.setInt8(this.offset++,value),this._updateLastWrittenByte(),this}writeUint8(value){return this.ensureAvailable(1),this._data.setUint8(this.offset++,value),this._updateLastWrittenByte(),this}writeByte(value){return this.writeUint8(value)}writeBytes(bytes){this.ensureAvailable(bytes.length);for(let i=0;i<bytes.length;i++)this._data.setUint8(this.offset++,bytes[i]);return this._updateLastWrittenByte(),this}writeInt16(value){return this.ensureAvailable(2),this._data.setInt16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(value){return this.ensureAvailable(2),this._data.setUint16(this.offset,value,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(value){return this.ensureAvailable(4),this._data.setInt32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(value){return this.ensureAvailable(4),this._data.setUint32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(value){return this.ensureAvailable(4),this._data.setFloat32(this.offset,value,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(value){return this.ensureAvailable(8),this._data.setFloat64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(value){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(value){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,value,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(str){return this.writeUint8(str.charCodeAt(0))}writeChars(str){for(let i=0;i<str.length;i++)this.writeUint8(str.charCodeAt(i));return this}writeUtf8(str){return this.writeBytes(function(str){return encoder.encode(str)}(str))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function zero$1(buf){let len=buf.length;for(;--len>=0;)buf[len]=0}const extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),static_ltree=new Array(576);zero$1(static_ltree);const static_dtree=new Array(60);zero$1(static_dtree);const _dist_code=new Array(512);zero$1(_dist_code);const _length_code=new Array(256);zero$1(_length_code);const base_length=new Array(29);zero$1(base_length);const base_dist=new Array(30);function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}zero$1(base_dist);const d_code=dist=>dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)],put_short=(s,w)=>{s.pending_buf[s.pending++]=255&w,s.pending_buf[s.pending++]=w>>>8&255},send_bits=(s,value,length)=>{s.bi_valid>16-length?(s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>16-s.bi_valid,s.bi_valid+=length-16):(s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length)},send_code=(s,c,tree)=>{send_bits(s,tree[2*c],tree[2*c+1])},bi_reverse=(code,len)=>{let res=0;do{res|=1&code,code>>>=1,res<<=1}while(--len>0);return res>>>1},gen_codes=(tree,max_code,bl_count)=>{const next_code=new Array(16);let bits,n,code=0;for(bits=1;bits<=15;bits++)code=code+bl_count[bits-1]<<1,next_code[bits]=code;for(n=0;n<=max_code;n++){let len=tree[2*n+1];0!==len&&(tree[2*n]=bi_reverse(next_code[len]++,len))}},init_block=s=>{let n;for(n=0;n<286;n++)s.dyn_ltree[2*n]=0;for(n=0;n<30;n++)s.dyn_dtree[2*n]=0;for(n=0;n<19;n++)s.bl_tree[2*n]=0;s.dyn_ltree[512]=1,s.opt_len=s.static_len=0,s.sym_next=s.matches=0},bi_windup=s=>{s.bi_valid>8?put_short(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},smaller=(tree,n,m,depth)=>{const _n2=2*n,_m2=2*m;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]},pqdownheap=(s,tree,k)=>{const v=s.heap[k];let j=k<<1;for(;j<=s.heap_len&&(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)&&j++,!smaller(tree,v,s.heap[j],s.depth));)s.heap[k]=s.heap[j],k=j,j<<=1;s.heap[k]=v},compress_block=(s,ltree,dtree)=>{let dist,lc,code,extra,sx=0;if(0!==s.sym_next)do{dist=255&s.pending_buf[s.sym_buf+sx++],dist+=(255&s.pending_buf[s.sym_buf+sx++])<<8,lc=s.pending_buf[s.sym_buf+sx++],0===dist?send_code(s,lc,ltree):(code=_length_code[lc],send_code(s,code+256+1,ltree),extra=extra_lbits[code],0!==extra&&(lc-=base_length[code],send_bits(s,lc,extra)),dist--,code=d_code(dist),send_code(s,code,dtree),extra=extra_dbits[code],0!==extra&&(dist-=base_dist[code],send_bits(s,dist,extra)))}while(sx<s.sym_next);send_code(s,256,ltree)},build_tree=(s,desc)=>{const tree=desc.dyn_tree,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems;let n,m,node,max_code=-1;for(s.heap_len=0,s.heap_max=573,n=0;n<elems;n++)0!==tree[2*n]?(s.heap[++s.heap_len]=max_code=n,s.depth[n]=0):tree[2*n+1]=0;for(;s.heap_len<2;)node=s.heap[++s.heap_len]=max_code<2?++max_code:0,tree[2*node]=1,s.depth[node]=0,s.opt_len--,has_stree&&(s.static_len-=stree[2*node+1]);for(desc.max_code=max_code,n=s.heap_len>>1;n>=1;n--)pqdownheap(s,tree,n);node=elems;do{n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[2*node]=tree[2*n]+tree[2*m],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[2*n+1]=tree[2*m+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1)}while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],((s,desc)=>{const tree=desc.dyn_tree,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length;let h,n,m,bits,xbits,f,overflow=0;for(bits=0;bits<=15;bits++)s.bl_count[bits]=0;for(tree[2*s.heap[s.heap_max]+1]=0,h=s.heap_max+1;h<573;h++)n=s.heap[h],bits=tree[2*tree[2*n+1]+1]+1,bits>max_length&&(bits=max_length,overflow++),tree[2*n+1]=bits,n>max_code||(s.bl_count[bits]++,xbits=0,n>=base&&(xbits=extra[n-base]),f=tree[2*n],s.opt_len+=f*(bits+xbits),has_stree&&(s.static_len+=f*(stree[2*n+1]+xbits)));if(0!==overflow){do{for(bits=max_length-1;0===s.bl_count[bits];)bits--;s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,overflow-=2}while(overflow>0);for(bits=max_length;0!==bits;bits--)for(n=s.bl_count[bits];0!==n;)m=s.heap[--h],m>max_code||(tree[2*m+1]!==bits&&(s.opt_len+=(bits-tree[2*m+1])*tree[2*m],tree[2*m+1]=bits),n--)}})(s,desc),gen_codes(tree,max_code,s.bl_count)},scan_tree=(s,tree,max_code)=>{let n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),tree[2*(max_code+1)+1]=65535,n=0;n<=max_code;n++)curlen=nextlen,nextlen=tree[2*(n+1)+1],++count<max_count&&curlen===nextlen||(count<min_count?s.bl_tree[2*curlen]+=count:0!==curlen?(curlen!==prevlen&&s.bl_tree[2*curlen]++,s.bl_tree[32]++):count<=10?s.bl_tree[34]++:s.bl_tree[36]++,count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4))},send_tree=(s,tree,max_code)=>{let n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),n=0;n<=max_code;n++)if(curlen=nextlen,nextlen=tree[2*(n+1)+1],!(++count<max_count&&curlen===nextlen)){if(count<min_count)do{send_code(s,curlen,s.bl_tree)}while(0!=--count);else 0!==curlen?(curlen!==prevlen&&(send_code(s,curlen,s.bl_tree),count--),send_code(s,16,s.bl_tree),send_bits(s,count-3,2)):count<=10?(send_code(s,17,s.bl_tree),send_bits(s,count-3,3)):(send_code(s,18,s.bl_tree),send_bits(s,count-11,7));count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4)}};let static_init_done=!1;const _tr_stored_block$1=(s,buf,stored_len,last)=>{send_bits(s,0+(last?1:0),3),bi_windup(s),put_short(s,stored_len),put_short(s,~stored_len),stored_len&&s.pending_buf.set(s.window.subarray(buf,buf+stored_len),s.pending),s.pending+=stored_len};var _tr_flush_block_1=(s,buf,stored_len,last)=>{let opt_lenb,static_lenb,max_blindex=0;s.level>0?(2===s.strm.data_type&&(s.strm.data_type=(s=>{let n,block_mask=4093624447;for(n=0;n<=31;n++,block_mask>>>=1)if(1&block_mask&&0!==s.dyn_ltree[2*n])return 0;if(0!==s.dyn_ltree[18]||0!==s.dyn_ltree[20]||0!==s.dyn_ltree[26])return 1;for(n=32;n<256;n++)if(0!==s.dyn_ltree[2*n])return 1;return 0})(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=(s=>{let max_blindex;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),max_blindex=18;max_blindex>=3&&0===s.bl_tree[2*bl_order[max_blindex]+1];max_blindex--);return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex})(s),opt_lenb=s.opt_len+3+7>>>3,static_lenb=s.static_len+3+7>>>3,static_lenb<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&-1!==buf?_tr_stored_block$1(s,buf,stored_len,last):4===s.strategy||static_lenb===opt_lenb?(send_bits(s,2+(last?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,4+(last?1:0),3),((s,lcodes,dcodes,blcodes)=>{let rank;for(send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4),rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[2*bl_order[rank]+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)})(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),last&&bi_windup(s)},trees={_tr_init:s=>{static_init_done||((()=>{let n,bits,length,code,dist;const bl_count=new Array(16);for(length=0,code=0;code<28;code++)for(base_length[code]=length,n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code;for(_length_code[length-1]=code,dist=0,code=0;code<16;code++)for(base_dist[code]=dist,n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code;for(dist>>=7;code<30;code++)for(base_dist[code]=dist<<7,n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code;for(bits=0;bits<=15;bits++)bl_count[bits]=0;for(n=0;n<=143;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(;n<=255;)static_ltree[2*n+1]=9,n++,bl_count[9]++;for(;n<=279;)static_ltree[2*n+1]=7,n++,bl_count[7]++;for(;n<=287;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(gen_codes(static_ltree,287,bl_count),n=0;n<30;n++)static_dtree[2*n+1]=5,static_dtree[2*n]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,257,286,15),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,30,15),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,19,7)})(),static_init_done=!0),s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},_tr_stored_block:_tr_stored_block$1,_tr_flush_block:_tr_flush_block_1,_tr_tally:(s,dist,lc)=>(s.pending_buf[s.sym_buf+s.sym_next++]=dist,s.pending_buf[s.sym_buf+s.sym_next++]=dist>>8,s.pending_buf[s.sym_buf+s.sym_next++]=lc,0===dist?s.dyn_ltree[2*lc]++:(s.matches++,dist--,s.dyn_ltree[2*(_length_code[lc]+256+1)]++,s.dyn_dtree[2*d_code(dist)]++),s.sym_next===s.sym_end),_tr_align:s=>{send_bits(s,2,3),send_code(s,256,static_ltree),(s=>{16===s.bi_valid?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=255&s.bi_buf,s.bi_buf>>=8,s.bi_valid-=8)})(s)}};var adler32_1=(adler,buf,len,pos)=>{let s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;for(;0!==len;){n=len>2e3?2e3:len,len-=n;do{s1=s1+buf[pos++]|0,s2=s2+s1|0}while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0};const crcTable=new Uint32Array((()=>{let c,table=[];for(var n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table})());var crc32_1=(crc,buf,len,pos)=>{const t=crcTable,end=pos+len;crc^=-1;for(let i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc},messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,err=(strm,errorCode)=>(strm.msg=messages[errorCode],errorCode),rank=f=>2*f-(f>4?9:0),zero=buf=>{let len=buf.length;for(;--len>=0;)buf[len]=0},slide_hash=s=>{let n,m,p,wsize=s.w_size;n=s.hash_size,p=n;do{m=s.head[--p],s.head[p]=m>=wsize?m-wsize:0}while(--n);n=wsize,p=n;do{m=s.prev[--p],s.prev[p]=m>=wsize?m-wsize:0}while(--n)};let HASH=(s,prev,data)=>(prev<<s.hash_shift^data)&s.hash_mask;const flush_pending=strm=>{const s=strm.state;let len=s.pending;len>strm.avail_out&&(len=strm.avail_out),0!==len&&(strm.output.set(s.pending_buf.subarray(s.pending_out,s.pending_out+len),strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,0===s.pending&&(s.pending_out=0))},flush_block_only=(s,last)=>{_tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last),s.block_start=s.strstart,flush_pending(s.strm)},put_byte=(s,b)=>{s.pending_buf[s.pending++]=b},putShortMSB=(s,b)=>{s.pending_buf[s.pending++]=b>>>8&255,s.pending_buf[s.pending++]=255&b},read_buf=(strm,buf,start,size)=>{let len=strm.avail_in;return len>size&&(len=size),0===len?0:(strm.avail_in-=len,buf.set(strm.input.subarray(strm.next_in,strm.next_in+len),start),1===strm.state.wrap?strm.adler=adler32_1(strm.adler,buf,len,start):2===strm.state.wrap&&(strm.adler=crc32_1(strm.adler,buf,len,start)),strm.next_in+=len,strm.total_in+=len,len)},longest_match=(s,cur_match)=>{let match,len,chain_length=s.max_chain_length,scan=s.strstart,best_len=s.prev_length,nice_match=s.nice_match;const limit=s.strstart>s.w_size-262?s.strstart-(s.w_size-262):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+258;let scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s.prev_length>=s.good_match&&(chain_length>>=2),nice_match>s.lookahead&&(nice_match=s.lookahead);do{if(match=cur_match,_win[match+best_len]===scan_end&&_win[match+best_len-1]===scan_end1&&_win[match]===_win[scan]&&_win[++match]===_win[scan+1]){scan+=2,match++;do{}while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len=258-(strend-scan),scan=strend-258,len>best_len){if(s.match_start=cur_match,best_len=len,len>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}}while((cur_match=prev[cur_match&wmask])>limit&&0!=--chain_length);return best_len<=s.lookahead?best_len:s.lookahead},fill_window=s=>{const _w_size=s.w_size;let n,more,str;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-262)&&(s.window.set(s.window.subarray(_w_size,_w_size+_w_size-more),0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,s.insert>s.strstart&&(s.insert=s.strstart),slide_hash(s),more+=_w_size),0===s.strm.avail_in)break;if(n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more),s.lookahead+=n,s.lookahead+s.insert>=3)for(str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=HASH(s,s.ins_h,s.window[str+1]);s.insert&&(s.ins_h=HASH(s,s.ins_h,s.window[str+3-1]),s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,!(s.lookahead+s.insert<3)););}while(s.lookahead<262&&0!==s.strm.avail_in)},deflate_stored=(s,flush)=>{let len,left,have,min_block=s.pending_buf_size-5>s.w_size?s.w_size:s.pending_buf_size-5,last=0,used=s.strm.avail_in;do{if(len=65535,have=s.bi_valid+42>>3,s.strm.avail_out<have)break;if(have=s.strm.avail_out-have,left=s.strstart-s.block_start,len>left+s.strm.avail_in&&(len=left+s.strm.avail_in),len>have&&(len=have),len<min_block&&(0===len&&flush!==Z_FINISH$3||flush===Z_NO_FLUSH$2||len!==left+s.strm.avail_in))break;last=flush===Z_FINISH$3&&len===left+s.strm.avail_in?1:0,_tr_stored_block(s,0,0,last),s.pending_buf[s.pending-4]=len,s.pending_buf[s.pending-3]=len>>8,s.pending_buf[s.pending-2]=~len,s.pending_buf[s.pending-1]=~len>>8,flush_pending(s.strm),left&&(left>len&&(left=len),s.strm.output.set(s.window.subarray(s.block_start,s.block_start+left),s.strm.next_out),s.strm.next_out+=left,s.strm.avail_out-=left,s.strm.total_out+=left,s.block_start+=left,len-=left),len&&(read_buf(s.strm,s.strm.output,s.strm.next_out,len),s.strm.next_out+=len,s.strm.avail_out-=len,s.strm.total_out+=len)}while(0===last);return used-=s.strm.avail_in,used&&(used>=s.w_size?(s.matches=2,s.window.set(s.strm.input.subarray(s.strm.next_in-s.w_size,s.strm.next_in),0),s.strstart=s.w_size,s.insert=s.strstart):(s.window_size-s.strstart<=used&&(s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,s.insert>s.strstart&&(s.insert=s.strstart)),s.window.set(s.strm.input.subarray(s.strm.next_in-used,s.strm.next_in),s.strstart),s.strstart+=used,s.insert+=used>s.w_size-s.insert?s.w_size-s.insert:used),s.block_start=s.strstart),s.high_water<s.strstart&&(s.high_water=s.strstart),last?4:flush!==Z_NO_FLUSH$2&&flush!==Z_FINISH$3&&0===s.strm.avail_in&&s.strstart===s.block_start?2:(have=s.window_size-s.strstart,s.strm.avail_in>have&&s.block_start>=s.w_size&&(s.block_start-=s.w_size,s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,have+=s.w_size,s.insert>s.strstart&&(s.insert=s.strstart)),have>s.strm.avail_in&&(have=s.strm.avail_in),have&&(read_buf(s.strm,s.window,s.strstart,have),s.strstart+=have,s.insert+=have>s.w_size-s.insert?s.w_size-s.insert:have),s.high_water<s.strstart&&(s.high_water=s.strstart),have=s.bi_valid+42>>3,have=s.pending_buf_size-have>65535?65535:s.pending_buf_size-have,min_block=have>s.w_size?s.w_size:have,left=s.strstart-s.block_start,(left>=min_block||(left||flush===Z_FINISH$3)&&flush!==Z_NO_FLUSH$2&&0===s.strm.avail_in&&left<=have)&&(len=left>have?have:left,last=flush===Z_FINISH$3&&0===s.strm.avail_in&&len===left?1:0,_tr_stored_block(s,s.block_start,len,last),s.block_start+=len,flush_pending(s.strm)),last?3:1)},deflate_fast=(s,flush)=>{let hash_head,bflush;for(;;){if(s.lookahead<262){if(fill_window(s),s.lookahead<262&&flush===Z_NO_FLUSH$2)return 1;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=3&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+3-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!==hash_head&&s.strstart-hash_head<=s.w_size-262&&(s.match_length=longest_match(s,hash_head)),s.match_length>=3)if(bflush=_tr_tally(s,s.strstart-s.match_start,s.match_length-3),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=3){s.match_length--;do{s.strstart++,s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+3-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart}while(0!=--s.match_length);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+1]);else bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return 1}return s.insert=s.strstart<2?s.strstart:2,flush===Z_FINISH$3?(flush_block_only(s,!0),0===s.strm.avail_out?3:4):s.sym_next&&(flush_block_only(s,!1),0===s.strm.avail_out)?1:2},deflate_slow=(s,flush)=>{let hash_head,bflush,max_insert;for(;;){if(s.lookahead<262){if(fill_window(s),s.lookahead<262&&flush===Z_NO_FLUSH$2)return 1;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=3&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+3-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=2,0!==hash_head&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-262&&(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(s.strategy===Z_FILTERED||3===s.match_length&&s.strstart-s.match_start>4096)&&(s.match_length=2)),s.prev_length>=3&&s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-3,bflush=_tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-3),s.lookahead-=s.prev_length-1,s.prev_length-=2;do{++s.strstart<=max_insert&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+3-1]),hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart)}while(0!=--s.prev_length);if(s.match_available=0,s.match_length=2,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return 1}else if(s.match_available){if(bflush=_tr_tally(s,0,s.window[s.strstart-1]),bflush&&flush_block_only(s,!1),s.strstart++,s.lookahead--,0===s.strm.avail_out)return 1}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(bflush=_tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<2?s.strstart:2,flush===Z_FINISH$3?(flush_block_only(s,!0),0===s.strm.avail_out?3:4):s.sym_next&&(flush_block_only(s,!1),0===s.strm.avail_out)?1:2};function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=strm=>{if(!strm)return 1;const s=strm.state;return!s||s.strm!==strm||42!==s.status&&57!==s.status&&69!==s.status&&73!==s.status&&91!==s.status&&103!==s.status&&113!==s.status&&666!==s.status?1:0},deflateResetKeep=strm=>{if(deflateStateCheck(strm))return err(strm,Z_STREAM_ERROR$2);strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN;const s=strm.state;return s.pending=0,s.pending_out=0,s.wrap<0&&(s.wrap=-s.wrap),s.status=2===s.wrap?57:s.wrap?42:113,strm.adler=2===s.wrap?0:1,s.last_flush=-2,_tr_init(s),Z_OK$3},deflateReset=strm=>{const ret=deflateResetKeep(strm);var s;return ret===Z_OK$3&&((s=strm.state).window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0),ret},deflateInit2=(strm,level,method,windowBits,memLevel,strategy)=>{if(!strm)return Z_STREAM_ERROR$2;let wrap=1;if(level===Z_DEFAULT_COMPRESSION$1&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):windowBits>15&&(wrap=2,windowBits-=16),memLevel<1||memLevel>9||method!==Z_DEFLATED$2||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED||8===windowBits&&1!==wrap)return err(strm,Z_STREAM_ERROR$2);8===windowBits&&(windowBits=9);const s=new DeflateState;return strm.state=s,s.strm=strm,s.status=42,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)};var deflate_1$2={deflateInit:(strm,level)=>deflateInit2(strm,level,Z_DEFLATED$2,15,8,Z_DEFAULT_STRATEGY$1),deflateInit2,deflateReset,deflateResetKeep,deflateSetHeader:(strm,head)=>deflateStateCheck(strm)||2!==strm.state.wrap?Z_STREAM_ERROR$2:(strm.state.gzhead=head,Z_OK$3),deflate:(strm,flush)=>{if(deflateStateCheck(strm)||flush>Z_BLOCK$1||flush<0)return strm?err(strm,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const s=strm.state;if(!strm.output||0!==strm.avail_in&&!strm.input||666===s.status&&flush!==Z_FINISH$3)return err(strm,0===strm.avail_out?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const old_flush=s.last_flush;if(s.last_flush=flush,0!==s.pending){if(flush_pending(strm),0===strm.avail_out)return s.last_flush=-1,Z_OK$3}else if(0===strm.avail_in&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH$3)return err(strm,Z_BUF_ERROR$1);if(666===s.status&&0!==strm.avail_in)return err(strm,Z_BUF_ERROR$1);if(42===s.status&&0===s.wrap&&(s.status=113),42===s.status){let header=Z_DEFLATED$2+(s.w_bits-8<<4)<<8,level_flags=-1;if(level_flags=s.strategy>=Z_HUFFMAN_ONLY||s.level<2?0:s.level<6?1:6===s.level?2:3,header|=level_flags<<6,0!==s.strstart&&(header|=32),header+=31-header%31,putShortMSB(s,header),0!==s.strstart&&(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),strm.adler=1,s.status=113,flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3}if(57===s.status)if(strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),s.gzhead)put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),put_byte(s,255&s.gzhead.time),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(put_byte(s,255&s.gzhead.extra.length),put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if(put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,3),s.status=113,flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3;if(69===s.status){if(s.gzhead.extra){let beg=s.pending,left=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+left>s.pending_buf_size;){let copy=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+copy),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex+=copy,flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3;beg=0,left-=copy}let gzhead_extra=new Uint8Array(s.gzhead.extra);s.pending_buf.set(gzhead_extra.subarray(s.gzindex,s.gzindex+left),s.pending),s.pending+=left,s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex=0}s.status=73}if(73===s.status){if(s.gzhead.name){let val,beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3;beg=0}val=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex=0}s.status=91}if(91===s.status){if(s.gzhead.comment){let val,beg=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3;beg=0}val=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg))}s.status=103}if(103===s.status){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(flush_pending(strm),0!==s.pending))return s.last_flush=-1,Z_OK$3;put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),strm.adler=0}if(s.status=113,flush_pending(strm),0!==s.pending)return s.last_flush=-1,Z_OK$3}if(0!==strm.avail_in||0!==s.lookahead||flush!==Z_NO_FLUSH$2&&666!==s.status){let bstate=0===s.level?deflate_stored(s,flush):s.strategy===Z_HUFFMAN_ONLY?((s,flush)=>{let bflush;for(;;){if(0===s.lookahead&&(fill_window(s),0===s.lookahead)){if(flush===Z_NO_FLUSH$2)return 1;break}if(s.match_length=0,bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return 1}return s.insert=0,flush===Z_FINISH$3?(flush_block_only(s,!0),0===s.strm.avail_out?3:4):s.sym_next&&(flush_block_only(s,!1),0===s.strm.avail_out)?1:2})(s,flush):s.strategy===Z_RLE?((s,flush)=>{let bflush,prev,scan,strend;const _win=s.window;for(;;){if(s.lookahead<=258){if(fill_window(s),s.lookahead<=258&&flush===Z_NO_FLUSH$2)return 1;if(0===s.lookahead)break}if(s.match_length=0,s.lookahead>=3&&s.strstart>0&&(scan=s.strstart-1,prev=_win[scan],prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan])){strend=s.strstart+258;do{}while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=258-(strend-scan),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=3?(bflush=_tr_tally(s,1,s.match_length-3),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(bflush=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return 1}return s.insert=0,flush===Z_FINISH$3?(flush_block_only(s,!0),0===s.strm.avail_out?3:4):s.sym_next&&(flush_block_only(s,!1),0===s.strm.avail_out)?1:2})(s,flush):configuration_table[s.level].func(s,flush);if(3!==bstate&&4!==bstate||(s.status=666),1===bstate||3===bstate)return 0===strm.avail_out&&(s.last_flush=-1),Z_OK$3;if(2===bstate&&(flush===Z_PARTIAL_FLUSH?_tr_align(s):flush!==Z_BLOCK$1&&(_tr_stored_block(s,0,0,!1),flush===Z_FULL_FLUSH$1&&(zero(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),flush_pending(strm),0===strm.avail_out))return s.last_flush=-1,Z_OK$3}return flush!==Z_FINISH$3?Z_OK$3:s.wrap<=0?Z_STREAM_END$3:(2===s.wrap?(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,255&strm.total_in),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255)):(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),flush_pending(strm),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Z_OK$3:Z_STREAM_END$3)},deflateEnd:strm=>{if(deflateStateCheck(strm))return Z_STREAM_ERROR$2;const status=strm.state.status;return strm.state=null,113===status?err(strm,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary:(strm,dictionary)=>{let dictLength=dictionary.length;if(deflateStateCheck(strm))return Z_STREAM_ERROR$2;const s=strm.state,wrap=s.wrap;if(2===wrap||1===wrap&&42!==s.status||s.lookahead)return Z_STREAM_ERROR$2;if(1===wrap&&(strm.adler=adler32_1(strm.adler,dictionary,dictLength,0)),s.wrap=0,dictLength>=s.w_size){0===wrap&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0);let tmpDict=new Uint8Array(s.w_size);tmpDict.set(dictionary.subarray(dictLength-s.w_size,dictLength),0),dictionary=tmpDict,dictLength=s.w_size}const avail=strm.avail_in,next=strm.next_in,input=strm.input;for(strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);s.lookahead>=3;){let str=s.strstart,n=s.lookahead-2;do{s.ins_h=HASH(s,s.ins_h,s.window[str+3-1]),s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++}while(--n);s.strstart=str,s.lookahead=2,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=2,s.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK$3},deflateInfo:"pako deflate (from Nodeca project)"};const _has=(obj,key)=>Object.prototype.hasOwnProperty.call(obj,key);var common={assign:function(obj){const sources=Array.prototype.slice.call(arguments,1);for(;sources.length;){const source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(const p in source)_has(source,p)&&(obj[p]=source[p])}}return obj},flattenChunks:chunks=>{let len=0;for(let i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;const result=new Uint8Array(len);for(let i=0,pos=0,l=chunks.length;i<l;i++){let chunk=chunks[i];result.set(chunk,pos),pos+=chunk.length}return result}};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var strings={string2buf:str=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(str);let buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)c=str.charCodeAt(m_pos),55296==(64512&c)&&m_pos+1<str_len&&(c2=str.charCodeAt(m_pos+1),56320==(64512&c2)&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++)),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new Uint8Array(buf_len),i=0,m_pos=0;i<buf_len;m_pos++)c=str.charCodeAt(m_pos),55296==(64512&c)&&m_pos+1<str_len&&(c2=str.charCodeAt(m_pos+1),56320==(64512&c2)&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++)),c<128?buf[i++]=c:c<2048?(buf[i++]=192|c>>>6,buf[i++]=128|63&c):c<65536?(buf[i++]=224|c>>>12,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c):(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c);return buf},buf2string:(buf,max)=>{const len=max||buf.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(buf.subarray(0,max));let i,out;const utf16buf=new Array(2*len);for(out=0,i=0;i<len;){let c=buf[i++];if(c<128){utf16buf[out++]=c;continue}let c_len=_utf8len[c];if(c_len>4)utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;c_len>1&&i<len;)c=c<<6|63&buf[i++],c_len--;c_len>1?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}}return((buf,len)=>{if(len<65534&&buf.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,buf.length===len?buf:buf.subarray(0,len));let result="";for(let i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result})(utf16buf,out)},utf8border:(buf,max)=>{(max=max||buf.length)>buf.length&&(max=buf.length);let pos=max-1;for(;pos>=0&&128==(192&buf[pos]);)pos--;return pos<0||0===pos?max:pos+_utf8len[buf[pos]]>max?pos:max}};var zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const toString$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(options){this.options=common.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},options||{});let opt=this.options;opt.raw&&opt.windowBits>0?opt.windowBits=-opt.windowBits:opt.gzip&&opt.windowBits>0&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let status=deflate_1$2.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK$2)throw new Error(messages[status]);if(opt.header&&deflate_1$2.deflateSetHeader(this.strm,opt.header),opt.dictionary){let dict;if(dict="string"==typeof opt.dictionary?strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString$1.call(opt.dictionary)?new Uint8Array(opt.dictionary):opt.dictionary,status=deflate_1$2.deflateSetDictionary(this.strm,dict),status!==Z_OK$2)throw new Error(messages[status]);this._dict_set=!0}}function deflate$1(input,options){const deflator=new Deflate$1(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||messages[deflator.err];return deflator.result}Deflate$1.prototype.push=function(data,flush_mode){const strm=this.strm,chunkSize=this.options.chunkSize;let status,_flush_mode;if(this.ended)return!1;for(_flush_mode=flush_mode===~~flush_mode?flush_mode:!0===flush_mode?Z_FINISH$2:Z_NO_FLUSH$1,"string"==typeof data?strm.input=strings.string2buf(data):"[object ArrayBuffer]"===toString$1.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;;)if(0===strm.avail_out&&(strm.output=new Uint8Array(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(_flush_mode===Z_SYNC_FLUSH||_flush_mode===Z_FULL_FLUSH)&&strm.avail_out<=6)this.onData(strm.output.subarray(0,strm.next_out)),strm.avail_out=0;else{if(status=deflate_1$2.deflate(strm,_flush_mode),status===Z_STREAM_END$2)return strm.next_out>0&&this.onData(strm.output.subarray(0,strm.next_out)),status=deflate_1$2.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK$2;if(0!==strm.avail_out){if(_flush_mode>0&&strm.next_out>0)this.onData(strm.output.subarray(0,strm.next_out)),strm.avail_out=0;else if(0===strm.avail_in)break}else this.onData(strm.output)}return!0},Deflate$1.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate$1.prototype.onEnd=function(status){status===Z_OK$2&&(this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};var deflate_1$1={Deflate:Deflate$1,deflate:deflate$1,deflateRaw:function(input,options){return(options=options||{}).raw=!0,deflate$1(input,options)},gzip:function(input,options){return(options=options||{}).gzip=!0,deflate$1(input,options)},constants:constants$2};var inffast=function(strm,start){let _in,last,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;const state=strm.state;_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,0===op)output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue dolen}if(32&op){state.mode=16191;break top}strm.msg="invalid literal/length code",state.mode=16209;break top}len=65535&here,op&=15,op&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,op=here>>>16&255,!(16&op)){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue dodist}strm.msg="invalid distance code",state.mode=16209;break top}if(dist=65535&here,op&=15,bits<op&&(hold+=input[_in++]<<bits,bits+=8,bits<op&&(hold+=input[_in++]<<bits,bits+=8)),dist+=hold&(1<<op)-1,dist>dmax){strm.msg="invalid distance too far back",state.mode=16209;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist>op){if(op=dist-op,op>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=16209;break top}if(from=0,from_source=s_window,0===wnext){if(from+=wsize-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,op-=wnext,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);if(from=0,wnext<len){op=wnext,len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}for(;len>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],len>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist;do{output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3}while(len>2);len&&(output[_out++]=output[from++],len>1&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);len=bits>>3,_in-=len,bits-=len<<3,hold&=(1<<bits)-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits};const lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var inftrees=(type,lens,lens_index,codes,table,table_index,work,opts)=>{const bits=opts.bits;let incr,fill,low,mask,next,match,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,base=null;const count=new Uint16Array(16),offs=new Uint16Array(16);let here_bits,here_op,here_val,extra=null;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;max>=1&&0===count[max];max--);if(root>max&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),left=1,len=1;len<=15;len++)if(left<<=1,left-=count[len],left<0)return-1;if(left>0&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(0===type?(base=extra=work,match=20):1===type?(base=lbase,extra=lext,match=257):(base=dbase,extra=dext,match=0),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,used=1<<root,mask=used-1,1===type&&used>852||2===type&&used>592)return 1;for(;;){here_bits=len-drop,work[sym]+1<match?(here_op=0,here_val=work[sym]):work[sym]>=match?(here_op=extra[work[sym]-match],here_val=base[work[sym]-match]):(here_op=96,here_val=0),incr=1<<len-drop,fill=1<<curr,min=fill;do{fill-=incr,table[next+(huff>>drop)+fill]=here_bits<<24|here_op<<16|here_val|0}while(0!==fill);for(incr=1<<len-1;huff&incr;)incr>>=1;if(0!==incr?(huff&=incr-1,huff+=incr):huff=0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,curr=len-drop,left=1<<curr;curr+drop<max&&(left-=count[curr+drop],!(left<=0));)curr++,left<<=1;if(used+=1<<curr,1===type&&used>852||2===type&&used>592)return 1;low=huff&mask,table[low]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0};const{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,BAD=16209,zswap32=q=>(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=strm=>{if(!strm)return 1;const state=strm.state;return!state||state.strm!==strm||state.mode<16180||state.mode>16211?1:0},inflateResetKeep=strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=16180,state.last=0,state.havedict=0,state.flags=-1,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new Int32Array(852),state.distcode=state.distdyn=new Int32Array(592),state.sane=1,state.back=-1,Z_OK$1},inflateReset=strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)},inflateReset2=(strm,windowBits)=>{let wrap;if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=5+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15)?Z_STREAM_ERROR$1:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))},inflateInit2=(strm,windowBits)=>{if(!strm)return Z_STREAM_ERROR$1;const state=new InflateState;strm.state=state,state.strm=strm,state.window=null,state.mode=16180;const ret=inflateReset2(strm,windowBits);return ret!==Z_OK$1&&(strm.state=null),ret};let lenfix,distfix,virgin=!0;const fixedtables=state=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let sym=0;for(;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inftrees(1,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inftrees(2,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5},updatewindow=(strm,src,end,copy)=>{let dist;const state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new Uint8Array(state.wsize)),copy>=state.wsize?(state.window.set(src.subarray(end-state.wsize,end),0),state.wnext=0,state.whave=state.wsize):(dist=state.wsize-state.wnext,dist>copy&&(dist=copy),state.window.set(src.subarray(end-copy,end-copy+dist),state.wnext),(copy-=dist)?(state.window.set(src.subarray(end-copy,end),0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0};var inflate_1$2={inflateReset,inflateReset2,inflateResetKeep,inflateInit:strm=>inflateInit2(strm,15),inflateInit2,inflate:(strm,flush)=>{let state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,here=0;const hbuf=new Uint8Array(4);let opts,n;const order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(strm)||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR$1;state=strm.state,16191===state.mode&&(state.mode=16192),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK$1;inf_leave:for(;;)switch(state.mode){case 16180:if(0===state.wrap){state.mode=16192;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){0===state.wbits&&(state.wbits=15),state.check=0,hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0),hold=0,bits=0,state.mode=16181;break}if(state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((15&hold)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(hold>>>=4,bits-=4,len=8+(15&hold),0===state.wbits&&(state.wbits=len),len>15||len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<state.wbits,state.flags=0,strm.adler=state.check=1,state.mode=512&hold?16189:16191,hold=0,bits=0;break;case 16181:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(255&state.flags)!==Z_DEFLATED){strm.msg="unknown compression method",state.mode=BAD;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&4&state.wrap&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=16182;case 16182:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&4&state.wrap&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32_1(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=16183;case 16183:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&4&state.wrap&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=16184;case 16184:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&4&state.wrap&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=16185;case 16185:if(1024&state.flags&&(copy=state.length,copy>have&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Uint8Array(state.head.extra_len)),state.head.extra.set(input.subarray(next,next+copy),len)),512&state.flags&&4&state.wrap&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=16186;case 16186:if(2048&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&4&state.wrap&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=16187;case 16187:if(4096&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&4&state.wrap&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=16188;case 16188:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(4&state.wrap&&hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=16191;break;case 16189:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=16190;case 16190:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT$1;strm.adler=state.check=1,state.mode=16191;case 16191:if(flush===Z_BLOCK||flush===Z_TREES)break inf_leave;case 16192:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=16206;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,hold>>>=1,bits-=1,3&hold){case 0:state.mode=16193;break;case 1:if(fixedtables(state),state.mode=16199,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=16196;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case 16193:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=65535&hold,hold=0,bits=0,state.mode=16194,flush===Z_TREES)break inf_leave;case 16194:state.mode=16195;case 16195:if(copy=state.length,copy){if(copy>have&&(copy=have),copy>left&&(copy=left),0===copy)break inf_leave;output.set(input.subarray(next,next+copy),put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=16191;break;case 16196:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=16197;case 16197:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inftrees(0,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=16198;case 16198:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=3+(7&hold),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=here_bits,bits-=here_bits,len=0,copy=11+(127&hold),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}for(;copy--;)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inftrees(1,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inftrees(2,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=16199,flush===Z_TREES)break inf_leave;case 16199:state.mode=16200;case 16200:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inffast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,16191===state.mode&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=16205;break}if(32&here_op){state.back=-1,state.mode=16191;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=15&here_op,state.mode=16201;case 16201:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=16202;case 16202:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=15&here_op,state.mode=16203;case 16203:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=16204;case 16204:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if(copy=state.offset-copy,copy>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;copy>left&&(copy=left),left-=copy,state.length-=copy;do{output[put++]=from_source[from++]}while(--copy);0===state.length&&(state.mode=16200);break;case 16205:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=16200;break;case 16206:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,4&state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,put-_out):adler32_1(state.check,output,_out,put-_out)),_out=left,4&state.wrap&&(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=16207;case 16207:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(4&state.wrap&&hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=16208;case 16208:ret=Z_STREAM_END$1;break inf_leave;case BAD:ret=Z_DATA_ERROR$1;break inf_leave;case 16210:return Z_MEM_ERROR$1;default:return Z_STREAM_ERROR$1}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<16206||flush!==Z_FINISH$1))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out),_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,4&state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,strm.next_out-_out):adler32_1(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(16191===state.mode?128:0)+(16199===state.mode||16194===state.mode?256:0),(0===_in&&0===_out||flush===Z_FINISH$1)&&ret===Z_OK$1&&(ret=Z_BUF_ERROR),ret},inflateEnd:strm=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;let state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK$1},inflateGetHeader:(strm,head)=>{if(inflateStateCheck(strm))return Z_STREAM_ERROR$1;const state=strm.state;return 0==(2&state.wrap)?Z_STREAM_ERROR$1:(state.head=head,head.done=!1,Z_OK$1)},inflateSetDictionary:(strm,dictionary)=>{const dictLength=dictionary.length;let state,dictid,ret;return inflateStateCheck(strm)?Z_STREAM_ERROR$1:(state=strm.state,0!==state.wrap&&16190!==state.mode?Z_STREAM_ERROR$1:16190===state.mode&&(dictid=1,dictid=adler32_1(dictid,dictionary,dictLength,0),dictid!==state.check)?Z_DATA_ERROR$1:(ret=updatewindow(strm,dictionary,dictLength,dictLength),ret?(state.mode=16210,Z_MEM_ERROR$1):(state.havedict=1,Z_OK$1)))},inflateInfo:"pako inflate (from Nodeca project)"};var gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const pako_esm_toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(options){this.options=common.assign({chunkSize:65536,windowBits:15,to:""},options||{});const opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(opt.windowBits>=0&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let status=inflate_1$2.inflateInit2(this.strm,opt.windowBits);if(status!==Z_OK)throw new Error(messages[status]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),opt.dictionary&&("string"==typeof opt.dictionary?opt.dictionary=strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===pako_esm_toString.call(opt.dictionary)&&(opt.dictionary=new Uint8Array(opt.dictionary)),opt.raw&&(status=inflate_1$2.inflateSetDictionary(this.strm,opt.dictionary),status!==Z_OK)))throw new Error(messages[status])}function inflate$1(input,options){const inflator=new Inflate$1(options);if(inflator.push(input),inflator.err)throw inflator.msg||messages[inflator.err];return inflator.result}Inflate$1.prototype.push=function(data,flush_mode){const strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary;let status,_flush_mode,last_avail_out;if(this.ended)return!1;for(_flush_mode=flush_mode===~~flush_mode?flush_mode:!0===flush_mode?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===pako_esm_toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;;){for(0===strm.avail_out&&(strm.output=new Uint8Array(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),status=inflate_1$2.inflate(strm,_flush_mode),status===Z_NEED_DICT&&dictionary&&(status=inflate_1$2.inflateSetDictionary(strm,dictionary),status===Z_OK?status=inflate_1$2.inflate(strm,_flush_mode):status===Z_DATA_ERROR&&(status=Z_NEED_DICT));strm.avail_in>0&&status===Z_STREAM_END&&strm.state.wrap>0&&0!==data[strm.next_in];)inflate_1$2.inflateReset(strm),status=inflate_1$2.inflate(strm,_flush_mode);switch(status){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(status),this.ended=!0,!1}if(last_avail_out=strm.avail_out,strm.next_out&&(0===strm.avail_out||status===Z_STREAM_END))if("string"===this.options.to){let next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8);strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&strm.output.set(strm.output.subarray(next_out_utf8,next_out_utf8+tail),0),this.onData(utf8str)}else this.onData(strm.output.length===strm.next_out?strm.output:strm.output.subarray(0,strm.next_out));if(status!==Z_OK||0!==last_avail_out){if(status===Z_STREAM_END)return status=inflate_1$2.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,!0;if(0===strm.avail_in)break}}return!0},Inflate$1.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate$1.prototype.onEnd=function(status){status===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};var inflate_1$1={Inflate:Inflate$1,inflate:inflate$1,inflateRaw:function(input,options){return(options=options||{}).raw=!0,inflate$1(input,options)},ungzip:inflate$1,constants:constants$2};const{Deflate,deflate,deflateRaw,gzip}=deflate_1$1,{Inflate,inflate,inflateRaw,ungzip}=inflate_1$1;var deflate_1=deflate,Inflate_1=Inflate,inflate_1=inflate;const pngSignature=[137,80,78,71,13,10,26,10],common_crcTable=[];for(let n=0;n<256;n++){let c=n;for(let k=0;k<8;k++)1&c?c=3988292384^c>>>1:c>>>=1;common_crcTable[n]=c}function crc(data,length){return(4294967295^function(currentCrc,data,length){let c=currentCrc;for(let n=0;n<length;n++)c=common_crcTable[255&(c^data[n])]^c>>>8;return c}(4294967295,data,length))>>>0}var ColorType,CompressionMethod,FilterMethod,InterlaceMethod;!function(ColorType){ColorType[ColorType.UNKNOWN=-1]="UNKNOWN",ColorType[ColorType.GREYSCALE=0]="GREYSCALE",ColorType[ColorType.TRUECOLOUR=2]="TRUECOLOUR",ColorType[ColorType.INDEXED_COLOUR=3]="INDEXED_COLOUR",ColorType[ColorType.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",ColorType[ColorType.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(ColorType||(ColorType={})),function(CompressionMethod){CompressionMethod[CompressionMethod.UNKNOWN=-1]="UNKNOWN",CompressionMethod[CompressionMethod.DEFLATE=0]="DEFLATE"}(CompressionMethod||(CompressionMethod={})),function(FilterMethod){FilterMethod[FilterMethod.UNKNOWN=-1]="UNKNOWN",FilterMethod[FilterMethod.ADAPTIVE=0]="ADAPTIVE"}(FilterMethod||(FilterMethod={})),function(InterlaceMethod){InterlaceMethod[InterlaceMethod.UNKNOWN=-1]="UNKNOWN",InterlaceMethod[InterlaceMethod.NO_INTERLACE=0]="NO_INTERLACE",InterlaceMethod[InterlaceMethod.ADAM7=1]="ADAM7"}(InterlaceMethod||(InterlaceMethod={}));const empty=new Uint8Array(0),uint16=new Uint16Array([255]),osIsLittleEndian=255===new Uint8Array(uint16.buffer)[0];class PngDecoder extends IOBuffer{constructor(data,options={}){super(data);const{checkCrc=!1}=options;this._checkCrc=checkCrc,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let i=0;i<pngSignature.length;i++)if(this.readUint8()!==pngSignature[i])throw new Error(`wrong PNG signature. Byte at ${i} should be ${pngSignature[i]}.`)}decodeChunk(){const length=this.readUint32(),type=this.readChars(4),offset=this.offset;switch(type){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(length);break;case"IDAT":this.decodeIDAT(length);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(length);break;case"iCCP":this.decodeiCCP(length);break;case"tEXt":this.decodetEXt(length);break;case"pHYs":this.decodepHYs();break;default:this.skip(length)}if(this.offset-offset!==length)throw new Error(`Length mismatch while decoding chunk ${type}`);if(this._checkCrc){const expectedCrc=this.readUint32(),crcLength=length+4,actualCrc=crc(new Uint8Array(this.buffer,this.byteOffset+this.offset-crcLength-4,crcLength),crcLength);if(actualCrc!==expectedCrc)throw new Error(`CRC mismatch for chunk ${type}. Expected ${expectedCrc}, found ${actualCrc}`)}else this.skip(4)}decodeIHDR(){const image=this._png;image.width=this.readUint32(),image.height=this.readUint32(),image.depth=function(value){if(1!==value&&2!==value&&4!==value&&8!==value&&16!==value)throw new Error(`invalid bit depth: ${value}`);return value}(this.readUint8());const colorType=this.readUint8();let channels;switch(this._colorType=colorType,colorType){case ColorType.GREYSCALE:channels=1;break;case ColorType.TRUECOLOUR:channels=3;break;case ColorType.INDEXED_COLOUR:channels=1;break;case ColorType.GREYSCALE_ALPHA:channels=2;break;case ColorType.TRUECOLOUR_ALPHA:channels=4;break;default:throw new Error(`Unknown color type: ${colorType}`)}if(this._png.channels=channels,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(length){if(length%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${length}`);const l=length/3;this._hasPalette=!0;const palette=[];this._palette=palette;for(let i=0;i<l;i++)palette.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(length){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,length)),this.skip(length)}decodetRNS(length){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:if(length%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${length}`);if(length/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${length/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(length/2);for(let i=0;i<length/2;i++)this._transparency[i]=this.readUint16();break;case ColorType.INDEXED_COLOUR:{if(length>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${length} vs ${this._palette.length})`);let i=0;for(;i<length;i++){const alpha=this.readByte();this._palette[i].push(alpha)}for(;i<this._palette.length;i++)this._palette[i].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(length){let char,name="";for(;"\0"!==(char=this.readChar());)name+=char;const compressionMethod=this.readUint8();if(compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${compressionMethod}`);const compressedProfile=this.readBytes(length-name.length-2);this._png.iccEmbeddedProfile={name,profile:inflate_1(compressedProfile)}}decodetEXt(length){let char,keyword="";for(;"\0"!==(char=this.readChar());)keyword+=char;this._png.text[keyword]=this.readChars(length-keyword.length-1)}decodepHYs(){const ppuX=this.readUint32(),ppuY=this.readUint32(),unitSpecifier=this.readByte();this._png.resolution={x:ppuX,y:ppuY,unit:unitSpecifier}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const data=this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==InterlaceMethod.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(data)}decodeInterlaceNull(data){const height=this._png.height,bytesPerPixel=this._png.channels*this._png.depth/8,bytesPerLine=this._png.width*bytesPerPixel,newData=new Uint8Array(this._png.height*bytesPerLine);let currentLine,newLine,prevLine=empty,offset=0;for(let i=0;i<height;i++){switch(currentLine=data.subarray(offset+1,offset+1+bytesPerLine),newLine=newData.subarray(i*bytesPerLine,(i+1)*bytesPerLine),data[offset]){case 0:unfilterNone(currentLine,newLine,bytesPerLine);break;case 1:unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel);break;case 2:unfilterUp(currentLine,newLine,prevLine,bytesPerLine);break;case 3:unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;case 4:unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel);break;default:throw new Error(`Unsupported filter: ${data[offset]}`)}prevLine=newLine,offset+=bytesPerLine+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const uint16Data=new Uint16Array(newData.buffer);if(osIsLittleEndian)for(let k=0;k<uint16Data.length;k++)uint16Data[k]=(255&(val=uint16Data[k]))<<8|val>>8&255;this._png.data=uint16Data}else this._png.data=newData;var val}}function unfilterNone(currentLine,newLine,bytesPerLine){for(let i=0;i<bytesPerLine;i++)newLine[i]=currentLine[i]}function unfilterSub(currentLine,newLine,bytesPerLine,bytesPerPixel){let i=0;for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+newLine[i-bytesPerPixel]&255}function unfilterUp(currentLine,newLine,prevLine,bytesPerLine){let i=0;if(0===prevLine.length)for(;i<bytesPerLine;i++)newLine[i]=currentLine[i];else for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+prevLine[i]&255}function unfilterAverage(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i=0;if(0===prevLine.length){for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+(newLine[i-bytesPerPixel]>>1)&255}else{for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i]+(prevLine[i]>>1)&255;for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+(newLine[i-bytesPerPixel]+prevLine[i]>>1)&255}}function unfilterPaeth(currentLine,newLine,prevLine,bytesPerLine,bytesPerPixel){let i=0;if(0===prevLine.length){for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i];for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+newLine[i-bytesPerPixel]&255}else{for(;i<bytesPerPixel;i++)newLine[i]=currentLine[i]+prevLine[i]&255;for(;i<bytesPerLine;i++)newLine[i]=currentLine[i]+paethPredictor(newLine[i-bytesPerPixel],prevLine[i],prevLine[i-bytesPerPixel])&255}}function paethPredictor(a,b,c){const p=a+b-c,pa=Math.abs(p-a),pb=Math.abs(p-b),pc=Math.abs(p-c);return pa<=pb&&pa<=pc?a:pb<=pc?b:c}const defaultZlibOptions={level:3};class PngEncoder extends IOBuffer{constructor(data,options={}){super(),this._colorType=ColorType.UNKNOWN,this._zlibOptions={...defaultZlibOptions,...options.zlib},this._png=this._checkData(data),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(pngSignature)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(CompressionMethod.DEFLATE),this.writeByte(FilterMethod.ADAPTIVE),this.writeByte(InterlaceMethod.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(data){this.writeUint32(data.length),this.writeChars("IDAT"),this.writeBytes(data),this.writeCrc(data.length+4)}encodeData(){const{width,height,channels,depth,data}=this._png,slotsPerLine=channels*width,newData=(new IOBuffer).setBigEndian();let offset=0;for(let i=0;i<height;i++)if(newData.writeByte(0),8===depth)offset=writeDataBytes(data,newData,slotsPerLine,offset);else{if(16!==depth)throw new Error("unreachable");offset=writeDataUint16(data,newData,slotsPerLine,offset)}const buffer=newData.toArray(),compressed=deflate_1(buffer,this._zlibOptions);this.encodeIDAT(compressed)}_checkData(data){const{colorType,channels,depth}=function(data){const{channels=4,depth=8}=data;if(4!==channels&&3!==channels&&2!==channels&&1!==channels)throw new RangeError(`unsupported number of channels: ${channels}`);if(8!==depth&&16!==depth)throw new RangeError(`unsupported bit depth: ${depth}`);const returnValue={channels,depth,colorType:ColorType.UNKNOWN};switch(channels){case 4:returnValue.colorType=ColorType.TRUECOLOUR_ALPHA;break;case 3:returnValue.colorType=ColorType.TRUECOLOUR;break;case 1:returnValue.colorType=ColorType.GREYSCALE;break;case 2:returnValue.colorType=ColorType.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return returnValue}(data),png={width:checkInteger(data.width,"width"),height:checkInteger(data.height,"height"),channels,data:data.data,depth,text:{}};this._colorType=colorType;const expectedSize=png.width*png.height*channels;if(png.data.length!==expectedSize)throw new RangeError(`wrong data size. Found ${png.data.length}, expected ${expectedSize}`);return png}writeCrc(length){this.writeUint32(crc(new Uint8Array(this.buffer,this.byteOffset+this.offset-length,length),length))}}function checkInteger(value,name){if(Number.isInteger(value)&&value>0)return value;throw new TypeError(`${name} must be a positive integer`)}function writeDataBytes(data,newData,slotsPerLine,offset){for(let j=0;j<slotsPerLine;j++)newData.writeByte(data[offset++]);return offset}function writeDataUint16(data,newData,slotsPerLine,offset){for(let j=0;j<slotsPerLine;j++)newData.writeUint16(data[offset++]);return offset}var ResolutionUnitSpecifier;function decodePng(data,options){return new PngDecoder(data,options).decode()}function encodePng(png,options){return new PngEncoder(png,options).encode()}!function(ResolutionUnitSpecifier){ResolutionUnitSpecifier[ResolutionUnitSpecifier.UNKNOWN=0]="UNKNOWN",ResolutionUnitSpecifier[ResolutionUnitSpecifier.METRE=1]="METRE"}(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}))},984:module=>{"use strict";module.exports=function(Mousetrap){var _recordedSequence=[],_recordedSequenceCallback=null,_currentRecordedKeys=[],_recordedCharacterKey=!1,_recordTimer=null,_origHandleKey=Mousetrap.prototype.handleKey;function _handleKey(character,modifiers,e){if(this.recording)if("keydown"==e.type){1===character.length&&_recordedCharacterKey&&_recordCurrentCombo();for(var i=0;i<modifiers.length;++i)_recordKey(modifiers[i]);_recordKey(character)}else"keyup"==e.type&&_currentRecordedKeys.length>0&&_recordCurrentCombo();else _origHandleKey.apply(this,arguments)}function _recordKey(key){var i;for(i=0;i<_currentRecordedKeys.length;++i)if(_currentRecordedKeys[i]===key)return;_currentRecordedKeys.push(key),1===key.length&&(_recordedCharacterKey=!0)}function _recordCurrentCombo(){_recordedSequence.push(_currentRecordedKeys),_currentRecordedKeys=[],_recordedCharacterKey=!1,clearTimeout(_recordTimer),_recordTimer=setTimeout(_finishRecording,1e3)}function _finishRecording(){_recordedSequenceCallback&&(!function(sequence){var i;for(i=0;i<sequence.length;++i)sequence[i].sort((function(x,y){return x.length>1&&1===y.length?-1:1===x.length&&y.length>1||x>y?1:-1})),sequence[i]=sequence[i].join("+")}(_recordedSequence),_recordedSequenceCallback(_recordedSequence)),_recordedSequence=[],_recordedSequenceCallback=null,_currentRecordedKeys=[]}return Mousetrap.prototype.record=function(callback){var self=this;self.recording=!0,_recordedSequenceCallback=function(){self.recording=!1,callback.apply(self,arguments)}},Mousetrap.prototype.handleKey=function(){_handleKey.apply(this,arguments)},Mousetrap.init(),Mousetrap}},320:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Component=void 0;const helpers_1=__webpack_require__(416),core_1=__webpack_require__(396),state_1=__webpack_require__(212);exports.Component=class{constructor(props){this._elements=[],this._skipUnmount=!1,this._hasUnmounted=!1,this.props=props||{},this.id=this._getHash()}static isClass(){return!0}setState(state,shouldUpdate=!1){"object"==typeof state&&null!==state&&void 0!==this.state?this.state=Object.assign(Object.assign({},this.state),state):this.state=state,shouldUpdate&&this.update()}set state(state){state_1._state.set(this.id,state)}get state(){return state_1._state.get(this.id)}set initState(state){void 0===this.state&&(this.state=state)}get elements(){return this._elements}set elements(elements){Array.isArray(elements)||(elements=[elements]),elements.forEach((element=>{this._elements.push(element)}))}_addNodeRemoveListener(){/^[^{]+{\s+}$/gm.test(this.didUnmount.toString())||helpers_1.onNodeRemove(this.elements[0],(()=>{this._skipUnmount||this._didUnmount()}))}_didMount(){this._addNodeRemoveListener(),this.didMount()}_didUnmount(){this._hasUnmounted||(this.didUnmount(),this._hasUnmounted=!0)}willMount(){}didMount(){}didUnmount(){}render(_update){}update(update){this._skipUnmount=!0;const oldElements=[...this.elements];this._elements=[];let el=this.render(update);el=core_1._render(el),this.elements=el;const parent=oldElements[0].parentElement;parent||console.warn("Component needs a parent element to get updated!"),this.elements.forEach((child=>{parent.insertBefore(child,oldElements[0])})),oldElements.forEach((child=>{child.remove(),child=null})),this._addNodeRemoveListener(),core_1.tick((()=>{this._skipUnmount=!1,this.elements[0].isConnected||this._didUnmount()}))}_getHash(){}}},776:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Helmet=void 0;const component_1=__webpack_require__(320),core_1=__webpack_require__(396);class Helmet extends component_1.Component{static SSR(body){const reg=/(<helmet\b[^>]*>)((.|\n)*?)(<\/helmet>)/gm,head=[],footer=[];if("undefined"!=typeof document&&document.head){let children=[];children=document.head.children;for(let i=0;i<children.length;i++)-1===head.indexOf(children[i])&&head.push(children[i])}let result;for(;null!==(result=reg.exec(body));){const first=result[1],second=result[2];first.includes('data-placement="head"')&&!head.includes(second)?head.push(second):footer.includes(second)||footer.push(second)}return{body:body.replace(reg,""),head,footer}}didMount(){this.props.children.forEach((element=>{var _a,_b,_c,_d;const parent=this.props.footer?document.body:document.head,tag=element.tagName;let attrs=[];attrs.push(element.innerText);for(let attr=0;attr<element.attributes.length;attr++)attrs.push(null===(_a=element.attributes.item(attr))||void 0===_a?void 0:_a.name.toLowerCase()),attrs.push(null===(_b=element.attributes.item(attr))||void 0===_b?void 0:_b.value.toLowerCase());if("HTML"===tag||"BODY"===tag){const htmlTag=document.getElementsByTagName(tag)[0];for(let attr=1;attr<attrs.length;attr+=2)htmlTag.setAttribute(attrs[attr],attrs[attr+1]);return}if("TITLE"===tag){const titleTags=document.getElementsByTagName("TITLE");if(titleTags.length>0){const e=element;titleTags[0].text=e.text}else{const titleTag=core_1.h("title",null,element.innerHTML);parent.appendChild(titleTag)}return}let exists=!1;attrs=attrs.sort();const el=document.getElementsByTagName(tag);for(let i=0;i<el.length;i++){let attrs2=[];attrs2.push(el[i].innerText);for(let attr=0;attr<el[i].attributes.length;attr++)attrs2.push(null===(_c=el[i].attributes.item(attr))||void 0===_c?void 0:_c.name.toLowerCase()),attrs2.push(null===(_d=el[i].attributes.item(attr))||void 0===_d?void 0:_d.value.toLowerCase());attrs2=attrs2.sort(),attrs.length>0&&attrs2.length>0&&JSON.stringify(attrs)===JSON.stringify(attrs2)&&(exists=!0)}exists||core_1.appendChildren(parent,element)}))}render(){const placement=this.props.footer?"footer":"head";return!(!globalThis||!globalThis.isSSR)?core_1.h("helmet",{"data-ssr":!0,"data-placement":placement},this.props.children):[]}}exports.Helmet=Helmet},179:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Img=void 0;const component_1=__webpack_require__(320),core_1=__webpack_require__(396);class Img extends component_1.Component{constructor(props){super(props);const{src,key}=props;this.id=`${core_1.strToHash(src)}-${core_1.strToHash(JSON.stringify(props))}`,key&&(this.id+=`key-${key}`),this.state||this.setState({isLoaded:!1,image:void 0})}didMount(){const _a=this.props,{lazy=!0,placeholder,children,key,ref}=_a,rest=__rest(_a,["lazy","placeholder","children","key","ref"]);if("boolean"==typeof lazy&&!1===lazy)return;new IntersectionObserver(((entries,observer)=>{entries.forEach((entry=>{entry.isIntersecting&&(observer.disconnect(),this.state.image=core_1.h("img",Object.assign({},rest)),this.state.image.complete?(this.state.isLoaded=!0,this.update()):this.state.image.onload=()=>{this.state.isLoaded=!0,this.update()})}))}),{threshold:[0,1]}).observe(this.elements[0])}render(){const _a=this.props,{src,placeholder,children,lazy=!0,key,ref}=_a,rest=__rest(_a,["src","placeholder","children","lazy","key","ref"]);if("boolean"==typeof lazy&&!1===lazy)return this.state.image=core_1.h("img",Object.assign({src},rest)),this.state.image;if(this.state.isLoaded)return this.state.image;if(placeholder&&"string"==typeof placeholder)return core_1.h("img",Object.assign({src:placeholder},rest));if(placeholder&&"function"==typeof placeholder)return placeholder();{const style={};rest.width&&(style.width=`${rest.width}px`),rest.height&&(style.height=`${rest.height}px`);const{width,height}=rest,others=__rest(rest,["width","height"]);return core_1.h("div",Object.assign({style},others))}}}exports.Img=Img},995:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Visible=exports.Suspense=exports.Router=exports.Link=exports.Img=exports.Helmet=void 0;var helmet_1=__webpack_require__(776);Object.defineProperty(exports,"Helmet",{enumerable:!0,get:function(){return helmet_1.Helmet}});var img_1=__webpack_require__(179);Object.defineProperty(exports,"Img",{enumerable:!0,get:function(){return img_1.Img}});var link_1=__webpack_require__(368);Object.defineProperty(exports,"Link",{enumerable:!0,get:function(){return link_1.Link}}),exports.Router=__importStar(__webpack_require__(360));var suspense_1=__webpack_require__(792);Object.defineProperty(exports,"Suspense",{enumerable:!0,get:function(){return suspense_1.Suspense}});var visible_1=__webpack_require__(920);Object.defineProperty(exports,"Visible",{enumerable:!0,get:function(){return visible_1.Visible}})},368:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Link=void 0;const component_1=__webpack_require__(320),helmet_1=__webpack_require__(776),core_1=__webpack_require__(396),fragment_1=__webpack_require__(124);class Link extends component_1.Component{prefetchOnHover(){this.elements[0].addEventListener("mouseover",(()=>this.addPrefetch()),{once:!0})}prefetchOnVisible(){new IntersectionObserver(((entries,observer)=>{entries.forEach((entry=>{entry.isIntersecting&&(observer.disconnect(),this.addPrefetch())}))}),{threshold:[0,1]}).observe(this.elements[0])}addPrefetch(){let doesAlreadyExist=!1;const links=document.getElementsByTagName("link");for(let i=0;i<links.length;i++)"prefetch"===links[i].getAttribute("rel")&&links[i].getAttribute("href")===this.props.href&&(doesAlreadyExist=!0);if(!doesAlreadyExist){const prefetch=core_1.h("link",{rel:"prefetch",href:this.props.href,as:"document"});document.head.appendChild(prefetch)}}didMount(){const{href,prefetch,delay=0,back=!1}=this.props;back&&this.elements[0].addEventListener("click",(e=>{e.preventDefault();const target=e.target;target.href===document.referrer?window.history.back():window.location.href=target.href})),delay>0&&this.elements[0].addEventListener("click",(e=>{e.preventDefault(),setTimeout((()=>window.location.href=href),delay)})),prefetch&&("hover"===prefetch?this.prefetchOnHover():"visible"===prefetch?this.prefetchOnVisible():this.addPrefetch())}render(){const _a=this.props,{children,prefetch,back,ref}=_a,rest=__rest(_a,["children","prefetch","back","ref"]);this.props.href||console.warn('Please add "href" to <Link>'),1!==children.length&&console.warn("Please add ONE child to <Link> (<Link>child</Link>)");const a=core_1.h("a",Object.assign({},rest),...children);if(!0!==prefetch||"undefined"!=typeof window&&window.document)return a;{const link=core_1.h("link",{rel:"prefetch",href:this.props.href,as:"document"}),helmet=core_1.h(helmet_1.Helmet,null,link);return core_1.h(fragment_1.Fragment,null,[helmet,a])}}}exports.Link=Link},360:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Link=exports.to=exports.Route=exports.Switch=void 0;const component_1=__webpack_require__(320),core_1=__webpack_require__(396),instances=[],historyPush=path=>{window.history.pushState({},"",path),instances.forEach((instance=>instance.handlePop()))},historyReplace=path=>{window.history.replaceState({},"",path),instances.forEach((instance=>instance.handlePop()))},matchPath=(pathname,options)=>{const{exact=!1,regex}=options;let match,{path}=options;if(!path)return{path:null,url:pathname,isExact:!0};let params={};if(path.includes("/:")){const pathArr=path.split("/"),pathnameArr=pathname.split("/");pathArr.forEach(((p,i)=>{if(/^:/.test(p)){const key=p.slice(1),value=pathnameArr[i];if(regex&&regex[key]){if(!regex[key].test(value))return null}params=Object.assign(Object.assign({},params),{[key]:value}),pathArr[i]=pathnameArr[i]}})),path=pathArr.join("/")}if("*"===path&&(match=[pathname]),match||(match=new RegExp(`^${path}`).exec(pathname)),!match)return null;const url=match[0],isExact=pathname===url;return exact&&!isExact?null:{path,url,isExact,params}};class Switch extends component_1.Component{constructor(){super(...arguments),this.index=0,this.path="",this.match={index:-1,path:""}}didMount(){var comp;window.addEventListener("popstate",this.handlePop.bind(this)),comp=this,instances.push(comp)}didUnmount(){var comp;window.removeEventListener("popstate",this.handlePop.bind(this)),comp=this,instances.splice(instances.indexOf(comp),1)}handlePop(){this.findChild(),this.shouldUpdate()&&this.update()}findChild(){this.match={index:-1,path:""};for(let i=0;i<this.props.children.length;i++){const child=this.props.children[i],{path,exact,regex}=child.props;if(matchPath("undefined"!=typeof isSSR?_nano.location.pathname:window.location.pathname,{path,exact,regex}))return this.match.index=i,void(this.match.path=path)}}shouldUpdate(){return this.path!==this.match.path||this.index!==this.match.index}render(){this.findChild();const child=this.props.children[this.match.index];if(-1===this.match.index&&(this.path="",this.index=0),child){const{path}=child.props;this.path=path,this.index=this.match.index;const el=core_1._render(child);return core_1._render(el)}return this.props.fallback?core_1._render(this.props.fallback):core_1.h("div",{class:"route"},"not found")}}exports.Switch=Switch;exports.Route=({path,regex,children})=>(children.forEach((child=>{child.props&&(child.props=Object.assign(Object.assign({},child.props),{route:{path,regex}}))})),children);exports.to=(to,replace=!1)=>{replace?historyReplace(to):historyPush(to)};exports.Link=({to,replace,children})=>core_1.h("a",{href:to,onClick:e=>(e.preventDefault(),void(replace?historyReplace(to):historyPush(to)))},children)},792:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Suspense=void 0;const component_1=__webpack_require__(320),core_1=__webpack_require__(396);class Suspense extends component_1.Component{constructor(props){super(props),this.ready=!1;const _a=this.props,{children,fallback,cache=!1}=_a,rest=__rest(_a,["children","fallback","cache"]),str=JSON.stringify(rest,(function(_key,val){return"function"==typeof val?`${val}`:val}));this.id=core_1.strToHash(JSON.stringify(str))}didMount(){return __awaiter(this,void 0,void 0,(function*(){const _a=this.props,{children,fallback,cache=!1}=_a,rest=__rest(_a,["children","fallback","cache"]);if(cache&&(this.initState={}),this.loadFromCache(cache))return;const promises=Object.values(rest).map((p=>p())),resolved=yield Promise.all(promises),data=this.prepareData(rest,resolved,cache);this.addDataToChildren(data),this.ready=!0,this.update()}))}ssr(){const _a=this.props,{children,fallback,cache=!1}=_a,rest=__rest(_a,["children","fallback","cache"]),functions=Object.values(rest).map((p=>p())),data=this.prepareData(rest,functions,!1);this.addDataToChildren(data)}loadFromCache(cache){const hasCachedProps=this.state&&cache&&Object.keys(this.state).length>0;return hasCachedProps&&(this.addDataToChildren(this.state),this.ready=!0),hasCachedProps}prepareData(rest,fnc,cache){return Object.keys(rest).reduce(((obj,item,index)=>(cache&&(this.state=Object.assign(Object.assign({},this.state),{[item]:fnc[index]})),Object.assign(Object.assign({},obj),{[item]:fnc[index]}))),{})}addDataToChildren(data){this.props.children.forEach((child=>{child.props&&(child.props=Object.assign(Object.assign({},child.props),data))}))}render(){if("undefined"==typeof isSSR){const{cache=!1}=this.props;return this.loadFromCache(cache),this.ready?this.props.children:this.props.fallback}return this.ssr(),this.props.children}}exports.Suspense=Suspense},920:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Visible=void 0;const core_1=__webpack_require__(396),component_1=__webpack_require__(320);class Visible extends component_1.Component{constructor(){super(...arguments),this.isVisible=!1}didMount(){new IntersectionObserver(((entries,observer)=>{entries.forEach((entry=>{entry.isIntersecting&&(observer.disconnect(),this.isVisible=!0,this.update())}))}),{threshold:[0,1]}).observe(this.elements[0])}render(){return this.isVisible?(this.props.onVisible&&this.props.onVisible(),core_1.render(this.props.component||this.props.children[0])):core_1.h("div",{"data-visible":!1,visibility:"hidden"})}}exports.Visible=Visible},96:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createContext=void 0;exports.createContext=ctx=>{let _ctx=ctx;return{Provider:props=>(props.value&&(_ctx=props.value),props.children),Consumer:props=>({component:props.children[0](_ctx),props:Object.assign(Object.assign({},props),{context:_ctx})}),get:()=>_ctx,set:ctx=>_ctx=ctx}}},396:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.h=exports.renderComponent=exports._render=exports.render=exports.hydrate=exports.appendChildren=exports.strToHash=exports.removeAllChildNodes=exports.tick=void 0,exports.tick="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout;exports.removeAllChildNodes=parent=>{for(;parent.firstChild;)parent.removeChild(parent.firstChild)};exports.strToHash=s=>{let hash=0;for(let i=0;i<s.length;i++){hash=(hash<<5)-hash+s.charCodeAt(i),hash|=0}return Math.abs(hash).toString(32)};exports.appendChildren=(element,children)=>{Array.isArray(children)?("object"==typeof children&&(children=Array.prototype.slice.call(children)),children.forEach((child=>{if(Array.isArray(child))exports.appendChildren(element,child);else{const c=exports._render(child);void 0!==c&&(Array.isArray(c)?exports.appendChildren(element,c):element.appendChild(null==c.nodeType?document.createTextNode(c.toString()):c))}}))):exports.appendChildren(element,[children])};exports.hydrate=(component,parent=null,removeChildNodes=!0)=>exports.render(component,parent,removeChildNodes);exports.render=(component,parent=null,removeChildNodes=!0)=>{let el=exports._render(component);return Array.isArray(el)&&(el=el.map((e=>exports._render(e))),1===el.length&&(el=el[0])),parent?(removeChildNodes&&exports.removeAllChildNodes(parent),el&&parent.id&&parent.id===el.id&&parent.parentElement?parent.parentElement.replaceChild(el,parent):Array.isArray(el)?el.forEach((e=>{exports.appendChildren(parent,exports._render(e))})):exports.appendChildren(parent,exports._render(el)),parent.ssr?parent.ssr:parent):"boolean"!=typeof isSSR||!0!==isSSR||Array.isArray(el)?el:[el]};exports._render=comp=>void 0===comp||null==comp?[]:"string"==typeof comp?comp:"number"==typeof comp?comp.toString():comp.tagName&&"svg"===comp.tagName.toLowerCase()?(props=>{const child=props.children[0],attrs=child.attributes,svg=hNS("svg");for(let i=attrs.length-1;i>=0;i--)svg.setAttribute(attrs[i].name,attrs[i].value);return svg.innerHTML=child.innerHTML,svg})({children:[comp]}):comp.tagName?comp:comp&&comp.component&&comp.component.isClass&&comp.component.isClass()?renderClassComponent(comp):comp.component&&"function"==typeof comp.component?renderFunctionalComponent(comp):Array.isArray(comp)?comp.map((c=>exports._render(c))).flat():"function"==typeof comp?exports._render(comp()):comp.component&&comp.component.tagName&&"string"==typeof comp.component.tagName||Array.isArray(comp.component)||comp.component?exports._render(comp.component):"object"==typeof comp?[]:void console.warn("Something unexpected happened with:",comp);const renderFunctionalComponent=fncComp=>{const{component,props}=fncComp;return exports._render(component(props))},renderClassComponent=classComp=>{const{component,props}=classComp,hash=exports.strToHash(component.toString());component.prototype._getHash=()=>hash;const Component=new component(props);Component.willMount();let el=Component.render();return el=exports._render(el),Component.elements=el,props&&props.ref&&props.ref(Component),"undefined"==typeof isSSR&&exports.tick((()=>{Component._didMount()})),el};exports.renderComponent=_component=>{console.warn("DEPRECATED: renderComponent() is deprecated, use _render() instead!")};const hNS=tag=>document.createElementNS("http://www.w3.org/2000/svg",tag);exports.h=(tagNameOrComponent,props,...children)=>{if("string"!=typeof tagNameOrComponent)return{component:tagNameOrComponent,props:Object.assign(Object.assign({},props),{children})};let ref;const element="svg"===tagNameOrComponent?hNS("svg"):document.createElement(tagNameOrComponent),isEvent=(el,p)=>0===p.indexOf("on")&&(!!el.ssr||("object"==typeof el[p]||"function"==typeof el[p]));for(const p in props){if("style"===p&&"object"==typeof props[p]){const styles=Object.keys(props[p]).map((k=>`${k}:${props[p][k]}`)).join(";").replace(/[A-Z]/g,(match=>`-${match.toLowerCase()}`));props[p]=`${styles};`}"ref"===p?ref=props[p]:isEvent(element,p.toLowerCase())?element.addEventListener(p.toLowerCase().substring(2),(e=>props[p](e))):/className/i.test(p)?console.warn('You can use "class" instead of "className".'):element.setAttribute(p,props[p])}return exports.appendChildren(element,children),ref&&ref(element),element.ssr?element.ssr:element}},124:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Fragment=void 0;exports.Fragment=props=>props.children},416:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.printVersion=exports.onNodeRemove=exports.nodeToString=exports.task=void 0;const version_1=__webpack_require__(280);exports.task=task=>setTimeout(task,0);exports.nodeToString=node=>{const tmpNode=document.createElement("div");return tmpNode.appendChild(node.cloneNode(!0)),tmpNode.innerHTML};const isDescendant=(desc,root)=>!!desc&&(desc===root||isDescendant(desc.parentNode,root));exports.onNodeRemove=(element,callback)=>{let observer=new MutationObserver((mutationsList=>{mutationsList.forEach((mutation=>{mutation.removedNodes.forEach((removed=>{isDescendant(element,removed)&&(callback(),observer&&(observer.disconnect(),observer=void 0))}))}))}));return observer.observe(document,{childList:!0,subtree:!0}),observer};exports.printVersion=()=>{const info=`Powered by nano JSX v${version_1.VERSION}`;console.log(`%c %c %c %c %c ${info} %c http://nanojsx.io`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")}},120:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const index_1=__importDefault(__webpack_require__(104));exports.default=index_1.default},488:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.evaluate=exports.treeify=void 0;const constants_1=__webpack_require__(916);exports.treeify=(built,fields)=>{const _treeify=built=>{let tag="",currentProps=null;const props=[],children=[];for(let i=1;i<built.length;i++){const type=built[i++],value=built[i]?fields[built[i++]-1]:built[++i];3===type?tag=value:4===type?(props.push(value),currentProps=null):5===type?(currentProps||(currentProps=Object.create(null),props.push(currentProps)),currentProps[built[++i]]=[value]):6===type?currentProps[built[++i]].push(value):2===type?children.push(_treeify(value)):0===type&&children.push(value)}return{tag,props,children}},{children}=_treeify(built);return children.length>1?children:children[0]};exports.evaluate=(h,built,fields,args)=>{let tmp;built[0]=0;for(let i=1;i<built.length;i++){const type=built[i++],value=built[i]?(built[0]|=type?1:2,fields[built[i++]]):built[++i];3===type?args[0]=value:4===type?args[1]=Object.assign(args[1]||{},value):5===type?(args[1]=args[1]||{})[built[++i]]=value:6===type?args[1][built[++i]]+=`${value}`:type?(tmp=h.apply(value,exports.evaluate(h,value,fields,["",null])),args.push(tmp),value[0]?built[0]|=2:(built[i-2]=0,built[i]=tmp)):args.push(value)}return args};exports.build=function(statics,...rest){const fields=[statics,...rest],h=this;let char,propName,mode=1,buffer="",quote="",current=[0];const commit=field=>{1===mode&&(field||(buffer=buffer.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?constants_1.MINI?current.push(field?fields[field]:buffer):current.push(0,field,buffer):3===mode&&(field||buffer)?(constants_1.MINI?current[1]=field?fields[field]:buffer:current.push(3,field,buffer),mode=2):2===mode&&"..."===buffer&&field?constants_1.MINI?current[2]=Object.assign(current[2]||{},fields[field]):current.push(4,field,0):2===mode&&buffer&&!field?constants_1.MINI?(current[2]=current[2]||{})[buffer]=!0:current.push(5,0,!0,buffer):mode>=5&&(constants_1.MINI?5===mode?((current[2]=current[2]||{})[propName]=field?buffer?buffer+fields[field]:fields[field]:buffer,mode=6):(field||buffer)&&(current[2][propName]+=field?buffer+fields[field]:buffer):((buffer||!field&&5===mode)&&(current.push(mode,0,buffer,propName),mode=6),field&&(current.push(mode,field,0,propName),mode=6))),buffer=""};for(let i=0;i<statics.length;i++){i&&(1===mode&&commit(),commit(i));for(let j=0;j<statics[i].length;j++)char=statics[i][j],1===mode?"<"===char?(commit(),current=constants_1.MINI?[current,"",null]:[current],mode=3):buffer+=char:4===mode?"--"===buffer&&">"===char?(mode=1,buffer=""):buffer=char+buffer[0]:quote?char===quote?quote="":buffer+=char:'"'===char||"'"===char?quote=char:">"===char?(commit(),mode=1):mode&&("="===char?(mode=5,propName=buffer,buffer=""):"/"===char&&(mode<5||">"===statics[i][j+1])?(commit(),3===mode&&(current=current[0]),mode=current,constants_1.MINI?(current=current[0]).push(h(...mode.slice(1))):(current=current[0]).push(2,0,mode),mode=0):" "===char||"\t"===char||"\n"===char||"\r"===char?(commit(),mode=2):buffer+=char),3===mode&&"!--"===buffer&&(mode=4,current=current[0])}return commit(),constants_1.MINI?current.length>2?current.slice(1):current[1]:current}},916:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MINI=void 0,exports.MINI=!1},104:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const constants_1=__webpack_require__(916),build_1=__webpack_require__(488),CACHES=new Map;exports.default=constants_1.MINI?build_1.build:function(statics){let tmp=CACHES.get(this);return tmp||(tmp=new Map,CACHES.set(this,tmp)),tmp=build_1.evaluate(this,tmp.get(statics)||(tmp.set(statics,tmp=build_1.build(statics)),tmp),arguments,[]),tmp.length>1?tmp:tmp[0]}},872:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k),Object.defineProperty(o,k2,{enumerable:!0,get:function(){return m[k]}})}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=exports.printVersion=exports.withStyles=exports.createContext=exports.Store=exports.Fragment=exports.renderSSR=exports.task=exports.nodeToString=exports.hydrateLazy=exports.jsx=exports.Component=exports.tick=exports.hydrate=exports.render=exports.h=void 0,__webpack_require__(80);var core_1=__webpack_require__(396);Object.defineProperty(exports,"h",{enumerable:!0,get:function(){return core_1.h}}),Object.defineProperty(exports,"render",{enumerable:!0,get:function(){return core_1.render}}),Object.defineProperty(exports,"hydrate",{enumerable:!0,get:function(){return core_1.hydrate}}),Object.defineProperty(exports,"tick",{enumerable:!0,get:function(){return core_1.tick}});var component_1=__webpack_require__(320);Object.defineProperty(exports,"Component",{enumerable:!0,get:function(){return component_1.Component}}),__exportStar(__webpack_require__(995),exports);const core_2=__webpack_require__(396),ssr_1=__webpack_require__(576);exports.default={h:core_2.h,render:core_2.render,hydrate:core_2.hydrate,renderSSR:ssr_1.renderSSR};var jsx_1=__webpack_require__(928);Object.defineProperty(exports,"jsx",{enumerable:!0,get:function(){return jsx_1.jsx}});var lazy_1=__webpack_require__(904);Object.defineProperty(exports,"hydrateLazy",{enumerable:!0,get:function(){return lazy_1.hydrateLazy}});var helpers_1=__webpack_require__(416);Object.defineProperty(exports,"nodeToString",{enumerable:!0,get:function(){return helpers_1.nodeToString}}),Object.defineProperty(exports,"task",{enumerable:!0,get:function(){return helpers_1.task}});var ssr_2=__webpack_require__(576);Object.defineProperty(exports,"renderSSR",{enumerable:!0,get:function(){return ssr_2.renderSSR}});var fragment_1=__webpack_require__(124);Object.defineProperty(exports,"Fragment",{enumerable:!0,get:function(){return fragment_1.Fragment}});var store_1=__webpack_require__(988);Object.defineProperty(exports,"Store",{enumerable:!0,get:function(){return store_1.Store}});var context_1=__webpack_require__(96);Object.defineProperty(exports,"createContext",{enumerable:!0,get:function(){return context_1.createContext}});var withStyles_1=__webpack_require__(648);Object.defineProperty(exports,"withStyles",{enumerable:!0,get:function(){return withStyles_1.withStyles}});var helpers_2=__webpack_require__(416);Object.defineProperty(exports,"printVersion",{enumerable:!0,get:function(){return helpers_2.printVersion}});var version_1=__webpack_require__(280);Object.defineProperty(exports,"VERSION",{enumerable:!0,get:function(){return version_1.VERSION}})},928:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.jsx=void 0;const core_1=__webpack_require__(396),jsx=__importDefault(__webpack_require__(120)).default.bind(core_1.h);exports.jsx=jsx},904:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.hydrateLazy=void 0;const core_1=__webpack_require__(396),visible_1=__webpack_require__(920);exports.hydrateLazy=(component,parent=null,removeChildNodes=!0)=>{const c=core_1.h(visible_1.Visible,null,component);return core_1.hydrate(c,parent,removeChildNodes)}},576:(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DocumentSSR=exports.HTMLElementSSR=exports.renderSSR=exports.clearState=exports.initSSR=void 0;const core_1=__webpack_require__(396),state_1=__webpack_require__(212);globalThis.isSSR=!0===(()=>{const isDeno="undefined"!=typeof Deno,hasWindow="undefined"!=typeof window;return"undefined"!=typeof isSSR&&isSSR||isDeno||!hasWindow})()||void 0,globalThis._nano={isSSR,location:{pathname:"/"}};exports.initSSR=(pathname="/")=>{_nano.location={pathname},globalThis.document=isSSR?new DocumentSSR:window.document};exports.clearState=()=>{state_1._state.clear()};exports.renderSSR=(component,options={})=>{const{pathname,clearState=!0}=options;return exports.initSSR(pathname),clearState&&state_1._state.clear(),core_1.render(component,null,!0).join("")};class HTMLElementSSR{constructor(tag){this.isSelfClosing=!1,this.tagName=tag;["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"].indexOf(tag)>=0?(this.ssr=`<${tag} />`,this.isSelfClosing=!0):this.ssr=`<${tag}></${tag}>`}get outerHTML(){return this.innerText}get innerHTML(){var _a,_b;return null!==(_b=null===(_a=/(^<[a-z]+>)([\s\S]*)(<\/[a-z]+>$)/gm.exec(this.ssr))||void 0===_a?void 0:_a[2])&&void 0!==_b?_b:""}get innerText(){var _a,_b;return null!==(_b=null===(_a=/(^<[^>]+>)(.+)?(<\/[a-z]+>$|\/>$)/gm.exec(this.ssr))||void 0===_a?void 0:_a[2])&&void 0!==_b?_b:""}set innerText(text){this.ssr=this.ssr.replace(/(^<[^>]+>)(.+)?(<\/[a-z]+>$|\/>$)/gm,`$1${text}$3`)}get attributes(){return{length:1}}setAttributeNS(name,value){this.setAttribute(name,value)}setAttribute(name,value){this.isSelfClosing?this.ssr=this.ssr.replace(/(^<[a-z]+ )(.+)/gm,`$1${name}="${value}" $2`):this.ssr=this.ssr.replace(/(^<[^>]+)(.+)/gm,`$1 ${name}="${value}"$2`)}appendChild(child){const append=child.ssr?child.ssr:child,index=this.ssr.lastIndexOf("</");this.ssr=this.ssr.substring(0,index)+append+this.ssr.substring(index)}replaceChild(newChild,_oldChild){this.innerText=newChild.ssr}get children(){const reg=/<([a-z]+)((?!<\/\1).)*<\/\1>/gms,array=[];let match;for(;null!==(match=reg.exec(this.innerHTML));)array.push(match[0].replace(/[\s]+/gm," "));return array}addEventListener(_type,_listener,_options){}}exports.HTMLElementSSR=HTMLElementSSR;class DocumentSSR{constructor(){this.body=this.createElement("body"),this.head=this.createElement("head")}createElement(tag){return new HTMLElementSSR(tag)}createElementNS(_URI,tag){return new HTMLElementSSR(tag)}createTextNode(text){return text}querySelector(_query){}}exports.DocumentSSR=DocumentSSR},212:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports._clearState=exports._state=void 0,exports._state=new Map;exports._clearState=()=>{exports._state.clear()}},988:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Store=void 0;exports.Store=class{constructor(defaultState,name="",storage="memory"){if(this._listeners=new Map,"undefined"!=typeof isSSR&&(storage="memory"),this._id=name,this._storage=storage,this._state=this._prevState=defaultState,"memory"===storage||!storage)return;const Storage="local"===storage?localStorage:sessionStorage,item=Storage.getItem(this._id);item?this._state=this._prevState=JSON.parse(item):Storage.setItem(this._id,JSON.stringify(defaultState))}persist(newState){if("memory"===this._storage)return;("local"===this._storage?localStorage:sessionStorage).setItem(this._id,JSON.stringify(newState))}clear(){this._state=this._prevState=void 0,"local"===this._storage?localStorage.removeItem(this._id):"session"===this._storage&&sessionStorage.removeItem(this._id)}setState(newState){this.state=newState}set state(newState){this._prevState=this._state,this._state=newState,this.persist(newState),this._listeners.forEach((fnc=>{fnc(this._state,this._prevState)}))}get state(){return this._state}use(){const id=Math.random().toString(36).substr(2,9),_this=this;return{get state(){return _this.state},setState:newState=>{this.state=newState},subscribe:fnc=>{this._listeners.set(id,fnc)},cancel:()=>{this._listeners.delete(id)}}}}},80:()=>{},280:(__unused_webpack_module,exports)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VERSION=void 0,exports.VERSION="0.0.20"},648:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.withStyles=void 0;const core_1=__webpack_require__(396),component_1=__webpack_require__(320),fragment_1=__webpack_require__(124),helmet_1=__webpack_require__(776);exports.withStyles=styles=>WrappedComponent=>class extends component_1.Component{render(){const _a=this.props,{children}=_a,rest=__rest(_a,["children"]),helmet=core_1.h(helmet_1.Helmet,null,core_1.h("style",null,styles.toString())),component=children&&children.length>0?core_1.h(WrappedComponent,Object.assign({},rest),children):core_1.h(WrappedComponent,Object.assign({},this.props));return core_1.h(fragment_1.Fragment,null,helmet,component)}}},864:module=>{class UToolsUtils{static read(key,onlyData=!0){if(!window.utools)return;const data=window.utools.db.get(key);if(!data)return!1;const dataJ=data;return dataJ.data=JSON.parse(data.data),console.log("读取",dataJ),onlyData?dataJ.data:dataJ}static readAll(filter="",processor=!0){const data=filter?window.utools.db.allDocs(filter):window.utools.db.allDocs();return processor?data.map((item=>(item.data=JSON.parse(item.data),item._id=item._id.replace(filter,""),item))):data}static update(key,data){data=JSON.stringify(data),console.log("保存",data);const readData=UToolsUtils.read(key,!1);let res;res=window.utools.db.put({_id:key,data,_rev:readData._rev}),console.log("update",res)}static save(key,data){UToolsUtils.update(key,data)}static delete(key){window.utools.db.remove(key)}}try{module.exports=UToolsUtils}catch(e){window.UToolsUtils=UToolsUtils}},32:(module,__unused_webpack_exports,__webpack_require__)=>{const fs=__webpack_require__(58),{encode}=__webpack_require__(196);module.exports={saveBase64:(base64,savePath)=>{const base64Data=base64.replace(/^data:image\/\w+;base64,/,""),dataBuffer=new Buffer(base64Data,"base64");fs.writeFileSync(savePath,dataBuffer)},imageDataToBase64:imageData=>new Buffer(encode(imageData)).toString("base64")}},88:(module,__unused_webpack_exports,__webpack_require__)=>{const path=__webpack_require__(72),UToolsUtils=__webpack_require__(864),mineMap={"image/bmp":"bmp","image/gif":"gif","image/heic":"heic","image/jpeg":"jpg","image/png":"png","image/svg+xml":"svg","image/webp":"webp","image/x-icon":"ico"};module.exports={getSavePath:imageBase64=>{let[src,type,base64]=imageBase64.match(/^data:(image\/.+);base64,(.*)/),suffix=mineMap[type],defaultPath=utools.getPath("downloads");const data=UToolsUtils.read("SaveFileName/setting");return console.log("getSavePath:66:SaveFileName/setting",data),defaultPath=data&&data.filenameFormat?path.join(defaultPath,((formatPath,fileName,{timestamp=!1}={})=>{if(!/{.*?}/.test(formatPath))return timestamp?path.join(formatPath,Date.now().toString()+fileName):path.join(formatPath,fileName);const enableKeywords=["Y","M","D","H","m","s","rand","ms","since_millisecond","since_second"],date=new Date,option={Y:date.getFullYear().toString(),M:(date.getMonth()+1).toString(),D:date.getDate().toString(),H:date.getHours().toString().padStart(2,"0"),m:date.getMinutes().toString().padStart(2,"0"),s:date.getSeconds().toString().padStart(2,"0"),ms:date.getMilliseconds().toString(),rand:Math.random().toString(36).slice(-10),since_millisecond:Date.now(),since_second:Math.round(Date.now()/1e3)},noFilename=formatPath.includes("{no_filename}");formatPath.includes("filename"),noFilename&&(formatPath=formatPath.replace("{no_filename}",""));for(const key of enableKeywords)option[key]&&(formatPath=formatPath.replace(new RegExp("\\{"+key+"\\}","g"),option[key]));return formatPath})(data.filenameFormat,"")):path.join(defaultPath,Date.now().toString()),defaultPath+="."+suffix,defaultPath}}},58:module=>{"use strict";module.exports=require("fs")},72:module=>{"use strict";module.exports=require("path")},144:module=>{"use strict";module.exports=require("electron")}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.exports}__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},(()=>{const{ipcRenderer}=__webpack_require__(144),Nano=__webpack_require__(872),{jsx}=__webpack_require__(872),UToolsUtils=__webpack_require__(864),{SettingUI}=__webpack_require__(240),{getSavePath}=(__webpack_require__(58),__webpack_require__(72),__webpack_require__(88)),{saveBase64}=__webpack_require__(32);window.runList=[];utools.onPluginReady?utools.onPluginReady((()=>{UToolsUtils.save("preSavePath",{value:""})})):UToolsUtils.save("preSavePath",{value:""});const createWindow=async(imgBase64,callback=void 0)=>{const point=utools.getCursorScreenPoint(),display=utools.getDisplayNearestPoint(point);console.log(imgBase64);const image=await(async base64=>new Promise(((resolve,reject)=>{const image=new Image;image.src=base64,image.onload=()=>{resolve(image)}})))(imgBase64);console.log(point);const win=utools.createBrowserWindow("./brush/index.html",{title:"img",useContentSize:!0,height:0,width:0,minimizable:!1,transparent:!0,backgroundColor:"#00000000",frame:!1,alwaysOnTop:!1,webPreferences:{preload:"./brush/preload.js",devTools:!0}},(()=>{const data={dataURL:imgBase64,scale:display.scaleFactor};console.log("scale",data),win.webContents.openDevTools({mode:"detach"}),win.focus();const{width,height}=image,x=point.x-width,y=point.y-height,{autoCenter=!1}=UToolsUtils.read("screenshotsPosition/setting")||{};win.setPosition(x<0?0:x>=display.size.width?display.size.width:x,y<0?0:y>=display.size.height?display.size.height:y),autoCenter&&win.hide(),ipcRenderer.sendTo(win.webContents.id,"init",JSON.stringify(data)),console.log(point),console.log(display),callback&&"function"==typeof callback&&callback(win),win.setAlwaysOnTop(!0,"screen-saver"),runList.push({winId:win.webContents.id,win})}))},predict=async imgBase64=>{const form=new FormData;form.append("file",((base64,filename)=>{for(var arr=base64.split(","),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);n--;)u8arr[n]=bstr.charCodeAt(n);return new File([u8arr],filename,{type:mime})})(imgBase64,"test.png"));const options={method:"POST"};options.body=form;try{const response=await fetch("http://127.0.0.1:8000/predict",options);return await response.json()}catch(error){console.error(error)}};function getRunItemById(id){const index=runList.findIndex((item=>item.winId===id));return{res:runList[index],index}}window.exports={latexocr:{mode:"none",args:{enter:async action=>{document.getElementById("setting")?.remove();const displays=utools.getAllDisplays();console.log(displays),utools.screenCapture((async imgBase64=>{await createWindow(imgBase64),utools.outPlugin()})),utools.hideMainWindow()}}},delayShortcutCapture:{mode:"none",args:{enter:async action=>{document.getElementById("setting")?.remove();const displays=utools.getAllDisplays();console.log(displays),setTimeout((function(){utools.screenCapture((async imgBase64=>{await createWindow(imgBase64),utools.outPlugin()}))}),3e3),utools.hideMainWindow()}}},pictureBase64:{mode:"none",args:{enter:async({payload})=>{document.getElementById("setting")?.remove();const payloads=payload.split("#");if(1===payloads.length)await createWindow(payload);else{const[base64,params]=payloads;await createWindow(base64,(win=>{const{x,y}=function(queryStr){let queryData={},queryList=queryStr.split("&");for(let[index,queryItem]of queryList.entries()){let itemList=queryItem.split("=");queryData[itemList[0]]=decodeURIComponent(itemList[1])}return queryData}(params);win.setPosition(parseInt(x),parseInt(y))}))}utools.outPlugin()}}},"latexocr&copy":{mode:"none",args:{enter:async({payload})=>{document.getElementById("setting")?.remove(),utools.screenCapture((async imgBase64=>{const result=await predict(imgBase64);utools.copyText(result),utools.hideMainWindow(),utools.outPlugin()})),utools.hideMainWindow()}}},"shortcutCapture&save":{mode:"none",args:{enter:async()=>{utools.screenCapture((async imgBase64=>{const savePath=getSavePath(imgBase64);saveBase64(imgBase64,savePath),utools.shellShowItemInFolder(savePath),utools.outPlugin()}))}}},shortcutCaptureSetting:{mode:"none",args:{enter(action,callback){utools.setExpendHeight(480),setTimeout((()=>{window.setSettingTheme&&window.setSettingTheme()}),150),Nano.render(jsx`${SettingUI()}`,document.documentElement)}}}},ipcRenderer.on("control::close",(event=>{const{res,index}=getRunItemById(event.senderId);console.log("close");try{res.win&&res.win.destroy(),-1!==index&&runList.splice(index,1)}catch(e){-1!==index&&runList.splice(index,1)}})),ipcRenderer.on("control::resize",((event,data)=>{const{res,index}=getRunItemById(event.senderId);data=JSON.parse(data);const size=res.win.getSize(),{width=size[0],height=size[1]}=data;res.win.setSize(Math.floor(width),Math.floor(height));const{autoCenter=!1}=UToolsUtils.read("screenshotsPosition/setting")||{};autoCenter&&(res.win.center(),res.win.show())})),ipcRenderer.on("goto:suspension",((event,data)=>{const{res,index}=getRunItemById(event.senderId);data=JSON.parse(data);const{base64=""}=data;if(!base64)return void console.log("必选");const[x,y]=res.win.getPosition(),display=utools.getDisplayNearestPoint({x,y});utools.redirect("悬浮base64图片",`${base64}#x=${x}&y=${y}&displayId=${display.id}`)})),ipcRenderer.on("control::setIgnoreMouseEvents",((event,data)=>{const{res,index}=getRunItemById(event.senderId),{value}=JSON.parse(data);value?res.win.setIgnoreMouseEvents(!0,{forward:!0}):res.win.setIgnoreMouseEvents(!1)}))})()})();